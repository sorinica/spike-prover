<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>examples.cime_trace.ring_extention</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library examples.cime_trace.ring_extention</h1>

<div class="code">
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">ZArith</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">ZArithRing</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Ring_polynom</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Bool</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">List</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">closure</span>.<br/>

<br/>
<span class="id" type="var">Function</span>  <span class="id" type="var">all_coef_pos</span> (<span class="id" type="var">p</span>:Pol <span class="id" type="var">Z</span>) : <span class="id" type="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">p</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Pc</span> <span class="id" type="var">c</span> =&gt; <span class="id" type="keyword">match</span> <span class="id" type="var">Zcompare</span> 0 <span class="id" type="var">c</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Gt</span> =&gt; <span class="id" type="var">false</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">true</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Pinj</span> <span class="id" type="var">_</span> <span class="id" type="var">p</span> =&gt; <span class="id" type="var">all_coef_pos</span> <span class="id" type="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">PX</span> <span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">q</span> =&gt; <span class="id" type="var">andb</span> (<span class="id" type="var">all_coef_pos</span> <span class="id" type="var">p</span>) (<span class="id" type="var">all_coef_pos</span> <span class="id" type="var">q</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="var">Function</span> <span class="id" type="var">all_mem_pos</span> (<span class="id" type="var">l</span>:list <span class="id" type="var">Z</span>) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">nil</span> =&gt; <span class="id" type="var">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">c</span>::l =&gt; (0&lt;=c)%Z /\ <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">Z_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">InitialRing</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">BinList</span>.<br/>
<span class="id" type="var">Functional</span> <span class="id" type="keyword">Scheme</span> <span class="id" type="var">jump_ind</span> := <span class="id" type="keyword">Induction</span> <span class="id" type="keyword">for</span> <span class="id" type="var">jump</span> <span class="id" type="keyword">Sort</span> <span class="id" type="keyword">Prop</span>.<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">Z_scope</span>.<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">all_mem_pos_def</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">l</span>, (<span class="id" type="keyword">forall</span> <span class="id" type="var">c</span>, <span class="id" type="var">In</span> <span class="id" type="var">c</span> <span class="id" type="var">l</span> -&gt; 0&lt;= <span class="id" type="var">c</span>) &lt;-&gt; <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">l</span>;<span class="id" type="tactic">split</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">l</span>. <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl</span>;<span class="id" type="tactic">intro</span>;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l</span>).<br/>
<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">tauto</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">H'</span>;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H'</span>.<br/>
<span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tail_in</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">l</span>:list <span class="id" type="var">A</span>) <span class="id" type="var">x</span>, <span class="id" type="var">In</span> <span class="id" type="var">x</span> (<span class="id" type="var">tail</span> <span class="id" type="var">l</span>) -&gt; <span class="id" type="var">In</span> <span class="id" type="var">x</span> <span class="id" type="var">l</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">l</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">jump_in</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">n</span> <span class="id" type="var">l</span> (<span class="id" type="var">x</span>:A), <span class="id" type="var">In</span> <span class="id" type="var">x</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l</span>) -&gt; @<span class="id" type="var">In</span> <span class="id" type="var">A</span> <span class="id" type="var">x</span> <span class="id" type="var">l</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">n</span> <span class="id" type="var">l</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l</span>).<br/>
<span class="id" type="tactic">intros</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">tail_in</span>;<span class="id" type="tactic">eauto</span>.<br/>
<span class="id" type="tactic">eauto</span>.<br/>
<span class="id" type="tactic">intros</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">tail_in</span>;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pos_expr_if_all_pos_aux</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> (<span class="id" type="var">p</span>:Pol <span class="id" type="var">Z</span>), <span class="id" type="var">all_coef_pos</span> <span class="id" type="var">p</span> = <span class="id" type="var">true</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">l</span>, <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l</span>  -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;0&lt;=Pphi  0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">l</span> <span class="id" type="var">p</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">all_coef_pos</span> <span class="id" type="var">p</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span>;<span class="id" type="tactic">discriminate</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">c</span>;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">y</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">discriminate</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">IDphi</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">H</span> <span class="id" type="var">l</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHb</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">all_mem_pos_def</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>|-*.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">jump_in</span> <span class="id" type="keyword">with</span> <span class="id" type="var">_x</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">H1</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">H</span> <span class="id" type="var">l</span> <span class="id" type="var">H0</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0&lt;=hd 0 <span class="id" type="var">l</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> - <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">all_mem_pos_def</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>;<span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0&lt;= <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">l</span>) <span class="id" type="var">_x</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">u</span>:=hd 0 <span class="id" type="var">l</span>) <span class="id" type="keyword">in</span> *;<span class="id" type="var">clearbody</span> <span class="id" type="var">u</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> - <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">_x</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;  <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;  <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;  <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
<span class="id" type="tactic">assert</span> (0 &lt;=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">l</span> <span class="id" type="var">p0</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHb</span>.<br/>
<span class="id" type="tactic">symmetry</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">destruct</span> (@<span class="id" type="var">andb_true_eq</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">H</span>);<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">assert</span> (0&lt;=Pphi 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) (<span class="id" type="var">tail</span> <span class="id" type="var">l</span>) <span class="id" type="var">q</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHb0</span>.<br/>
<span class="id" type="tactic">symmetry</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">destruct</span> (@<span class="id" type="var">andb_true_eq</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">H</span>);<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">all_mem_pos_def</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>|-*.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">H4</span>;  <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">tail_in</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">H4</span>.<br/>
<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pos_expr_if_all_pos_aux'</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> (<span class="id" type="var">p</span>:Pol <span class="id" type="var">Z</span>), <span class="id" type="var">all_coef_pos</span> <span class="id" type="var">p</span> = <span class="id" type="var">true</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">l</span>, <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l</span>  -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;0&lt;= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" type="var">Pphi_pow</span> <span class="id" type="var">_</span>  0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span> 0 1 <span class="id" type="var">Zeq_bool</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">_</span> <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span>  <span class="id" type="var">get_signZ</span>  <span class="id" type="var">l</span> <span class="id" type="var">p</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">H</span> <span class="id" type="var">l</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">replace</span> ( @<span class="id" type="var">Pphi_pow</span> <span class="id" type="var">_</span>  0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span> 0 1 <span class="id" type="var">Zeq_bool</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">_</span> <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">get_signZ</span> <span class="id" type="var">l</span> <span class="id" type="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> (<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (@<span class="id" type="var">IDphi</span> <span class="id" type="var">Z</span>) <span class="id" type="var">l</span> <span class="id" type="var">p</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pos_expr_if_all_pos_aux</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">symmetry</span>;<span class="id" type="tactic">eapply</span> <span class="id" type="var">Pphi_pow_ok</span> <span class="id" type="keyword">with</span> (1:=InitialRing.<span class="id" type="var">Zsth</span>) (<span class="id" type="var">C</span>:= <span class="id" type="var">Z</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span>  <span class="id" type="var">InitialRing.Zeqe</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> (@<span class="id" type="var">Rth_ARth</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">InitialRing.Zsth</span> <span class="id" type="var">InitialRing.Zeqe</span> <span class="id" type="var">InitialRing.Zth</span>).<br/>
&nbsp;&nbsp;<span class="id" type="var">eexact</span>  (@<span class="id" type="var">IDmorph</span> <span class="id" type="var">Z</span> <span class="id" type="var">Z0</span> 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span>  <span class="id" type="var">InitialRing.Zsth</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zeq_bool_eq</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">Zpower_theory</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">get_signZ_th</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pos_expr_if_all_pos'</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pe</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">all_coef_pos</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">norm_subst</span> 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zdiv_eucl</span> <span class="id" type="var">ring_subst_niter</span> <span class="id" type="var">nil</span> <span class="id" type="var">pe</span>) = <span class="id" type="var">true</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l</span>, <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l</span>  -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;0&lt;= (  <span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">l</span> <span class="id" type="var">pe</span>) .<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">H</span> <span class="id" type="var">l</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Zr_ring_lemma2</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">n</span>:=ring_subst_niter) (<span class="id" type="var">lH</span>:=@nil (<span class="id" type="var">PExpr</span> <span class="id" type="var">Z</span> * <span class="id" type="var">PExpr</span> <span class="id" type="var">Z</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">l</span>:=l) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">lmp</span>:=@nil (<span class="id" type="var">Z</span>*Mon * <span class="id" type="var">Pol</span> <span class="id" type="var">Z</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">pe</span>:=p) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">npe</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">norm_subst</span> 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zdiv_eucl</span> <span class="id" type="var">ring_subst_niter</span> <span class="id" type="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">p</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pos_expr_if_all_pos_aux'</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pos_expr_if_all_pos</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pe1</span> <span class="id" type="var">pe2</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">all_coef_pos</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">norm_subst</span> 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zdiv_eucl</span> <span class="id" type="var">ring_subst_niter</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">nil</span> (<span class="id" type="var">PEsub</span> <span class="id" type="var">pe2</span>  <span class="id" type="var">pe1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;) = <span class="id" type="var">true</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l</span>, <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l</span>  -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">l</span> <span class="id" type="var">pe1</span> &lt;=  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">l</span> <span class="id" type="var">pe2</span> .<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">pe1</span> <span class="id" type="var">pe2</span> <span class="id" type="var">H</span> <span class="id" type="var">l</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0&lt;=  <span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">l</span> (<span class="id" type="var">PEsub</span> <span class="id" type="var">pe2</span> <span class="id" type="var">pe1</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pos_expr_if_all_pos'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">jump_nil</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">p</span>, <span class="id" type="var">jump</span> <span class="id" type="var">p</span> (@<span class="id" type="var">nil</span> <span class="id" type="var">Z</span>) = <span class="id" type="var">nil</span> .<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p</span>;<span class="id" type="tactic">simpl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHp</span>;<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHp</span>;<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">Pphi_nil</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">p</span>, <br/>
&nbsp;&nbsp;<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">nil</span> <span class="id" type="var">p</span> = <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">p</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Pc</span> <span class="id" type="var">c</span> =&gt; <span class="id" type="var">c</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Pinj</span> <span class="id" type="var">_</span> <span class="id" type="var">p</span> =&gt; <span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">nil</span> <span class="id" type="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">PX</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">p</span> =&gt; <span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">nil</span> <span class="id" type="var">p</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">p</span>.<br/>

<br/>
<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">unfold</span> <span class="id" type="var">IDphi</span>;<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
<span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">jump_nil</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">simpl</span>.<br/>

<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> 0 <span class="id" type="var">p2</span>) <span class="id" type="keyword">with</span> 0.<br/>
<span class="id" type="tactic">ring</span>.<br/>
<span class="id" type="tactic">clear</span>;<span class="id" type="tactic">induction</span> <span class="id" type="var">p2</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">IHp2</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="var">Function</span> <span class="id" type="var">all_mem_bounded</span> (<span class="id" type="var">l</span>:list (<span class="id" type="var">Z</span>*Z)) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">nil</span> =&gt; <span class="id" type="var">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">b</span>,z)::l =&gt; (<span class="id" type="var">b</span>&lt;=z)%Z /\ <span class="id" type="var">all_mem_bounded</span> <span class="id" type="var">l</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">tail_length</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">l1</span> <span class="id" type="var">l2</span>:list <span class="id" type="var">A</span>), <span class="id" type="var">length</span> <span class="id" type="var">l1</span> = <span class="id" type="var">length</span> <span class="id" type="var">l2</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="var">length</span> (<span class="id" type="var">tail</span> <span class="id" type="var">l1</span>) = <span class="id" type="var">length</span> (<span class="id" type="var">tail</span> <span class="id" type="var">l2</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [|x <span class="id" type="var">l1</span>];<span class="id" type="tactic">destruct</span> <span class="id" type="var">l2</span> <span class="id" type="keyword">as</span> [|y <span class="id" type="var">l2</span>];<span class="id" type="tactic">intros</span> <span class="id" type="var">Hlength</span>;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hlength</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">discriminate</span> <span class="id" type="var">Hlength</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">jump_length</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">n</span> (<span class="id" type="var">l1</span> <span class="id" type="var">l2</span>:list <span class="id" type="var">A</span>), <span class="id" type="var">length</span> <span class="id" type="var">l1</span> = <span class="id" type="var">length</span> <span class="id" type="var">l2</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="var">length</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l1</span>) = <span class="id" type="var">length</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l2</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">n</span> <span class="id" type="var">l1</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l1</span>);  <span class="id" type="tactic">simpl</span>;  <span class="id" type="tactic">intros</span> <span class="id" type="var">l2</span> <span class="id" type="var">Hlength</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl0</span>;  <span class="id" type="tactic">apply</span> <span class="id" type="var">IHl</span>;  <span class="id" type="tactic">apply</span> <span class="id" type="var">tail_length</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hlength</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl0</span>;  <span class="id" type="tactic">apply</span> <span class="id" type="var">IHl</span>;   <span class="id" type="tactic">apply</span> <span class="id" type="var">Hlength</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">tail_length</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hlength</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">all_mem_pos_tail</span> : <span class="id" type="keyword">forall</span> (<span class="id" type="var">l</span>:list <span class="id" type="var">Z</span>), <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="var">all_mem_pos</span> (<span class="id" type="var">tail</span> <span class="id" type="var">l</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">l</span>; <span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> 1;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">all_mem_pos_jump</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> (<span class="id" type="var">l</span>:list <span class="id" type="var">Z</span>), <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="var">all_mem_pos</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">n</span> <span class="id" type="var">l</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l</span>);<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">intros</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl1</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl0</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">all_mem_pos_tail</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl1</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl0</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">all_mem_pos_tail</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hmem</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="var">Functional</span> <span class="id" type="keyword">Scheme</span> <span class="id" type="var">combine_ind</span> := <span class="id" type="keyword">Induction</span> <span class="id" type="keyword">for</span> <span class="id" type="var">combine</span> <span class="id" type="keyword">Sort</span> <span class="id" type="keyword">Prop</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">combine_tail</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">l1</span> <span class="id" type="var">l2</span>: <span class="id" type="var">list</span> <span class="id" type="var">A</span>), <br/>
&nbsp;&nbsp;<span class="id" type="var">combine</span> (<span class="id" type="var">tail</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">tail</span> <span class="id" type="var">l2</span>) =  <span class="id" type="var">tail</span> (<span class="id" type="var">combine</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">combine</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">tl</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">combine_jump</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">n</span> (<span class="id" type="var">l1</span> <span class="id" type="var">l2</span>: <span class="id" type="var">list</span> <span class="id" type="var">A</span>), <br/>
&nbsp;&nbsp;<span class="id" type="var">combine</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l2</span>) =  <span class="id" type="var">jump</span> <span class="id" type="var">n</span> (<span class="id" type="var">combine</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">n</span> <span class="id" type="var">l1</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l1</span>);<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">intros</span> <span class="id" type="var">l2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHl0</span>;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHl</span>;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">combine_tail</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHl0</span>;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHl</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">combine_tail</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">all_mem_bounded_tail</span> : <span class="id" type="keyword">forall</span> (<span class="id" type="var">l</span>:list (<span class="id" type="var">Z</span>*Z)), <span class="id" type="var">all_mem_bounded</span> <span class="id" type="var">l</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="var">all_mem_bounded</span> (<span class="id" type="var">tail</span> <span class="id" type="var">l</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">l</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">all_mem_bounded</span> <span class="id" type="var">l</span>);<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> 1;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">all_mem_bounded_jump</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> (<span class="id" type="var">l</span>:list (<span class="id" type="var">Z</span>*Z)), <span class="id" type="var">all_mem_bounded</span> <span class="id" type="var">l</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="var">all_mem_bounded</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">n</span> <span class="id" type="var">l</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l</span>);<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">intros</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl1</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl0</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">all_mem_bounded_tail</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl1</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl0</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">all_mem_bounded_tail</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">all_mem_pos_all_mem_bounded</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>, <span class="id" type="var">length</span> <span class="id" type="var">l1</span> = <span class="id" type="var">length</span> <span class="id" type="var">l2</span> -&gt; <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l1</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">all_mem_bounded</span> (<span class="id" type="var">combine</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>) -&gt; <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l2</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">combine</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">l'</span>;<span class="id" type="tactic">intros</span> <span class="id" type="var">Hlength</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">discriminate</span>;<span class="id" type="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Hlength</span>;<span class="id" type="tactic">injection</span> <span class="id" type="var">Hlength</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">Hlength</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">Hlength</span>;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">inversion</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> 1;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">Zmult_compat</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span>, 0&lt;=n -&gt; 0&lt;n*m -&gt; 0&lt;n /\ 0&lt;m.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span> (<span class="id" type="var">Z_lt_le_dec</span> 0 <span class="id" type="var">n</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">H'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">replace</span> 0 <span class="id" type="keyword">with</span> (0*n) <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">ring</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">replace</span> (<span class="id" type="var">n</span>*m) <span class="id" type="keyword">with</span> (<span class="id" type="var">m</span>*n) <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">ring</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> (<span class="id" type="var">Zmult_gt_0_lt_reg_r</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">Zlt_gt</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">H'</span>) <span class="id" type="var">H0</span>);<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span>;  <span class="id" type="tactic">assert</span> (<span class="id" type="var">n</span>=0) <span class="id" type="tactic">by</span> <span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">subst</span>;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="var">Functional</span> <span class="id" type="keyword">Scheme</span> <span class="id" type="var">pow_pos_ind</span> := <span class="id" type="keyword">Induction</span> <span class="id" type="keyword">for</span> <span class="id" type="var">pow_pos</span> <span class="id" type="keyword">Sort</span> <span class="id" type="keyword">Prop</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pow_pos_pos</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">z</span> <span class="id" type="var">p</span>, 0&lt;=z -&gt; 0&lt;= <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z</span> <span class="id" type="var">p</span> .<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">z</span> <span class="id" type="var">p</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span>  (<span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z</span> <span class="id" type="var">p</span>);<br/>
<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pow_pos_strict_pos</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">z</span> <span class="id" type="var">p</span>, 0&lt;z -&gt; 0&lt; <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z</span> <span class="id" type="var">p</span> .<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">z</span> <span class="id" type="var">p</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span>  (<span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z</span> <span class="id" type="var">p</span>);<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Zmult_lt_0_compat</span>;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Zmult_lt_0_compat</span>;<span class="id" type="tactic">auto</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Zmult_lt_0_compat</span>;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pow_pos_monotonic</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">p</span> <span class="id" type="var">z1</span> <span class="id" type="var">z2</span>, 0&lt;=z1&lt;=z2 -&gt; <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z1</span> <span class="id" type="var">p</span> &lt;= <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z2</span> <span class="id" type="var">p</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">z1</span> <span class="id" type="var">z2</span> <span class="id" type="var">z1_le_z2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z1</span> <span class="id" type="var">p</span>);<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">z1_le_z2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">le_z1</span> <span class="id" type="var">z1_le_z2</span>].<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Zmult_le_compat</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Zmult_le_compat</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pow_pos_pos</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pow_pos_pos</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Zmult_le_0_compat</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">pow_pos_pos</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Zmult_le_compat</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pow_pos_pos</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pow_pos_pos</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">strict_pos_expr_if_all_pos_aux</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> (<span class="id" type="var">p</span>:Pol <span class="id" type="var">Z</span>), <span class="id" type="var">all_coef_pos</span> <span class="id" type="var">p</span> = <span class="id" type="var">true</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">lb</span>, <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">lb</span>  -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">lz</span>, <span class="id" type="var">length</span> <span class="id" type="var">lb</span> = <span class="id" type="var">length</span> <span class="id" type="var">lz</span> -&gt; <span class="id" type="var">all_mem_bounded</span> (<span class="id" type="var">combine</span> <span class="id" type="var">lb</span> <span class="id" type="var">lz</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id" type="var">Pphi</span>  0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">lb</span> <span class="id" type="var">p</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0&lt; <span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">lz</span> <span class="id" type="var">p</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">H</span> <span class="id" type="var">lb</span> <span class="id" type="var">H0</span> <span class="id" type="var">lz</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span> <span class="id" type="var">H3</span>;<span class="id" type="tactic">tauto</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">Hp0</span> <span class="id" type="var">lb</span> <span class="id" type="var">lb_pos</span> <span class="id" type="var">lz</span> <span class="id" type="var">Hlength</span> <span class="id" type="var">lb_lz</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHp</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">jump</span> <span class="id" type="var">p</span> <span class="id" type="var">lb</span>);<span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">all_mem_pos_jump</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">lb_pos</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">jump_length</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">Hlength</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">combine_jump</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">all_mem_bounded_jump</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">lb_lz</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">Hp1_p3</span> <span class="id" type="var">lb</span> <span class="id" type="var">lb_pos</span> <span class="id" type="var">lz</span> <span class="id" type="var">Hlength</span> <span class="id" type="var">lb_lz</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span>(<span class="id" type="var">h1</span>:0&lt;=pow_pos <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">lb</span>) <span class="id" type="var">p2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">lb</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">clear</span>;  <span class="id" type="tactic">induction</span> <span class="id" type="var">p2</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">lb_pos</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">lb_pos</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> - <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p2</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">h2</span>:0&lt;=Pphi 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">lb</span> <span class="id" type="var">p1</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span>  <span class="id" type="var">pos_expr_if_all_pos_aux</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">symmetry</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hp1_p3</span>;<span class="id" type="tactic">destruct</span> (@<span class="id" type="var">andb_true_eq</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Hp1_p3</span>);<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">lb_pos</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">h3</span>:0&lt;=Pphi 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">lb</span> <span class="id" type="var">p1</span> * <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">lb</span>) <span class="id" type="var">p2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span>(<span class="id" type="var">h4</span>:(0&lt;Pphi 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) (<span class="id" type="var">tail</span> <span class="id" type="var">lb</span>) <span class="id" type="var">p3</span>)\/0&lt;Pphi 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">lb</span> <span class="id" type="var">p1</span> * <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">lb</span>) <span class="id" type="var">p2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span>(<span class="id" type="var">Zle_lt_or_eq</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">h3</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">Heq</span>;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Heq</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span>(<span class="id" type="var">h5</span>:0&lt;=pow_pos <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">lz</span>) <span class="id" type="var">p2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">lz</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">clear</span>;  <span class="id" type="tactic">induction</span> <span class="id" type="var">p2</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">lb</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">lb_pos</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">lb_pos</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">lb_lz</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">lb_lz</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0&lt;= <span class="id" type="var">z</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> - <span class="id" type="var">H4</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p2</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">h6</span>:0&lt;=Pphi 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">lz</span> <span class="id" type="var">p1</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span>  <span class="id" type="var">pos_expr_if_all_pos_aux</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">symmetry</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hp1_p3</span>;<span class="id" type="tactic">destruct</span> (@<span class="id" type="var">andb_true_eq</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Hp1_p3</span>);<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span>  <span class="id" type="var">all_mem_pos_all_mem_bounded</span> <span class="id" type="keyword">with</span> <span class="id" type="var">lb</span>. <span class="id" type="tactic">exact</span> <span class="id" type="var">Hlength</span>. <span class="id" type="tactic">exact</span> <span class="id" type="var">lb_pos</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">lb_lz</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">h7</span>:0&lt;=Pphi 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">lz</span> <span class="id" type="var">p1</span> * <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">lz</span>) <span class="id" type="var">p2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span> <span class="id" type="var">h4</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">h4</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">h4</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">h8</span>:0&lt; <span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) (<span class="id" type="var">tail</span> <span class="id" type="var">lz</span>) <span class="id" type="var">p3</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHp2</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">tail</span> <span class="id" type="var">lb</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">symmetry</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hp1_p3</span>;<span class="id" type="tactic">destruct</span> (@<span class="id" type="var">andb_true_eq</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Hp1_p3</span>);<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">all_mem_pos_tail</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">lb_pos</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">tail_length</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">Hlength</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">combine_tail</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">all_mem_bounded_tail</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">lb_lz</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">h4</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<span class="id" type="var">Zmult_compat</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">h2</span> <span class="id" type="var">h4</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">h8</span> <span class="id" type="var">h9</span>];<span class="id" type="tactic">clear</span> <span class="id" type="var">h4</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">h10</span>:0 &lt; <span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">lz</span> <span class="id" type="var">p1</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHp1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">lb</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">symmetry</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hp1_p3</span>;<span class="id" type="tactic">destruct</span> (@<span class="id" type="var">andb_true_eq</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Hp1_p3</span>);<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">lb_pos</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">Hlength</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">lb_lz</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">h8</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">h11</span>: 0 &lt; <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">lz</span>) <span class="id" type="var">p2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">lz</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> -  <span class="id" type="var">h9</span> <span class="id" type="var">Hlength</span> <span class="id" type="var">lb_lz</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">lb</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">h9</span>|-*.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> - <span class="id" type="var">h9</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">False_ind</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">replace</span>  (<span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> 0 <span class="id" type="var">p2</span>) <span class="id" type="keyword">with</span> 0 <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">p2</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">IHp2</span>;<span class="id" type="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> -  <span class="id" type="var">h9</span> <span class="id" type="var">Hlength</span> <span class="id" type="var">lb_pos</span> <span class="id" type="var">lb_lz</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">lb</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">h9</span>,lb_lz,lb_pos|-*.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">lb_lz</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">h</span> <span class="id" type="var">_</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">lb_pos</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">h1</span> <span class="id" type="var">_</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> - <span class="id" type="var">h</span> <span class="id" type="var">h1</span> <span class="id" type="var">h9</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Zlt_le_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z0</span> <span class="id" type="var">p2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pow_pos_monotonic</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0 &lt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">lz</span> <span class="id" type="var">p1</span> * <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">lz</span>) <span class="id" type="var">p2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Zmult_lt_0_compat</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> ( 0&lt;=Pphi 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) (<span class="id" type="var">tail</span> <span class="id" type="var">lz</span>) <span class="id" type="var">p3</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pos_expr_if_all_pos_aux</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">symmetry</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hp1_p3</span>;<span class="id" type="tactic">destruct</span> (@<span class="id" type="var">andb_true_eq</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Hp1_p3</span>);<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">all_mem_pos_tail</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">all_mem_pos_all_mem_bounded</span> <span class="id" type="keyword">with</span> <span class="id" type="var">lb</span>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">strict_pos_expr_if_all_pos_aux'</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> (<span class="id" type="var">p</span>:Pol <span class="id" type="var">Z</span>), <span class="id" type="var">all_coef_pos</span> <span class="id" type="var">p</span> = <span class="id" type="var">true</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">lb</span>, <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">lb</span>  -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">lz</span>, <span class="id" type="var">length</span> <span class="id" type="var">lb</span> = <span class="id" type="var">length</span> <span class="id" type="var">lz</span> -&gt; <span class="id" type="var">all_mem_bounded</span> (<span class="id" type="var">combine</span> <span class="id" type="var">lb</span> <span class="id" type="var">lz</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;0&lt;  @<span class="id" type="var">Pphi_pow</span> <span class="id" type="var">_</span>  0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span> 0 1 <span class="id" type="var">Zeq_bool</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">_</span> <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span>  (<span class="id" type="var">get_signZ</span>)  <span class="id" type="var">lb</span> <span class="id" type="var">p</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0&lt;  @<span class="id" type="var">Pphi_pow</span> <span class="id" type="var">_</span>  0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span> 0 1 <span class="id" type="var">Zeq_bool</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">_</span> <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span>  (<span class="id" type="var">get_signZ</span>)  <span class="id" type="var">lz</span> <span class="id" type="var">p</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">H</span> <span class="id" type="var">lb</span> <span class="id" type="var">H0</span> <span class="id" type="var">lz</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>.<br/>
&nbsp;<span class="id" type="tactic">replace</span> ( @<span class="id" type="var">Pphi_pow</span> <span class="id" type="var">_</span>  0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span> 0 1 <span class="id" type="var">Zeq_bool</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">_</span> <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span>  (<span class="id" type="var">get_signZ</span>)  <span class="id" type="var">lb</span> <span class="id" type="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> (<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (@<span class="id" type="var">IDphi</span> <span class="id" type="var">Z</span>) <span class="id" type="var">lb</span> <span class="id" type="var">p</span>).<br/>
&nbsp;<span class="id" type="tactic">replace</span> (<span class="id" type="var">Pphi_pow</span> 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> 0 1 <span class="id" type="var">Zeq_bool</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> (<span class="id" type="var">get_signZ</span>) <span class="id" type="var">lz</span> <span class="id" type="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> (<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (@<span class="id" type="var">IDphi</span> <span class="id" type="var">Z</span>) <span class="id" type="var">lz</span> <span class="id" type="var">p</span>).<br/>
&nbsp;<span class="id" type="tactic">intro</span>.<br/>
&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">strict_pos_expr_if_all_pos_aux</span> <span class="id" type="keyword">with</span> <span class="id" type="var">lb</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;<span class="id" type="tactic">symmetry</span>;<span class="id" type="tactic">eapply</span> <span class="id" type="var">Pphi_pow_ok</span> <span class="id" type="keyword">with</span> (1:=InitialRing.<span class="id" type="var">Zsth</span>) (<span class="id" type="var">C</span>:= <span class="id" type="var">Z</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span>  <span class="id" type="var">InitialRing.Zeqe</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> (@<span class="id" type="var">Rth_ARth</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">InitialRing.Zsth</span> <span class="id" type="var">InitialRing.Zeqe</span> <span class="id" type="var">InitialRing.Zth</span>).<br/>
&nbsp;&nbsp;<span class="id" type="var">eexact</span>  (@<span class="id" type="var">IDmorph</span> <span class="id" type="var">Z</span> <span class="id" type="var">Z0</span> 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span>  <span class="id" type="var">InitialRing.Zsth</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zeq_bool_eq</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">Zpower_theory</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">get_signZ_th</span>.<br/>
&nbsp;<span class="id" type="tactic">symmetry</span>;<span class="id" type="tactic">eapply</span> <span class="id" type="var">Pphi_pow_ok</span> <span class="id" type="keyword">with</span> (1:=InitialRing.<span class="id" type="var">Zsth</span>) (<span class="id" type="var">C</span>:= <span class="id" type="var">Z</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span>  <span class="id" type="var">InitialRing.Zeqe</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> (@<span class="id" type="var">Rth_ARth</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">InitialRing.Zsth</span> <span class="id" type="var">InitialRing.Zeqe</span> <span class="id" type="var">InitialRing.Zth</span>).<br/>
&nbsp;&nbsp;<span class="id" type="var">eexact</span>  (@<span class="id" type="var">IDmorph</span> <span class="id" type="var">Z</span> <span class="id" type="var">Z0</span> 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span>  <span class="id" type="var">InitialRing.Zsth</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zeq_bool_eq</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">Zpower_theory</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">get_signZ_th</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">strict_pos_expr_if_all_pos'</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pe</span>, <span class="id" type="var">all_coef_pos</span> (<span class="id" type="var">norm_subst</span> 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zdiv_eucl</span> <span class="id" type="var">ring_subst_niter</span> <span class="id" type="var">nil</span> <span class="id" type="var">pe</span>) = <span class="id" type="var">true</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">lb</span>, <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">lb</span>  -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">lz</span>, <span class="id" type="var">length</span> <span class="id" type="var">lb</span> = <span class="id" type="var">length</span> <span class="id" type="var">lz</span> -&gt; <span class="id" type="var">all_mem_bounded</span> (<span class="id" type="var">combine</span> <span class="id" type="var">lb</span> <span class="id" type="var">lz</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">lb</span> <span class="id" type="var">pe</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt; ( <span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">lz</span> <span class="id" type="var">pe</span>) .<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">pe</span> <span class="id" type="var">H</span> <span class="id" type="var">lb</span> <span class="id" type="var">lb_pos</span> <span class="id" type="var">lz</span> <span class="id" type="var">Hlength</span> <span class="id" type="var">Hlb_lz</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Zr_ring_lemma2</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">n</span>:=ring_subst_niter) (<span class="id" type="var">lH</span>:=@nil (<span class="id" type="var">PExpr</span> <span class="id" type="var">Z</span> * <span class="id" type="var">PExpr</span> <span class="id" type="var">Z</span>))  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">lmp</span>:=@nil (<span class="id" type="var">Z</span>*Mon * <span class="id" type="var">Pol</span> <span class="id" type="var">Z</span>)) (<span class="id" type="var">pe</span>:=pe) (<span class="id" type="var">npe</span>:=norm_subst 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zdiv_eucl</span> <span class="id" type="var">ring_subst_niter</span> <span class="id" type="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">pe</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Zr_ring_lemma2</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">n</span>:=ring_subst_niter) (<span class="id" type="var">lH</span>:=@nil (<span class="id" type="var">PExpr</span> <span class="id" type="var">Z</span> * <span class="id" type="var">PExpr</span> <span class="id" type="var">Z</span>))  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">lmp</span>:=@nil (<span class="id" type="var">Z</span>*Mon * <span class="id" type="var">Pol</span> <span class="id" type="var">Z</span>)) (<span class="id" type="var">pe</span>:=pe) (<span class="id" type="var">npe</span>:=norm_subst 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zdiv_eucl</span> <span class="id" type="var">ring_subst_niter</span> <span class="id" type="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">pe</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">strict_pos_expr_if_all_pos_aux'</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">strict_pos_expr_if_all_pos</span> :   <span class="id" type="keyword">forall</span> <span class="id" type="var">pe1</span> <span class="id" type="var">pe2</span>, <br/>
&nbsp;&nbsp;<span class="id" type="var">all_coef_pos</span> (<span class="id" type="var">norm_subst</span> 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zdiv_eucl</span> <span class="id" type="var">ring_subst_niter</span> <span class="id" type="var">nil</span>  (<span class="id" type="var">PEsub</span> <span class="id" type="var">pe2</span> <span class="id" type="var">pe1</span>)) = <span class="id" type="var">true</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">lb</span>, <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">lb</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">lz</span>, <span class="id" type="var">length</span> <span class="id" type="var">lb</span> = <span class="id" type="var">length</span> <span class="id" type="var">lz</span> -&gt; <span class="id" type="var">all_mem_bounded</span> (<span class="id" type="var">combine</span> <span class="id" type="var">lb</span> <span class="id" type="var">lz</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">lb</span> <span class="id" type="var">pe1</span> &lt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">lb</span> <span class="id" type="var">pe2</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">lz</span> <span class="id" type="var">pe1</span> &lt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">lz</span> <span class="id" type="var">pe2</span>) .<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">pe1</span> <span class="id" type="var">pe2</span> <span class="id" type="var">H</span> <span class="id" type="var">lb</span> <span class="id" type="var">H0</span> <span class="id" type="var">lz</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span> <span class="id" type="var">H3</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0&lt;  <span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">lz</span> <span class="id" type="var">pe2</span>  -<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">lz</span> <span class="id" type="var">pe1</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">replace</span> (<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">lz</span> <span class="id" type="var">pe2</span>  -<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">lz</span> <span class="id" type="var">pe1</span>) <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;(<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">lz</span> (<span class="id" type="var">PEsub</span> <span class="id" type="var">pe2</span>  <span class="id" type="var">pe1</span>)) <span class="id" type="tactic">by</span> (<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">strict_pos_expr_if_all_pos'</span> <span class="id" type="keyword">with</span> <span class="id" type="var">lb</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="var">Function</span> <span class="id" type="var">all_le</span> (<span class="id" type="var">l1</span> <span class="id" type="var">l2</span>:list <span class="id" type="var">Z</span>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">l1</span>}: <span class="id" type="keyword">Prop</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">nil</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l2</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">nil</span> =&gt; <span class="id" type="var">True</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">x</span>::l1 =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l2</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">nil</span> =&gt; <span class="id" type="var">False</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">y</span>::l2 =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">x</span> &lt;= <span class="id" type="var">y</span> /\ <span class="id" type="var">all_le</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">all_le_def</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>, <span class="id" type="var">all_le</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> &lt;-&gt; (<span class="id" type="var">length</span> <span class="id" type="var">l1</span> = <span class="id" type="var">length</span> <span class="id" type="var">l2</span> /\ <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">In</span> (<span class="id" type="var">x</span>,y) (<span class="id" type="var">combine</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>) -&gt; <span class="id" type="var">x</span> &lt;= <span class="id" type="var">y</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">all_le</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>).<br/>

<br/>
<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">tauto</span>.<br/>

<br/>
<span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l2</span>.<br/>
<span class="id" type="tactic">split</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">tauto</span>.<br/>
<span class="id" type="tactic">split</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">tauto</span>.<br/>
<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">inversion</span> 1;<span class="id" type="tactic">discriminate</span>.<br/>

<br/>
<span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">split</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">tauto</span>.<br/>
<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">inversion</span> 1;<span class="id" type="tactic">discriminate</span>.<br/>

<br/>
<span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHP</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">lhs</span> <span class="id" type="var">rhs</span>].<br/>
<span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">H1</span> <span class="id" type="var">H2</span>].<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">lhs</span> <span class="id" type="var">H2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">Heq</span> <span class="id" type="var">Hforall</span>];<span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">f_equal</span>.<br/>
<span class="id" type="tactic">exact</span> <span class="id" type="var">Heq</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x'</span> <span class="id" type="var">y'</span> [<span class="id" type="var">h</span>|h].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">h</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">h</span>;<span class="id" type="tactic">intros</span>;<span class="id" type="tactic">subst</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">H1</span>.<br/>
<span class="id" type="tactic">auto</span>.<br/>

<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">lhs</span>.<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">H1</span> <span class="id" type="var">H2</span>].<br/>
<span class="id" type="tactic">split</span>;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">jump_combine</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">n</span> (<span class="id" type="var">l1</span> <span class="id" type="var">l2</span>:list <span class="id" type="var">A</span>), <span class="id" type="var">jump</span> <span class="id" type="var">n</span> (<span class="id" type="var">combine</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>) = <span class="id" type="var">combine</span> (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">jump</span> <span class="id" type="var">n</span> <span class="id" type="var">l2</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">n</span>;  <span class="id" type="tactic">simpl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">IHn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">l2</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span>;<span class="id" type="tactic">simpl</span>;  <span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">IHn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">f_equal</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">l2</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span>;<span class="id" type="tactic">simpl</span>;  <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pos_pol_incr</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> (<span class="id" type="var">p</span>:Pol <span class="id" type="var">Z</span>), <span class="id" type="var">all_coef_pos</span> <span class="id" type="var">p</span> = <span class="id" type="var">true</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>, <span class="id" type="var">all_le</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>  -&gt; <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l1</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt;=Pphi  0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">l1</span> <span class="id" type="var">p</span> &lt;= <span class="id" type="var">Pphi</span>  0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">l2</span> <span class="id" type="var">p</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span>;<span class="id" type="var">functional</span> <span class="id" type="tactic">induction</span> (<span class="id" type="var">all_coef_pos</span> <span class="id" type="var">p</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span>;<span class="id" type="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">c</span>;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">y</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">discriminate</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">split</span>;<span class="id" type="tactic">unfold</span> <span class="id" type="var">IDphi</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">H</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHb</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span>  <span class="id" type="var">all_le_def</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>|-*.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H0</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">Hlength</span> <span class="id" type="var">Hforall</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">jump_length</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">Hlength</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H0</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hforall</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">jump_in</span> <span class="id" type="keyword">with</span> <span class="id" type="var">_x</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">jump_combine</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">all_mem_pos_def</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>|-*.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">H2</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">jump_in</span> <span class="id" type="keyword">with</span> <span class="id" type="var">_x</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">H</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0&lt;=pow_pos <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">l1</span>) <span class="id" type="var">_x</span> &lt;= <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">l2</span>) <span class="id" type="var">_x</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">l2</span>;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">tauto</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span>;<span class="id" type="tactic">induction</span> <span class="id" type="var">_x</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H1</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">H1</span> <span class="id" type="var">_</span> ].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> - <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0&lt;=z0);<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">z0</span>;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">z</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">_x</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0&lt;=pow_pos <span class="id" type="var">Zmult</span> <span class="id" type="var">z</span> <span class="id" type="var">_x</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">clear</span> -H1;<span class="id" type="tactic">induction</span> <span class="id" type="var">_x</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">z</span>*pow_pos <span class="id" type="var">Zmult</span> <span class="id" type="var">z</span> <span class="id" type="var">_x</span> &lt;= <span class="id" type="var">z0</span> * <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z0</span> <span class="id" type="var">_x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<span class="id" type="var">IH_x</span> <span class="id" type="var">_</span> <span class="id" type="var">H1</span> <span class="id" type="var">_</span> <span class="id" type="var">H0</span> <span class="id" type="var">H</span>);<span class="id" type="tactic">apply</span> <span class="id" type="var">Zle_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">z0</span>*pow_pos <span class="id" type="var">Zmult</span> <span class="id" type="var">z</span> <span class="id" type="var">_x</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<span class="id" type="var">IH_x</span> <span class="id" type="var">_</span> <span class="id" type="var">H1</span> <span class="id" type="var">_</span> <span class="id" type="var">H0</span> <span class="id" type="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Zmult_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Zle_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">z</span>*pow_pos <span class="id" type="var">Zmult</span> <span class="id" type="var">z</span> <span class="id" type="var">_x</span> * <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z0</span> <span class="id" type="var">_x</span>);<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<span class="id" type="var">IH_x</span> <span class="id" type="var">_</span> <span class="id" type="var">H1</span> <span class="id" type="var">_</span> <span class="id" type="var">H0</span> <span class="id" type="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0&lt;= <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z0</span> <span class="id" type="var">_x</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Zle_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z</span> <span class="id" type="var">_x</span>);<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Zle_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">z</span> <span class="id" type="var">_x</span>*pow_pos <span class="id" type="var">Zmult</span> <span class="id" type="var">z0</span> <span class="id" type="var">_x</span>);<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>

<br/>
<span class="id" type="tactic">assert</span> (0 &lt;= <span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">l1</span> <span class="id" type="var">p0</span> &lt;= <span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">l2</span> <span class="id" type="var">p0</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHb</span>.<br/>
<span class="id" type="tactic">symmetry</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">destruct</span> (@<span class="id" type="var">andb_true_eq</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">H</span>);<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">assert</span> (0&lt;=Pphi 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) (<span class="id" type="var">tail</span> <span class="id" type="var">l1</span>) <span class="id" type="var">q</span> &lt;= <span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) (<span class="id" type="var">tail</span> <span class="id" type="var">l2</span>) <span class="id" type="var">q</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHb0</span>.<br/>
<span class="id" type="tactic">symmetry</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">destruct</span> (@<span class="id" type="var">andb_true_eq</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">H</span>);<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">l2</span>;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">auto</span>;<span class="id" type="tactic">try</span> <span class="id" type="tactic">tauto</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">all_mem_pos_def</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>|-*.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">H4</span>;  <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">tail_in</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">H4</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">H2</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H3</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H4</span>;<span class="id" type="tactic">split</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
<span class="id" type="tactic">assert</span> (0&lt;=Pphi 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">l2</span> <span class="id" type="var">p0</span>) <span class="id" type="tactic">by</span> <br/>
&nbsp;&nbsp;(<span class="id" type="tactic">apply</span> <span class="id" type="var">Zle_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">l1</span> <span class="id" type="var">p0</span>);<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>).<br/>
<span class="id" type="tactic">assert</span> (0&lt;=Pphi 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) (<span class="id" type="var">tail</span> <span class="id" type="var">l2</span>) <span class="id" type="var">q</span>) <span class="id" type="tactic">by</span> <br/>
&nbsp;&nbsp;(<span class="id" type="tactic">apply</span> <span class="id" type="var">Zle_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) (<span class="id" type="var">tail</span> <span class="id" type="var">l1</span>) <span class="id" type="var">q</span>);<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>).<br/>
<span class="id" type="tactic">assert</span> (0 &lt;= <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">l2</span>) <span class="id" type="var">_x</span>) <span class="id" type="tactic">by</span> <br/>
&nbsp;&nbsp;(<span class="id" type="tactic">apply</span> <span class="id" type="var">Zle_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">l1</span>) <span class="id" type="var">_x</span>);<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>).<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">l1</span> <span class="id" type="var">p0</span> * <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">l1</span>) <span class="id" type="var">_x</span> &lt;= <br/>
&nbsp;&nbsp;<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">l2</span> <span class="id" type="var">p0</span> * <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">l2</span>) <span class="id" type="var">_x</span>) <br/>
<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <span class="id" type="var">Zle_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">l2</span> <span class="id" type="var">p0</span> * <span class="id" type="var">pow_pos</span> <span class="id" type="var">Zmult</span> (<span class="id" type="var">hd</span> 0 <span class="id" type="var">l1</span>) <span class="id" type="var">_x</span>);<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>).<br/>
<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pos_pol_incr'</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> (<span class="id" type="var">p</span>:Pol <span class="id" type="var">Z</span>), <span class="id" type="var">all_coef_pos</span> <span class="id" type="var">p</span> = <span class="id" type="var">true</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>, <span class="id" type="var">all_le</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>  -&gt; <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l1</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&lt;=@Pphi_pow <span class="id" type="var">_</span>  0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span> 0 1  <span class="id" type="var">Zeq_bool</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">_</span> <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span>  (<span class="id" type="var">get_signZ</span>) <span class="id" type="var">l1</span> <span class="id" type="var">p</span> &lt;= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" type="var">Pphi_pow</span> <span class="id" type="var">_</span>  0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span> 0 1  <span class="id" type="var">Zeq_bool</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">_</span> <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span>  (<span class="id" type="var">get_signZ</span>) <span class="id" type="var">l2</span> <span class="id" type="var">p</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">H</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;<span class="id" type="tactic">replace</span> (@<span class="id" type="var">Pphi_pow</span> <span class="id" type="var">_</span>  0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span> 0 1 <span class="id" type="var">Zeq_bool</span>  (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">_</span> <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span>  (<span class="id" type="var">get_signZ</span>)  <span class="id" type="var">l1</span> <span class="id" type="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> (<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (@<span class="id" type="var">IDphi</span> <span class="id" type="var">Z</span>) <span class="id" type="var">l1</span> <span class="id" type="var">p</span>).<br/>
&nbsp;<span class="id" type="tactic">replace</span> (<span class="id" type="var">Pphi_pow</span> 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> 0 1 <span class="id" type="var">Zeq_bool</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> (<span class="id" type="var">get_signZ</span>) <span class="id" type="var">l2</span> <span class="id" type="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> (<span class="id" type="var">Pphi</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> (@<span class="id" type="var">IDphi</span> <span class="id" type="var">Z</span>) <span class="id" type="var">l2</span> <span class="id" type="var">p</span>).<br/>
&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pos_pol_incr</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;<span class="id" type="tactic">symmetry</span>;<span class="id" type="tactic">eapply</span> <span class="id" type="var">Pphi_pow_ok</span> <span class="id" type="keyword">with</span> (1:=InitialRing.<span class="id" type="var">Zsth</span>) (<span class="id" type="var">C</span>:= <span class="id" type="var">Z</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span>  <span class="id" type="var">InitialRing.Zeqe</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> (@<span class="id" type="var">Rth_ARth</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">InitialRing.Zsth</span> <span class="id" type="var">InitialRing.Zeqe</span> <span class="id" type="var">InitialRing.Zth</span>).<br/>
&nbsp;&nbsp;<span class="id" type="var">eexact</span>  (@<span class="id" type="var">IDmorph</span> <span class="id" type="var">Z</span> <span class="id" type="var">Z0</span> 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span>  <span class="id" type="var">InitialRing.Zsth</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zeq_bool_eq</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">Zpower_theory</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">get_signZ_th</span>.<br/>
&nbsp;<span class="id" type="tactic">symmetry</span>;<span class="id" type="tactic">eapply</span> <span class="id" type="var">Pphi_pow_ok</span> <span class="id" type="keyword">with</span> (1:=InitialRing.<span class="id" type="var">Zsth</span>) (<span class="id" type="var">C</span>:= <span class="id" type="var">Z</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span>  <span class="id" type="var">InitialRing.Zeqe</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> (@<span class="id" type="var">Rth_ARth</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">InitialRing.Zsth</span> <span class="id" type="var">InitialRing.Zeqe</span> <span class="id" type="var">InitialRing.Zth</span>).<br/>
&nbsp;&nbsp;<span class="id" type="var">eexact</span>  (@<span class="id" type="var">IDmorph</span> <span class="id" type="var">Z</span> <span class="id" type="var">Z0</span> 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">_</span>  <span class="id" type="var">InitialRing.Zsth</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zeq_bool_eq</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">Zpower_theory</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">get_signZ_th</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pos_expr_incr_aux</span> :   <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pe</span>, <br/>
&nbsp;&nbsp;<span class="id" type="var">all_coef_pos</span> (<span class="id" type="var">norm_subst</span> 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zdiv_eucl</span> <span class="id" type="var">ring_subst_niter</span> <span class="id" type="var">nil</span>  <span class="id" type="var">pe</span>) = <span class="id" type="var">true</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>, <span class="id" type="var">all_le</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> -&gt; <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l1</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;=  <span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">l1</span> <span class="id" type="var">pe</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;= ( <span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">l2</span> <span class="id" type="var">pe</span>) .<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">pe</span> <span class="id" type="var">H</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Zr_ring_lemma2</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">n</span>:=ring_subst_niter) (<span class="id" type="var">lH</span>:=@nil (<span class="id" type="var">PExpr</span> <span class="id" type="var">Z</span> * <span class="id" type="var">PExpr</span> <span class="id" type="var">Z</span>))  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">lmp</span>:=@nil (<span class="id" type="var">Z</span> * <span class="id" type="var">Mon</span> * <span class="id" type="var">Pol</span> <span class="id" type="var">Z</span>)) (<span class="id" type="var">pe</span>:=pe) (<span class="id" type="var">npe</span>:=norm_subst 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zdiv_eucl</span> <span class="id" type="var">ring_subst_niter</span> <span class="id" type="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">pe</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Zr_ring_lemma2</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">n</span>:=ring_subst_niter) (<span class="id" type="var">lH</span>:=@nil (<span class="id" type="var">PExpr</span> <span class="id" type="var">Z</span> * <span class="id" type="var">PExpr</span> <span class="id" type="var">Z</span>))  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">lmp</span>:=@nil (<span class="id" type="var">Z</span>* <span class="id" type="var">Mon</span> * <span class="id" type="var">Pol</span> <span class="id" type="var">Z</span>)) (<span class="id" type="var">pe</span>:=pe) (<span class="id" type="var">npe</span>:=norm_subst 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zdiv_eucl</span> <span class="id" type="var">ring_subst_niter</span> <span class="id" type="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">pe</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pos_pol_incr'</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pos_expr_incr</span> :   <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pe</span>, <br/>
&nbsp;&nbsp;<span class="id" type="var">all_coef_pos</span> (<span class="id" type="var">norm_subst</span> 0 1 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zeq_bool</span> <span class="id" type="var">Zdiv_eucl</span> <span class="id" type="var">ring_subst_niter</span> <span class="id" type="var">nil</span>  <span class="id" type="var">pe</span>) = <span class="id" type="var">true</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>, <span class="id" type="var">all_le</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> -&gt; <span class="id" type="var">all_mem_pos</span> <span class="id" type="var">l1</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">l1</span> <span class="id" type="var">pe</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;= ( <span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z))  <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">l2</span> <span class="id" type="var">pe</span>) .<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">pe</span> <span class="id" type="var">H</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<span class="id" type="var">pos_expr_incr_aux</span> <span class="id" type="var">pe</span> <span class="id" type="var">H</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">H0</span> <span class="id" type="var">H1</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">_</span> <span class="id" type="var">h</span>];<span class="id" type="tactic">exact</span> <span class="id" type="var">h</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">find_bounds_fv</span> <span class="id" type="var">fv</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">H</span>: ?b &lt;= <span class="id" type="var">fv</span> |- <span class="id" type="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">isZcst</span> <span class="id" type="var">b</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">false</span> =&gt; <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">true</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">b</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="tactic">fail</span> 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">constr</span>:b<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">constr</span>:0<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">map</span> <span class="id" type="var">tac</span> <span class="id" type="var">l</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">nil</span> =&gt; <span class="id" type="var">constr</span>:(@nil <span class="id" type="var">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?x::?l =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">l'</span> := <span class="id" type="var">map</span> <span class="id" type="var">tac</span> <span class="id" type="var">l</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">x'</span> := <span class="id" type="var">tac</span> <span class="id" type="var">x</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(x'::l')<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">ring_ineq</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?p &lt;= ?q =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkFV</span> := <span class="id" type="var">FV</span> <span class="id" type="var">Zcst</span> <span class="id" type="var">Zpow_tac</span> <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zpower</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkPol</span> := <span class="id" type="var">mkPolexpr</span> <span class="id" type="var">Z</span> <span class="id" type="var">Zcst</span> <span class="id" type="var">Zpow_tac</span> <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zpower</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv</span> := <span class="id" type="var">mkFV</span> <span class="id" type="var">p</span> (@<span class="id" type="var">List.nil</span> <span class="id" type="var">Z</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv</span> := <span class="id" type="var">mkFV</span> <span class="id" type="var">q</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">pe</span> := <span class="id" type="var">mkPol</span> <span class="id" type="var">p</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">qe</span> := <span class="id" type="var">mkPol</span> <span class="id" type="var">q</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">p'</span> := <span class="id" type="var">constr</span>:(Ring_polynom.<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">fv</span> <span class="id" type="var">pe</span>) <span class="id" type="keyword">in</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">q'</span> := <span class="id" type="var">constr</span>:(Ring_polynom.<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">fv</span> <span class="id" type="var">qe</span>) <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span>:= <span class="id" type="tactic">fresh</span> "H" <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">assert</span> (<span class="id" type="var">H'</span>:p' &lt;= <span class="id" type="var">q'</span>);[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pos_expr_if_all_pos</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>;<span class="id" type="tactic">assumption</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">vm_compute</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">H'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?p &lt; ?q =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkFV</span> := <span class="id" type="var">FV</span> <span class="id" type="var">Zcst</span> <span class="id" type="var">Zpow_tac</span> <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zpower</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkPol</span> := <span class="id" type="var">mkPolexpr</span> <span class="id" type="var">Z</span> <span class="id" type="var">Zcst</span> <span class="id" type="var">Zpow_tac</span> <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zpower</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv</span> := <span class="id" type="var">mkFV</span> <span class="id" type="var">p</span> (@<span class="id" type="var">List.nil</span> <span class="id" type="var">Z</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv</span> := <span class="id" type="var">mkFV</span> <span class="id" type="var">q</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">pe</span> := <span class="id" type="var">mkPol</span> <span class="id" type="var">p</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">qe</span> := <span class="id" type="var">mkPol</span> <span class="id" type="var">q</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">p'</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Ring_polynom.PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">fv</span> <span class="id" type="var">pe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">in</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">q'</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Ring_polynom.PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">fv</span> <span class="id" type="var">qe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span>:= <span class="id" type="tactic">fresh</span> "H" <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">assert</span> (<span class="id" type="var">H'</span>:p' &lt; <span class="id" type="var">q'</span>);[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lb</span> := <span class="id" type="var">map</span> <span class="id" type="var">find_bounds_fv</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">strict_pos_expr_if_all_pos</span> <span class="id" type="keyword">with</span> <span class="id" type="var">lb</span>;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>;<span class="id" type="tactic">assumption</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">vm_compute</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">H'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">modify_FV</span> <span class="id" type="var">H</span> <span class="id" type="var">l</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">nil</span> =&gt; <span class="id" type="var">constr</span>:(@nil <span class="id" type="var">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?x::?l =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?p &lt;= <span class="id" type="var">x</span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">p</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(p::l)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?y::?l =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv'</span> := <span class="id" type="var">modify_FV</span> <span class="id" type="var">H</span> <span class="id" type="var">l</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(y::fv')<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">set_as_var_if_needed</span> <span class="id" type="var">p</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">set_as_var</span> :=       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">x</span> := <span class="id" type="tactic">fresh</span> "x" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0&lt;=p) <span class="id" type="tactic">by</span> <span class="id" type="var">ring_ineq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">p</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">context</span> [<span class="id" type="var">Zplus</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>] =&gt; <span class="id" type="var">set_as_var</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">context</span> [<span class="id" type="var">Zmult</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>] =&gt; <span class="id" type="var">set_as_var</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">context</span> [<span class="id" type="var">Zminus</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>] =&gt; <span class="id" type="var">set_as_var</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">context</span> [<span class="id" type="var">Zopp</span> <span class="id" type="var">_</span>] =&gt; <span class="id" type="var">set_as_var</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">idtac</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">ring_ineq_same_pol</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">exact</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?p &lt;= ?q =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">set_as_var_if_needed</span> <span class="id" type="var">p</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">set_as_var_if_needed</span> <span class="id" type="var">q</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<br/>
<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?p &lt;= ?q =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkFV</span> := <span class="id" type="var">FV</span> <span class="id" type="var">Zcst</span> <span class="id" type="var">Zpow_tac</span> <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zpower</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkPol</span> := <span class="id" type="var">mkPolexpr</span> <span class="id" type="var">Z</span> <span class="id" type="var">Zcst</span> <span class="id" type="var">Zpow_tac</span> <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zpower</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv2</span> := <span class="id" type="var">mkFV</span> <span class="id" type="var">q</span>  (@<span class="id" type="var">List.nil</span> <span class="id" type="var">Z</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv1</span> := <span class="id" type="var">modify_FV</span> <span class="id" type="var">H</span> <span class="id" type="var">fv2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">qe</span> := <span class="id" type="var">mkPol</span> <span class="id" type="var">q</span> <span class="id" type="var">fv2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">p'</span> := <span class="id" type="var">constr</span>:(Ring_polynom.<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">fv1</span> <span class="id" type="var">qe</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">q'</span> := <span class="id" type="var">constr</span>:(Ring_polynom.<span class="id" type="var">PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">fv2</span> <span class="id" type="var">qe</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H'</span>:= <span class="id" type="tactic">fresh</span> "H" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">assert</span> (<span class="id" type="var">H'</span>:p' &lt;= <span class="id" type="var">q'</span>);[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">pos_expr_incr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" type="var">vm_compute</span>;<span class="id" type="tactic">reflexivity</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">cbv</span> <span class="id" type="var">beta</span> <span class="id" type="var">iota</span> <span class="id" type="var">zeta</span> <span class="id" type="var">delta</span> [<span class="id" type="var">all_le</span> <span class="id" type="var">all_mem_pos</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">cbv</span> <span class="id" type="var">beta</span> <span class="id" type="var">iota</span> <span class="id" type="var">zeta</span> <span class="id" type="var">delta</span> [<span class="id" type="var">all_le</span> <span class="id" type="var">all_mem_pos</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">vm_compute</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>|-*;<span class="id" type="tactic">exact</span> <span class="id" type="var">H'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_fun</span> <span class="id" type="var">p</span> <span class="id" type="var">e</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e'</span> := <span class="id" type="var">eval</span> <span class="id" type="tactic">pattern</span> <span class="id" type="var">p</span> <span class="id" type="keyword">in</span> <span class="id" type="var">e</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">e'</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?f <span class="id" type="var">_</span> =&gt; <span class="id" type="var">constr</span>:f<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">check_goal</span> <span class="id" type="var">continue_tac</span>  <span class="id" type="var">Hacc</span> <span class="id" type="var">order</span> <span class="id" type="var">H</span> <span class="id" type="var">trans_right</span> <span class="id" type="var">trans_left</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span> <span class="id" type="var">lhs</span> <span class="id" type="var">rhs</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">isZcst</span> <span class="id" type="var">p</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">true</span> =&gt; <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">false</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">rhs</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">context</span> [<span class="id" type="var">q</span>] =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">f</span> := <span class="id" type="var">get_fun</span> <span class="id" type="var">q</span> <span class="id" type="var">rhs</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">trans_right</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">f</span> <span class="id" type="var">p</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">Hacc</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">tt</span> =&gt; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?Hacc =&gt; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">conj</span> <span class="id" type="var">H</span> <span class="id" type="var">Hacc</span>);<span class="id" type="tactic">clear</span> <span class="id" type="var">Hacc</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">Hacc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<span class="id" type="var">continue_tac</span> <span class="id" type="var">tt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e</span> := <span class="id" type="var">constr</span>:(forall <span class="id" type="var">a</span> <span class="id" type="var">b</span>, 0 &lt;= <span class="id" type="var">a</span> -&gt; <span class="id" type="var">order</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> -&gt; <span class="id" type="var">order</span> (<span class="id" type="var">f</span> <span class="id" type="var">a</span>) (<span class="id" type="var">f</span> <span class="id" type="var">b</span>)) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H'</span>:e);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">h</span> := <span class="id" type="tactic">fresh</span> "h" <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">cbv</span> <span class="id" type="var">beta</span>;<span class="id" type="tactic">do</span> 3 <span class="id" type="tactic">intro</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">h</span>;<span class="id" type="var">ring_ineq_same_pol</span> <span class="id" type="var">h</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">cbv</span> <span class="id" type="var">beta</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">refine</span> (<span class="id" type="var">H'</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">H</span>);<span class="id" type="var">ring_ineq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">lhs</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">context</span> [<span class="id" type="var">p</span>] =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">f</span> := <span class="id" type="var">get_fun</span> <span class="id" type="var">p</span> <span class="id" type="var">lhs</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">trans_left</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">f</span> <span class="id" type="var">q</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> "H" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H'</span>:forall <span class="id" type="var">a</span> <span class="id" type="var">b</span>, 0 &lt;= <span class="id" type="var">a</span> -&gt; <span class="id" type="var">order</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> -&gt; <span class="id" type="var">order</span> (<span class="id" type="var">f</span> <span class="id" type="var">a</span>) (<span class="id" type="var">f</span> <span class="id" type="var">b</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">h</span> := <span class="id" type="tactic">fresh</span> "h" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">cbv</span> <span class="id" type="var">beta</span>;<span class="id" type="tactic">do</span> 3 <span class="id" type="tactic">intro</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">h</span>;<span class="id" type="var">ring_ineq_same_pol</span> <span class="id" type="var">h</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">cbv</span> <span class="id" type="var">beta</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">refine</span> (<span class="id" type="var">H'</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">H</span>);<span class="id" type="var">ring_ineq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|              <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">Hacc</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">tt</span> =&gt; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?Hacc =&gt; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">conj</span> <span class="id" type="var">H</span> <span class="id" type="var">Hacc</span>);<span class="id" type="tactic">clear</span> <span class="id" type="var">Hacc</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">Hacc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<span class="id" type="var">continue_tac</span> <span class="id" type="var">tt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">soft_prove_ineq</span> <span class="id" type="var">continue_tac</span> <span class="id" type="var">Hacc</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">H</span>:?p &lt;= ?q |- ?lhs &lt;= ?rhs =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">check_goal</span> <span class="id" type="var">continue_tac</span> <span class="id" type="var">Hacc</span> <span class="id" type="var">Zle</span> <span class="id" type="var">H</span> <span class="id" type="var">Zle_trans</span> <span class="id" type="var">Zle_trans</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span> <span class="id" type="var">lhs</span> <span class="id" type="var">rhs</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">H</span>:?p &lt;= ?q |- ?lhs &lt; ?rhs =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">check_goal</span> <span class="id" type="var">continue_tac</span> <span class="id" type="var">Hacc</span> <span class="id" type="var">Zle</span> <span class="id" type="var">H</span> <span class="id" type="var">Zlt_le_trans</span> <span class="id" type="var">Zle_lt_trans</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span> <span class="id" type="var">lhs</span> <span class="id" type="var">rhs</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">H</span>:?p&lt;?q |- ?lhs &lt; ?rhs =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">check_goal</span> <span class="id" type="var">continue_tac</span> <span class="id" type="var">Hacc</span> <span class="id" type="var">Zlt</span> <span class="id" type="var">H</span> <span class="id" type="var">Zle_lt_trans</span> <span class="id" type="var">Zlt_le_trans</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span> <span class="id" type="var">lhs</span> <span class="id" type="var">rhs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">ring_ineq</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="var">Zwf</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="var">terminaison</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">prove_ineq</span> := <span class="id" type="var">soft_prove_ineq</span> <span class="id" type="var">ltac</span>:(fun <span class="id" type="var">_</span> =&gt; <span class="id" type="var">prove_ineq</span>) <span class="id" type="var">tt</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">isVar</span> <span class="id" type="var">t</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">v</span>:Z |- <span class="id" type="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">v</span> =&gt; <span class="id" type="var">constr</span>:true<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">constr</span>:false<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">translate_vars</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">H</span>: ?p &lt;= ?v |- <span class="id" type="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">isZcst</span> <span class="id" type="var">p</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">true</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">p</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="tactic">fail</span> 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">isVar</span> <span class="id" type="var">v</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">true</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">v'</span> := <span class="id" type="tactic">fresh</span> "v" <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">v'</span>:= <span class="id" type="var">v</span> - <span class="id" type="var">p</span>) <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">v</span> = <span class="id" type="var">v'</span> + <span class="id" type="var">p</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">unfold</span> <span class="id" type="var">v'</span>;<span class="id" type="tactic">ring</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0&lt;=v') <span class="id" type="tactic">by</span> <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">zarith</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">clearbody</span> <span class="id" type="var">v'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span> <span class="id" type="var">v</span> ; <span class="id" type="tactic">try</span> <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>                            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">false</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkFV</span> := <span class="id" type="var">FV</span> <span class="id" type="var">Zcst</span> <span class="id" type="var">Zpow_tac</span> <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zpower</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkPol</span> := <span class="id" type="var">mkPolexpr</span> <span class="id" type="var">Z</span> <span class="id" type="var">Zcst</span> <span class="id" type="var">Zpow_tac</span> <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> <span class="id" type="var">Zpower</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv</span> := <span class="id" type="var">mkFV</span> <span class="id" type="var">v</span>  (@<span class="id" type="var">List.nil</span> <span class="id" type="var">Z</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>::nil =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">ve</span> := <span class="id" type="var">mkPol</span> <span class="id" type="var">v</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">eval</span> <span class="id" type="var">vm_compute</span> <span class="id" type="keyword">in</span> (<span class="id" type="var">Ring_polynom.PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">nil</span> <span class="id" type="var">ve</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%Z =&gt; <span class="id" type="tactic">fail</span> 5<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">h</span> := <span class="id" type="tactic">fresh</span> "h" <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">h</span>:p - <span class="id" type="var">Ring_polynom.PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">nil</span> <span class="id" type="var">ve</span> &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Ring_polynom.PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">fv</span> <span class="id" type="var">ve</span> - <span class="id" type="var">Ring_polynom.PEeval</span> 0 <span class="id" type="var">Zplus</span> <span class="id" type="var">Zmult</span> <span class="id" type="var">Zminus</span> <span class="id" type="var">Zopp</span> (<span class="id" type="var">IDphi</span> (<span class="id" type="var">R</span>:=Z)) <span class="id" type="var">Z_of_N</span> <span class="id" type="var">Zpower</span> <span class="id" type="var">nil</span> <span class="id" type="var">ve</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[     <span class="id" type="var">lazy</span> <span class="id" type="var">beta</span> <span class="id" type="var">delta</span>  [<span class="id" type="var">Ring_polynom.PEeval</span> <span class="id" type="var">IDphi</span> <span class="id" type="var">BinList.nth</span> <span class="id" type="var">hd</span>] <span class="id" type="var">iota</span> <span class="id" type="var">zeta</span>; <span class="id" type="tactic">omega</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">lazy</span> <span class="id" type="var">beta</span> <span class="id" type="var">delta</span>  [<span class="id" type="var">Ring_polynom.PEeval</span> <span class="id" type="var">IDphi</span> <span class="id" type="var">BinList.nth</span> <span class="id" type="var">hd</span>] <span class="id" type="var">iota</span> <span class="id" type="var">zeta</span> <span class="id" type="keyword">in</span> <span class="id" type="var">h</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ring_simplify</span> <span class="id" type="keyword">in</span> <span class="id" type="var">h</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="tactic">fail</span> 4<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Omega</span>.<br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="var">interp</span>.<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">full_prove_ineq</span> <br/>
&nbsp;&nbsp;<span class="id" type="var">term_constructor</span><br/>
&nbsp;&nbsp;<span class="id" type="var">find_replacement</span> <br/>
&nbsp;&nbsp;<span class="id" type="var">osl_star</span> <br/>
&nbsp;&nbsp;<span class="id" type="var">mm</span><br/>
&nbsp;&nbsp;<span class="id" type="var">mm_star_monotonic</span> <br/>
&nbsp;&nbsp;<span class="id" type="var">order</span> <br/>
&nbsp;&nbsp;<span class="id" type="var">order_op</span> <br/>
&nbsp;&nbsp;<span class="id" type="var">simplify_star_reduction_R</span> <br/>
&nbsp;&nbsp;<span class="id" type="var">rew</span><br/>
&nbsp;&nbsp;<span class="id" type="var">gen_pos_hyp</span><br/>
&nbsp;&nbsp;<span class="id" type="var">pre_concl_tac</span><br/>
&nbsp;&nbsp;<span class="id" type="var">IHx</span><br/>
&nbsp;&nbsp;<span class="id" type="var">apply_subst</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">try</span> (<span class="id" type="var">simplify_star_reduction_R</span> <span class="id" type="var">tt</span> );<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">first</span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">complete</span> (<span class="id" type="tactic">apply</span> <span class="id" type="var">IHx</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">IHx</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id" type="var">order</span> <span class="id" type="var">_</span> (<span class="id" type="var">mm</span> (<span class="id" type="var">term_constructor</span> ?f ?l)) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">l'</span> := <span class="id" type="var">find_replacement</span> <span class="id" type="var">l</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">order_op</span>).(<span class="id" type="var">interp.le_lt_compat_right</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> (<span class="id" type="var">mm</span> (<span class="id" type="var">term_constructor</span> <span class="id" type="var">f</span> <span class="id" type="var">l'</span>) ) ;[|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">mm_star_monotonic</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">apply</span> <span class="id" type="var">osl_star</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">assumption</span> || <span class="id" type="var">constructor</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="var">apply_subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rew</span> <span class="id" type="var">tt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="var">gen_pos_hyp</span> <span class="id" type="var">tt</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">pre_concl_tac</span> <span class="id" type="var">tt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">omega</span>) || <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">repeat</span> <span class="id" type="var">translate_vars</span>;( <span class="id" type="var">ring_ineq</span>|| <span class="id" type="var">prove_ineq</span> )))|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">IHx'</span> := <span class="id" type="tactic">fresh</span> "IHx" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" type="var">Acc</span> ?R ?t =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">IHx'</span>:forall <span class="id" type="var">y</span>, <span class="id" type="var">order</span> (<span class="id" type="var">mm</span> <span class="id" type="var">y</span>) (<span class="id" type="var">mm</span> <span class="id" type="var">t</span>) -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R</span> <span class="id" type="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" type="keyword">let</span> <span class="id" type="var">y</span> := <span class="id" type="tactic">fresh</span> "y" <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">x</span> := <span class="id" type="tactic">fresh</span> "x" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> "H" <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">y</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHx</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">IHx</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id" type="var">order</span> <span class="id" type="var">_</span> (<span class="id" type="var">mm</span> (<span class="id" type="var">term_constructor</span> ?f ?l)) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">l'</span> := <span class="id" type="var">find_replacement</span> <span class="id" type="var">l</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">order_op</span>).(<span class="id" type="var">interp.le_lt_compat_right</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> (<span class="id" type="var">mm</span> (<span class="id" type="var">term_constructor</span> <span class="id" type="var">f</span> <span class="id" type="var">l'</span>) ) ;[|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">mm_star_monotonic</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">apply</span> <span class="id" type="var">osl_star</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">assumption</span> || <span class="id" type="var">constructor</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">order</span> <span class="id" type="var">_</span> ?u =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">order_op</span>).(<span class="id" type="var">interp.le_lt_compat_right</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">u</span>;[<span class="id" type="tactic">assumption</span>|]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span>;<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="var">apply_subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rew</span> <span class="id" type="var">tt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="var">gen_pos_hyp</span> <span class="id" type="var">tt</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">pre_concl_tac</span> <span class="id" type="var">tt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" type="tactic">omega</span>) || ((<span class="id" type="tactic">repeat</span> <span class="id" type="var">translate_vars</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">prove_ineq</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="tactic">clear</span> <span class="id" type="var">IHx</span>;<span class="id" type="tactic">rename</span> <span class="id" type="var">IHx'</span> <span class="id" type="var">into</span> <span class="id" type="var">IHx</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> | <span class="id" type="var">H</span>: <span class="id" type="var">terminaison.star</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> =&gt; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span> <span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;].<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://www.lix.polytechnique.fr/coq/">coqdoc</a>
</div>

</div>

</body>
</html>