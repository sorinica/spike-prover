<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>basis.closure</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library basis.closure</h1>

<div class="code">

<br/>
<span class="id" type="keyword">Set</span> <span class="id" type="keyword">Implicit</span> <span class="id" type="var">Arguments</span>.<br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Setoid</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Relations</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">List</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Wellfounded</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <span class="id" type="var">TransClosure</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_trans</span> :<br/>
&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) <span class="id" type="var">a</span>, <span class="id" type="var">Acc</span> <span class="id" type="var">R</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">trans_clos</span> <span class="id" type="var">R</span>) <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">a</span> <span class="id" type="var">Acc_R_a</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_R_a</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a</span> <span class="id" type="var">Acc_R_a</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b</span> <span class="id" type="var">b_Rp_a</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">b_Rp_a</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_inv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHb_Rp_a</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">wf_trans</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) , <span class="id" type="var">well_founded</span> <span class="id" type="var">R</span> -&gt; <span class="id" type="var">well_founded</span> (<span class="id" type="var">trans_clos</span> <span class="id" type="var">R</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">well_founded</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">WR</span>.<br/>
<span class="id" type="tactic">intro</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">acc_trans</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">WR</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">trans_incl</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R1</span> <span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>), <span class="id" type="var">inclusion</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> -&gt; <span class="id" type="var">inclusion</span> <span class="id" type="var">_</span> (<span class="id" type="var">trans_clos</span> <span class="id" type="var">R1</span>) (<span class="id" type="var">trans_clos</span> <span class="id" type="var">R2</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">R1_in_R2</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a'</span> <span class="id" type="var">b'</span> <span class="id" type="var">H</span> | <span class="id" type="var">a'</span> <span class="id" type="var">b'</span> <span class="id" type="var">c'</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">R1_in_R2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">R1_in_R2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">refl_trans_incl</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R1</span> <span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>), <span class="id" type="var">inclusion</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> -&gt; <span class="id" type="var">inclusion</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R2</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">R1_in_R2</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> [<span class="id" type="var">a'</span> | <span class="id" type="var">a'</span> <span class="id" type="var">b'</span> <span class="id" type="var">H</span>].<br/>
<span class="id" type="var">left</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_clos</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">trans_incl2</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> (<span class="id" type="var">f</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="var">B</span>) (<span class="id" type="var">R1</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">B</span>), <br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>, <span class="id" type="var">R1</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> -&gt; <span class="id" type="var">R2</span> (<span class="id" type="var">f</span> <span class="id" type="var">a1</span>) (<span class="id" type="var">f</span> <span class="id" type="var">a2</span>)) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>, <span class="id" type="var">trans_clos</span> <span class="id" type="var">R1</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> -&gt;  <span class="id" type="var">trans_clos</span> <span class="id" type="var">R2</span> (<span class="id" type="var">f</span> <span class="id" type="var">a1</span>) (<span class="id" type="var">f</span> <span class="id" type="var">a2</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">f</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">R1_in_R2</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a'</span> <span class="id" type="var">b'</span> <span class="id" type="var">H</span> | <span class="id" type="var">a'</span> <span class="id" type="var">b'</span> <span class="id" type="var">c'</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">R1_in_R2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">f</span> <span class="id" type="var">b'</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">R1_in_R2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">trans_with_eq</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>, <br/>
&nbsp;&nbsp;<span class="id" type="var">trans_clos</span> (<span class="id" type="var">union</span> <span class="id" type="var">A</span> (@<span class="id" type="var">eq</span> <span class="id" type="var">_</span>) <span class="id" type="var">R</span>) <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> &lt;-&gt; <span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b1</span> <span class="id" type="var">b2</span> <span class="id" type="var">H</span> | <span class="id" type="var">b1</span> <span class="id" type="var">b2</span> <span class="id" type="var">b3</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>].<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H</span> | <span class="id" type="var">H</span>].<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">b2</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">r_step</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_clos</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">H1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H1</span> | <span class="id" type="var">H1</span>].<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">b2</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHH2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b2</span> <span class="id" type="var">H3</span> | <span class="id" type="var">b2</span> <span class="id" type="var">b3</span> <span class="id" type="var">H3</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_clos</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_clos</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b2</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a1</span> <span class="id" type="var">H</span> | <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> <span class="id" type="var">H</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">refl_equal</span>.<br/>
<span class="id" type="tactic">apply</span> (@<span class="id" type="var">trans_incl</span> <span class="id" type="var">_</span> <span class="id" type="var">R</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_star</span> : <br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) <span class="id" type="var">a</span>, <span class="id" type="var">Acc</span> <span class="id" type="var">R</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">b</span>,  <span class="id" type="var">refl_trans_clos</span>  <span class="id" type="var">R</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a1</span> <span class="id" type="var">H</span> | <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> <span class="id" type="var">H</span>].<br/>
<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">trans_clos</span> <span class="id" type="var">R</span>).<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b1</span> <span class="id" type="var">b2</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_inv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">acc_trans</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">compose_rel</span> <span class="id" type="var">A</span> (<span class="id" type="var">R1</span> <span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) : <span class="id" type="var">relation</span> <span class="id" type="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">Comp</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> <span class="id" type="var">a3</span>, <span class="id" type="var">R1</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> -&gt; <span class="id" type="var">R2</span> <span class="id" type="var">a2</span> <span class="id" type="var">a3</span> -&gt; <span class="id" type="var">compose_rel</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">a1</span> <span class="id" type="var">a3</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <span class="id" type="var">Compose</span>.<br/>
<span class="id" type="keyword">Variable</span> <span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>.<br/>
<span class="id" type="keyword">Variable</span> <span class="id" type="var">R1</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>.<br/>
<span class="id" type="keyword">Variable</span> <span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">trans_union</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">trans_clos</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span> <span class="id" type="var">b</span> &lt;-&gt; <br/>
&nbsp;&nbsp;<span class="id" type="var">union</span> <span class="id" type="var">_</span> (<span class="id" type="var">trans_clos</span> <span class="id" type="var">R1</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) (<span class="id" type="var">trans_clos</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)))) <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H1</span> | <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">H1</span> <span class="id" type="var">Hn</span>].<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">H1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H1</span> | <span class="id" type="var">H1</span>].<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">x</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">r_step</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">r_step</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">H1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H1</span> | <span class="id" type="var">H2</span>]; <span class="id" type="tactic">destruct</span> <span class="id" type="var">IHHn</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">IHHn</span> | <span class="id" type="var">IHHn</span>].<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">IHHn</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x'</span> <span class="id" type="var">y'</span> <span class="id" type="var">z'</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2</span>]; <span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span> <span class="id" type="var">z'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">IHHn</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y'</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">y1</span> | <span class="id" type="var">y1</span> <span class="id" type="var">y2</span> <span class="id" type="var">K1'</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">K1</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y'</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_clos</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y2</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_clos</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">x</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">r_step</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_clos</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">IHHn</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x'</span> <span class="id" type="var">y'</span> <span class="id" type="var">z'</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2</span>]; <span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span> <span class="id" type="var">z'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">IHHn</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">x</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">r_step</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">H</span> | <span class="id" type="var">H</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x'</span> <span class="id" type="var">y'</span> <span class="id" type="var">z'</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span> <span class="id" type="var">z'</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">y1</span> | <span class="id" type="var">y1</span> <span class="id" type="var">y2</span> <span class="id" type="var">K1'</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">K1</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y'</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_clos</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">K2</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">K2</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x'</span> <span class="id" type="var">y'</span> <span class="id" type="var">z'</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2'</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">K2</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span> <span class="id" type="var">z'</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K2'</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">y1</span> | <span class="id" type="var">y1</span> <span class="id" type="var">y2</span> <span class="id" type="var">K2''</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">K2'</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y'</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y'</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y'</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_clos</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">y'</span> <span class="id" type="var">K1'</span> <span class="id" type="var">K2</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">K2</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x'</span> <span class="id" type="var">y'</span> <span class="id" type="var">z'</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2'</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">K2</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span> <span class="id" type="var">z'</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K2'</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">y1</span> | <span class="id" type="var">y1</span> <span class="id" type="var">y2</span> <span class="id" type="var">K2''</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">K2'</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y'</span> <span class="id" type="var">y1</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y2</span>.<br/>
<span class="id" type="var">right</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y'</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">trans_union_alt</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">trans_clos</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span> <span class="id" type="var">b</span> &lt;-&gt; <br/>
&nbsp;&nbsp;<span class="id" type="var">union</span> <span class="id" type="var">_</span> (<span class="id" type="var">trans_clos</span> <span class="id" type="var">R1</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">compose_rel</span> (<span class="id" type="var">trans_clos</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) <span class="id" type="var">R2</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)) <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">trans_clos_trans_clos_alt</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H1</span> | <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">H1</span> <span class="id" type="var">IHH1</span> <span class="id" type="var">Hn</span>].<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">H1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H1</span> | <span class="id" type="var">H1</span>].<br/>
<span class="id" type="var">left</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>.<br/>
<span class="id" type="var">left</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHH1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">IHH1</span> | <span class="id" type="var">IHH1</span>]; <span class="id" type="tactic">destruct</span> <span class="id" type="var">Hn</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">Hn</span> | <span class="id" type="var">Hn</span>].<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">trans_clos_trans_clos_alt</span> <span class="id" type="keyword">in</span> *; <span class="id" type="var">right</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">z</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">IHH1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x'</span> <span class="id" type="var">y'</span> <span class="id" type="var">z'</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2</span>]; <span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span> <span class="id" type="var">z'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">IHH1</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">y''</span> | <span class="id" type="var">a</span> <span class="id" type="var">a'</span> <span class="id" type="var">K2'</span> <span class="id" type="var">K2''</span>].<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y'</span> <span class="id" type="var">y''</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">a</span> <span class="id" type="var">a'</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">IHH1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x'</span> <span class="id" type="var">y'</span> <span class="id" type="var">z'</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2</span>]; <span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span> <span class="id" type="var">z'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">IHH1</span>.<br/>
<span class="id" type="var">right</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">z</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>.<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">H</span> | <span class="id" type="var">H</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x'</span> <span class="id" type="var">y'</span> <span class="id" type="var">z'</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span> <span class="id" type="var">z'</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">y1</span> | <span class="id" type="var">y1</span> <span class="id" type="var">y2</span> <span class="id" type="var">K2'</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">K2</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y'</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_clos</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) <span class="id" type="var">R2</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">K1</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x'</span> <span class="id" type="var">y'</span> <span class="id" type="var">z'</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2</span>]; <span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span> <span class="id" type="var">z'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">y1</span> | <span class="id" type="var">y1</span> <span class="id" type="var">y2</span> <span class="id" type="var">K1'</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">K1</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y'</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y'</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y'</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_clos</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) <span class="id" type="var">R2</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">y'</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2'</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x'</span> <span class="id" type="var">y'</span> <span class="id" type="var">z'</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2</span>]; <span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span> <span class="id" type="var">z'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">y1</span> | <span class="id" type="var">y1</span> <span class="id" type="var">y2</span> <span class="id" type="var">K1'</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">K1</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y'</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">y1</span> <span class="id" type="var">y2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y'</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_union</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">well_founded</span> <span class="id" type="var">R1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)) <span class="id" type="var">a</span> &lt;-&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">W1'</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">W1</span> := <span class="id" type="var">wf_trans</span> <span class="id" type="var">W1'</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">W1'</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">Acc_a</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_a</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a</span> <span class="id" type="var">Acc_a'</span> <span class="id" type="var">IH2</span>].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Acc_a</span> : <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)) <span class="id" type="var">a</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">Acc_a'</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">IH2</span> <span class="id" type="var">Acc_a</span>.<br/>
<span class="id" type="tactic">pattern</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">apply</span> (<span class="id" type="var">well_founded_ind</span> <span class="id" type="var">W1</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">IH1</span> <span class="id" type="var">IH2</span> <span class="id" type="var">Acc_a</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b</span> [<span class="id" type="var">H1</span> | <span class="id" type="var">H2</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH1</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">H2</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">IH2</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">c'</span> <span class="id" type="var">d'</span> <span class="id" type="var">b'</span> <span class="id" type="var">H</span> <span class="id" type="var">H'</span>]; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">d'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">H2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_inv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">c'</span> <span class="id" type="var">d'</span> <span class="id" type="var">b'</span> <span class="id" type="var">H</span> <span class="id" type="var">H'</span>]; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">d'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">r_step</span>.<br/>

<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">Acc_a</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">trans_clos</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>)).<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a3</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b1</span> <span class="id" type="var">b2</span> <span class="id" type="var">b3</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">a1</span> <span class="id" type="var">a3</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b</span> | <span class="id" type="var">a2</span> <span class="id" type="var">a3</span> <span class="id" type="var">K2</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H2</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b2</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">acc_trans</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_union_weak</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)) <span class="id" type="var">a</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">b</span>, <span class="id" type="var">refl_trans_clos</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)) <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R1</span> <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Acc</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">H</span>; <br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_a</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a</span> <span class="id" type="var">Acc_a'</span> <span class="id" type="var">IH2</span>].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Acc_a</span> : <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)) <span class="id" type="var">a</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">Acc_a'</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Acc1_a</span> : <span class="id" type="var">Acc</span> <span class="id" type="var">R1</span> <span class="id" type="var">a</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>; <span class="id" type="var">left</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">IH2</span> <span class="id" type="var">H</span> <span class="id" type="var">Acc_a</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">Acc1_a</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a</span> <span class="id" type="var">Acc1_a</span> <span class="id" type="var">IH1</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">IH2</span> <span class="id" type="var">H</span> <span class="id" type="var">Acc_a</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b</span> [<span class="id" type="var">H1</span> | <span class="id" type="var">H2</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">H2</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">IH2</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">c'</span> <span class="id" type="var">d'</span> <span class="id" type="var">b'</span> <span class="id" type="var">h</span> <span class="id" type="var">H'</span>]; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">d'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">K</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">K</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">K</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc1_a</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">trans_clos_trans_clos_alt</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H0</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H0</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H2</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H2</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">exact</span> <span class="id" type="var">H1</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H3</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H3</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">trans_clos_trans_clos_alt</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">exact</span> <span class="id" type="var">H1</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">K</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_inv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">K</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">exact</span> <span class="id" type="var">H1</span>.<br/>

<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; [<span class="id" type="tactic">assumption</span> | <span class="id" type="var">left</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">K</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; [<span class="id" type="tactic">assumption</span> | <span class="id" type="var">left</span>].<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_union_alt</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">well_founded</span> <span class="id" type="var">R1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, (<span class="id" type="keyword">forall</span> <span class="id" type="var">b</span>, <span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) <span class="id" type="var">R2</span>) <span class="id" type="var">b</span>) &lt;-&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">W1'</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">Ha</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">acc_union_weak</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">b4</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a4</span> <span class="id" type="var">b2</span> <span class="id" type="var">a1</span> <span class="id" type="var">H'</span> <span class="id" type="var">H21</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Acc_b2</span> := <span class="id" type="var">Ha</span> <span class="id" type="var">b2</span> <span class="id" type="var">H21</span>).<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">a</span> <span class="id" type="var">Ha</span> <span class="id" type="var">b4</span> <span class="id" type="var">H'</span> <span class="id" type="var">H21</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_b2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b2</span> <span class="id" type="var">Acc_b2</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">Ha</span> <span class="id" type="var">b4</span> <span class="id" type="var">H'</span> <span class="id" type="var">H21</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b6</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a6</span> <span class="id" type="var">b5</span> <span class="id" type="var">a4</span> <span class="id" type="var">H65</span> <span class="id" type="var">H54</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b5</span> <span class="id" type="var">b4</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b4</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b7</span> <span class="id" type="var">H7</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_b2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b4</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">trans_clos</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>)).<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a3</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b1</span> <span class="id" type="var">b2</span> <span class="id" type="var">b3</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">a1</span> <span class="id" type="var">a3</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b</span> | <span class="id" type="var">a2</span> <span class="id" type="var">a3</span> <span class="id" type="var">K1</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a'</span> | <span class="id" type="var">b'</span> <span class="id" type="var">a'</span> <span class="id" type="var">K</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">acc_trans</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_inv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">acc_trans</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_union_alt_weak</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, (<span class="id" type="keyword">forall</span> <span class="id" type="var">b</span>, <span class="id" type="var">refl_trans_clos</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)) <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R1</span> <span class="id" type="var">b</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">b</span>, <span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) <span class="id" type="var">R2</span>) <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Acc</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">H1a</span> <span class="id" type="var">H2a</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">acc_union_weak</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">H1a</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">b4</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a4</span> <span class="id" type="var">b2</span> <span class="id" type="var">a1</span> <span class="id" type="var">H'</span> <span class="id" type="var">H21</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Acc_b2</span> := <span class="id" type="var">H2a</span> <span class="id" type="var">b2</span> <span class="id" type="var">H21</span>).<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">a</span> <span class="id" type="var">H2a</span> <span class="id" type="var">b4</span> <span class="id" type="var">H'</span> <span class="id" type="var">H21</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_b2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b2</span> <span class="id" type="var">Acc_b2</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">Ha</span> <span class="id" type="var">b4</span> <span class="id" type="var">H'</span> <span class="id" type="var">H21</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b6</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a6</span> <span class="id" type="var">b5</span> <span class="id" type="var">a4</span> <span class="id" type="var">H65</span> <span class="id" type="var">H54</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b5</span> <span class="id" type="var">b4</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b4</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b7</span> <span class="id" type="var">H7</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_b2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b4</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">wf_union_alt</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">well_founded</span> <span class="id" type="var">R1</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" type="var">well_founded</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) <span class="id" type="var">R2</span>) &lt;-&gt; <span class="id" type="var">well_founded</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">W1'</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">W</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">acc_union</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">W1</span> := <span class="id" type="var">wf_trans</span> <span class="id" type="var">W1'</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">W1'</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b4</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a4</span> <span class="id" type="var">b2</span> <span class="id" type="var">a1</span> <span class="id" type="var">H'</span> <span class="id" type="var">H21</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">a</span> <span class="id" type="var">H21</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">b4</span> <span class="id" type="var">H'</span>.<br/>
<span class="id" type="tactic">pattern</span> <span class="id" type="var">b2</span>; <span class="id" type="tactic">apply</span> (<span class="id" type="var">well_founded_ind</span> (<span class="id" type="var">wf_trans</span> <span class="id" type="var">W</span>)); <span class="id" type="tactic">clear</span> <span class="id" type="var">b2</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">IH</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">K</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">d'</span> <span class="id" type="var">c'</span> <span class="id" type="var">b'</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>];<span class="id" type="tactic">clear</span> <span class="id" type="var">K</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span> <span class="id" type="keyword">with</span> <span class="id" type="var">c'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">W</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">trans_clos</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>)).<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a3</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b1</span> <span class="id" type="var">b2</span> <span class="id" type="var">b3</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">a1</span> <span class="id" type="var">a3</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b</span> | <span class="id" type="var">a2</span> <span class="id" type="var">a3</span> <span class="id" type="var">K1</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">acc_trans</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">W</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_comp_incl</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">R</span>, (<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <span class="id" type="var">Acc</span> <span class="id" type="var">R</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span>) -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <span class="id" type="var">Acc</span> <span class="id" type="var">R</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) <span class="id" type="var">R2</span>) <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">R</span> <span class="id" type="var">H</span> <span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">trans_clos</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>)).<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">c1</span> <span class="id" type="var">c2</span> <span class="id" type="var">c3</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">c</span> | <span class="id" type="var">b1</span> <span class="id" type="var">b2</span> <span class="id" type="var">K3</span> <span class="id" type="var">K4</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">K1</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">c2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">acc_trans</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Compose</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">rest</span> <span class="id" type="var">A</span> <span class="id" type="var">P</span> <span class="id" type="var">R</span> := <span class="id" type="keyword">fun</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">A</span>) =&gt; <span class="id" type="var">R</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> /\ <span class="id" type="var">P</span> <span class="id" type="var">a</span> /\ <span class="id" type="var">P</span> <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">rest_union</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">P</span> (<span class="id" type="var">R1</span> <span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <span class="id" type="var">rest</span> <span class="id" type="var">P</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span> <span class="id" type="var">b</span> &lt;-&gt; <span class="id" type="var">union</span> <span class="id" type="var">_</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R1</span>) (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">P</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">intros</span> [[<span class="id" type="var">H1</span> | <span class="id" type="var">H2</span>] [<span class="id" type="var">Pa</span> <span class="id" type="var">Pb</span>]]; [<span class="id" type="var">left</span> | <span class="id" type="var">right</span>]; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">intros</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">Pa</span> <span class="id" type="var">Pb</span>]] | [<span class="id" type="var">H2</span> [<span class="id" type="var">Pa</span> <span class="id" type="var">Pb</span>]]]; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">rest_trans</span> : <br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">P</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>) (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>), (<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">R</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">P</span> <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">b</span>, <span class="id" type="var">trans_clos</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R</span>) <span class="id" type="var">b</span> <span class="id" type="var">a</span> &lt;-&gt; <span class="id" type="var">trans_clos</span> <span class="id" type="var">R</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">P</span> <span class="id" type="var">R</span> <span class="id" type="var">Inv</span> <span class="id" type="var">a</span> <span class="id" type="var">Pa</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_incl</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> [<span class="id" type="var">H</span> <span class="id" type="var">_</span>]; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">trans_clos_trans_clos_alt</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">trans_clos_trans_clos_alt</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">K</span> | <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">K1</span> <span class="id" type="var">K2</span>].<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Py</span> := <span class="id" type="var">Inv</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Pa</span> <span class="id" type="var">H</span>).<br/>
<span class="id" type="var">right</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>.<br/>
<span class="id" type="tactic">exact</span> (<span class="id" type="var">K2</span> <span class="id" type="var">Py</span>).<br/>
<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_rest</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">P</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">A</span>), <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">R</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">P</span> <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, (<span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R</span> <span class="id" type="var">a</span>) &lt;-&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R</span>) <span class="id" type="var">a</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">P</span> <span class="id" type="var">Inv</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">K</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">b</span> [<span class="id" type="var">H</span> [<span class="id" type="var">Wb</span> <span class="id" type="var">Wa</span>]].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_inv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R</span>.<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> [<span class="id" type="var">H</span> <span class="id" type="var">_</span>]; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">K</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">Acc_a</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_a</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">Pa</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span>.<br/>
<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">wf_rest</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">P</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">A</span>), <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">R</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">P</span> <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;((<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R</span> <span class="id" type="var">a</span>) &lt;-&gt;  <span class="id" type="var">well_founded</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R</span>)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">P</span> <span class="id" type="var">Inv</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">W</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">acc_rest</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">W</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">W</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">acc_rest</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_union_rest</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R1</span> <span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">P</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">A</span>), <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">R1</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">P</span> <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">A</span>), <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">R2</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">P</span> <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R1</span> <span class="id" type="var">a</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)) <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">P</span> <span class="id" type="var">Inv1</span> <span class="id" type="var">Inv2</span> <span class="id" type="var">W1'</span> <span class="id" type="var">a</span> <span class="id" type="var">Wa</span> <span class="id" type="var">Acc_a</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">wf_rest</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W1'</span>.<br/>
<span class="id" type="tactic">set</span> (<span class="id" type="var">R1'</span> := <span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> =&gt; <span class="id" type="var">R1</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> /\ <span class="id" type="var">P</span> <span class="id" type="var">a</span> /\ <span class="id" type="var">P</span> <span class="id" type="var">b</span>) <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">W1</span> := <span class="id" type="var">wf_trans</span> <span class="id" type="var">W1'</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">W1'</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">Wa</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_a</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a</span> <span class="id" type="var">Acc_a'</span> <span class="id" type="var">IH2</span>].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Acc_a</span> : <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)) <span class="id" type="var">a</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">Acc_a'</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">IH2</span> <span class="id" type="var">Acc_a</span>.<br/>
<span class="id" type="tactic">pattern</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">apply</span> (<span class="id" type="var">well_founded_ind</span> <span class="id" type="var">W1</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">IH1</span> <span class="id" type="var">IH2</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">Wa</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b</span> [<span class="id" type="var">H1</span> | <span class="id" type="var">H2</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH1</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">H2</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">IH2</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">c'</span> <span class="id" type="var">d'</span> <span class="id" type="var">b'</span> <span class="id" type="var">H</span> <span class="id" type="var">H'</span>]; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">d'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">H2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_inv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">c'</span> <span class="id" type="var">d'</span> <span class="id" type="var">b'</span> <span class="id" type="var">H</span> <span class="id" type="var">H'</span>]; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">d'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">r_step</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv2</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_union_rest_alt</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R1</span> <span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">P</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">A</span>), <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">R1</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">P</span> <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">A</span>), <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">R2</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">P</span> <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R1</span> <span class="id" type="var">a</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, (<span class="id" type="keyword">forall</span> <span class="id" type="var">b</span>, <span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) <span class="id" type="var">R2</span>) <span class="id" type="var">b</span>) -&gt; <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">P</span> <span class="id" type="var">Inv1</span> <span class="id" type="var">Inv2</span> <span class="id" type="var">W1'</span> <span class="id" type="var">a</span> <span class="id" type="var">W</span> <span class="id" type="var">Pa</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> : <span class="id" type="var">Acc</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R1</span>) (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R2</span>)) <span class="id" type="var">a</span>).<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">acc_union_alt</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) <span class="id" type="var">R2</span>).<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">c1</span> <span class="id" type="var">a</span> <span class="id" type="var">c2</span> <span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">_</span>]]; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">assumption</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R1</span>); [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">assumption</span>].<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> [<span class="id" type="var">H</span> <span class="id" type="var">_</span>]; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">W</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R1</span>); [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">assumption</span>].<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> [<span class="id" type="var">H</span> <span class="id" type="var">_</span>]; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">wf_rest</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W1'</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">W</span>; <span class="id" type="var">revert</span> <span class="id" type="var">Pa</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">Pa</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> [<span class="id" type="var">H1</span> | <span class="id" type="var">H2</span>]; <span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv2</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv2</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_union_rest_alt_weak</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R1</span> <span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">P</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">A</span>), <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">R1</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">P</span> <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">A</span>), <span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">R2</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">P</span> <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, (<span class="id" type="keyword">forall</span> <span class="id" type="var">b</span>, <span class="id" type="var">refl_trans_clos</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R2</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>)) <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R1</span> <span class="id" type="var">b</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">b</span>, <span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) <span class="id" type="var">R2</span>) <span class="id" type="var">b</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">P</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">P</span> <span class="id" type="var">Inv1</span> <span class="id" type="var">Inv2</span> <span class="id" type="var">a</span> <span class="id" type="var">H1a</span> <span class="id" type="var">H2a</span> <span class="id" type="var">Pa</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> : <span class="id" type="var">Acc</span> (<span class="id" type="var">union</span> <span class="id" type="var">_</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R1</span>) (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R2</span>)) <span class="id" type="var">a</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">acc_union_alt_weak</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_incl</span> <span class="id" type="keyword">with</span> <span class="id" type="var">R1</span>.<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> [<span class="id" type="var">H</span> <span class="id" type="var">_</span>]; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H1a</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R2</span>) (<span class="id" type="var">refl_trans_clos</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R1</span>))); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">c1</span> <span class="id" type="var">a</span> <span class="id" type="var">c2</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>]; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R1</span>); [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">assumption</span>].<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> [<span class="id" type="var">H</span> <span class="id" type="var">_</span>]; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">compose_rel</span> (<span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span>) <span class="id" type="var">R2</span>).<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">c1</span> <span class="id" type="var">a</span> <span class="id" type="var">c2</span> <span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">_</span>]]; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">assumption</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R1</span>); [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">assumption</span>].<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> [<span class="id" type="var">H</span> <span class="id" type="var">_</span>]; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H2a</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">refl_trans_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">rest</span> <span class="id" type="var">P</span> <span class="id" type="var">R1</span>); [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">assumption</span>].<br/>
<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> [<span class="id" type="var">H</span> <span class="id" type="var">_</span>]; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">H1a</span> <span class="id" type="var">H2a</span>; <span class="id" type="var">revert</span> <span class="id" type="var">Pa</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">Pa</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> [<span class="id" type="var">H1</span> | <span class="id" type="var">H2</span>]; <span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv2</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Inv2</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">accR2</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) <span class="id" type="var">a</span>, <span class="id" type="var">Acc</span> <span class="id" type="var">R</span> <span class="id" type="var">a</span> &lt;-&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">compose_rel</span> <span class="id" type="var">R</span> <span class="id" type="var">R</span>) <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">Acc_a</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_incl</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">trans_clos</span> <span class="id" type="var">R</span>).<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">z</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x'</span> <span class="id" type="var">y</span> <span class="id" type="var">z'</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">acc_trans</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">Acc_a</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_a</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">b</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">H'</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Comp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_inv_im</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> (<span class="id" type="var">R1</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">B</span>) (<span class="id" type="var">f</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>, <span class="id" type="var">R1</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> -&gt; <span class="id" type="var">R2</span> (<span class="id" type="var">f</span> <span class="id" type="var">a1</span>) (<span class="id" type="var">f</span> <span class="id" type="var">a2</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <span class="id" type="var">Acc</span> <span class="id" type="var">R2</span> (<span class="id" type="var">f</span> <span class="id" type="var">a</span>) -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R1</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">f</span> <span class="id" type="var">H</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="tactic">set</span> (<span class="id" type="var">b</span> := <span class="id" type="var">f</span> <span class="id" type="var">a</span>) <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">b_eq_fa</span> := <span class="id" type="var">refl_equal</span> <span class="id" type="var">b</span>).<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">b</span> <span class="id" type="tactic">at</span> 2 <span class="id" type="keyword">in</span> <span class="id" type="var">b_eq_fa</span>; <span class="id" type="var">clearbody</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">Acc_b</span>; <span class="id" type="var">revert</span> <span class="id" type="var">a</span> <span class="id" type="var">b_eq_fa</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_b</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b</span> <span class="id" type="var">Acc_b</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b_eq_fa</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a'</span> <span class="id" type="var">H'</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">f</span> <span class="id" type="var">a'</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_inv_im2</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> (<span class="id" type="var">R1</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">B</span>) (<span class="id" type="var">f</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="var">B</span>),<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, (<span class="id" type="keyword">forall</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span> <span class="id" type="var">a3</span>, <span class="id" type="var">R1</span> <span class="id" type="var">a3</span> <span class="id" type="var">a2</span> -&gt; <span class="id" type="var">R1</span> <span class="id" type="var">a2</span> <span class="id" type="var">a1</span> -&gt; <span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span> <span class="id" type="var">a1</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">R2</span> (<span class="id" type="var">f</span> <span class="id" type="var">a2</span>) (<span class="id" type="var">f</span> <span class="id" type="var">a1</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">Acc</span> <span class="id" type="var">R2</span> (<span class="id" type="var">f</span> <span class="id" type="var">a</span>) -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R1</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">f</span> <span class="id" type="var">a</span> <span class="id" type="var">Hinv</span> <span class="id" type="var">Acc_b</span>.<br/>
<span class="id" type="tactic">set</span> (<span class="id" type="var">b</span> := <span class="id" type="var">f</span> <span class="id" type="var">a</span>) <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">b_eq_fa</span> := <span class="id" type="var">refl_equal</span> <span class="id" type="var">b</span>).<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">b</span> <span class="id" type="tactic">at</span> 2 <span class="id" type="keyword">in</span> <span class="id" type="var">b_eq_fa</span>; <span class="id" type="var">clearbody</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">a</span> <span class="id" type="var">b_eq_fa</span> <span class="id" type="var">Hinv</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_b</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b</span> <span class="id" type="var">Acc_b</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b_eq_fa</span> <span class="id" type="var">Hinv</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a2</span> <span class="id" type="var">H2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a3</span> <span class="id" type="var">H3</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_inv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">f</span> <span class="id" type="var">a2</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hinv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a3</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">Hinv</span> <span class="id" type="var">H2</span>; <span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">Hinv</span> <span class="id" type="var">H2</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b1</span> <span class="id" type="var">b2</span> <span class="id" type="var">b3</span> <span class="id" type="var">K3</span> <span class="id" type="var">K2</span> <span class="id" type="var">K1</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Hinv</span> <span class="id" type="keyword">with</span> <span class="id" type="var">b3</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b</span> | <span class="id" type="var">b'</span> <span class="id" type="var">a'</span> <span class="id" type="var">K1'</span>].<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_inv_im3</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> (<span class="id" type="var">R1</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">B</span>) (<span class="id" type="var">f</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="var">B</span>),<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, (<span class="id" type="keyword">forall</span> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>, <span class="id" type="var">R1</span> <span class="id" type="var">a2</span> <span class="id" type="var">a1</span> -&gt; <span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">R1</span> <span class="id" type="var">a1</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">R2</span> (<span class="id" type="var">f</span> <span class="id" type="var">a2</span>) (<span class="id" type="var">f</span> <span class="id" type="var">a1</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">Acc</span> <span class="id" type="var">R2</span> (<span class="id" type="var">f</span> <span class="id" type="var">a</span>) -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R1</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">f</span> <span class="id" type="var">a</span> <span class="id" type="var">Hinv</span> <span class="id" type="var">Acc_b</span>.<br/>
<span class="id" type="tactic">set</span> (<span class="id" type="var">b</span> := <span class="id" type="var">f</span> <span class="id" type="var">a</span>) <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">b_eq_fa</span> := <span class="id" type="var">refl_equal</span> <span class="id" type="var">b</span>).<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">b</span> <span class="id" type="tactic">at</span> 2 <span class="id" type="keyword">in</span> <span class="id" type="var">b_eq_fa</span>; <span class="id" type="var">clearbody</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">a</span> <span class="id" type="var">b_eq_fa</span> <span class="id" type="var">Hinv</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_b</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b</span> <span class="id" type="var">Acc_b</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b_eq_fa</span> <span class="id" type="var">Hinv</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a2</span> <span class="id" type="var">H2</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">f</span> <span class="id" type="var">a2</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hinv</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">Hinv</span> <span class="id" type="var">H2</span>; <span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">Hinv</span> <span class="id" type="var">H2</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b1</span> <span class="id" type="var">b2</span> <span class="id" type="var">K2</span> <span class="id" type="var">K1</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Hinv</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">inversion</span> <span class="id" type="var">K1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b</span> | <span class="id" type="var">b'</span> <span class="id" type="var">a'</span> <span class="id" type="var">K1'</span>].<br/>
<span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">union_equiv</span> : <br/>
<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">R3</span> <span class="id" type="var">R4</span> (<span class="id" type="var">R1_equiv_R3</span>: <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">R1</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> &lt;-&gt; <span class="id" type="var">R3</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>)<br/>
(<span class="id" type="var">R2_equiv_R4</span>: <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">R2</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> &lt;-&gt; <span class="id" type="var">R4</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>) <span class="id" type="var">x</span> <span class="id" type="var">y</span>,<br/>
(<span class="id" type="var">union</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> &lt;-&gt; <span class="id" type="var">union</span> <span class="id" type="var">_</span> <span class="id" type="var">R3</span> <span class="id" type="var">R4</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">R3</span> <span class="id" type="var">R4</span> <span class="id" type="var">R1_equiv_R3</span> <span class="id" type="var">R2_equiv_R4</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">case</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">R1_equiv_R3</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">H'</span>;<span class="id" type="var">left</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">H'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">R2_equiv_R4</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">H'</span>;<span class="id" type="var">right</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">H'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">R1_equiv_R3</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">H'</span>;<span class="id" type="var">left</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">H'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">R2_equiv_R4</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">H'</span>;<span class="id" type="var">right</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">H'</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">union_sym</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">union</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> &lt;-&gt; <span class="id" type="var">union</span> <span class="id" type="var">A</span> <span class="id" type="var">R2</span> <span class="id" type="var">R1</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>;  (<span class="id" type="tactic">inversion_clear</span> 1;[<span class="id" type="var">right</span>|left];<span class="id" type="tactic">assumption</span>).<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">union_assoc</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">R3</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">union</span> <span class="id" type="var">A</span> (<span class="id" type="var">union</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) <span class="id" type="var">R3</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> &lt;-&gt; <span class="id" type="var">union</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> (<span class="id" type="var">union</span> <span class="id" type="var">A</span> <span class="id" type="var">R2</span> <span class="id" type="var">R3</span>) <span class="id" type="var">x</span> <span class="id" type="var">y</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">R3</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">left</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">right</span>;<span class="id" type="var">left</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">right</span>;<span class="id" type="var">right</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">left</span>;<span class="id" type="var">left</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">left</span>;<span class="id" type="var">right</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">right</span>;<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">union_idem</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">union</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">R</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> &lt;-&gt; <span class="id" type="var">R</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">inversion_clear</span> 1;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>;<span class="id" type="var">left</span>;<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">union_idem_strong</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> <span class="id" type="var">R'</span>: <span class="id" type="var">A</span> -&gt; <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>) (<span class="id" type="var">H</span>:forall <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">R</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> -&gt; <span class="id" type="var">R'</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>) <span class="id" type="var">x</span> <span class="id" type="var">y</span>, (<span class="id" type="var">union</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">R'</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> &lt;-&gt; <span class="id" type="var">R'</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">R'</span> <span class="id" type="var">H</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">inversion_clear</span> 1. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">H'</span>;<span class="id" type="var">right</span>;<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <span class="id" type="var">star</span>.<br/>
<span class="id" type="keyword">Unset</span> <span class="id" type="keyword">Implicit</span> <span class="id" type="var">Arguments</span>.<br/>
<span class="id" type="keyword">Variable</span> <span class="id" type="var">A</span>:Type.<br/>
<span class="id" type="keyword">Variable</span> <span class="id" type="var">R</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>.<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">star</span> (<span class="id" type="var">x</span>:A) : <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span> := <br/>
| <span class="id" type="var">star_refl</span> : <span class="id" type="var">star</span> <span class="id" type="var">x</span> <span class="id" type="var">x</span><br/>
| <span class="id" type="var">star_step</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">y</span>, <span class="id" type="var">star</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">z</span>, <span class="id" type="var">R</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> -&gt; <span class="id" type="var">star</span> <span class="id" type="var">x</span> <span class="id" type="var">z</span><br/>
.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">star_trans</span>: <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>, <span class="id" type="var">star</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> -&gt; <span class="id" type="var">star</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> -&gt; <span class="id" type="var">star</span> <span class="id" type="var">x</span> <span class="id" type="var">z</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">H</span> <span class="id" type="var">H1</span>;<span class="id" type="var">revert</span> <span class="id" type="var">x</span> <span class="id" type="var">H</span>; <br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">H1</span>.<br/>

<br/>
<span class="id" type="tactic">tauto</span>.<br/>
<span class="id" type="tactic">intros</span>.<br/>
<span class="id" type="var">econstructor</span> 2 <span class="id" type="keyword">with</span> <span class="id" type="var">y0</span>;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">star_R</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">R</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> -&gt; <span class="id" type="var">star</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H</span>;<span class="id" type="var">constructor</span> 2 <span class="id" type="keyword">with</span> <span class="id" type="var">x</span>;[<span class="id" type="var">constructor</span>|assumption].<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">star_ind2</span> : <span class="id" type="keyword">forall</span>  <span class="id" type="var">x</span> (<span class="id" type="var">P</span>:A -&gt; <span class="id" type="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" type="var">P</span> <span class="id" type="var">x</span>) -&gt; <br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">y</span>, <span class="id" type="var">P</span> <span class="id" type="var">y</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">z</span>, <span class="id" type="var">R</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> -&gt; <span class="id" type="var">P</span> <span class="id" type="var">z</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <span class="id" type="var">star</span> <span class="id" type="var">x</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">P</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">P</span> <span class="id" type="var">H</span> <span class="id" type="var">H0</span> <span class="id" type="var">a</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">y</span>:=y);<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">star</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">star_equiv</span> :  <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R1</span> <span class="id" type="var">R2</span>: <span class="id" type="var">A</span> -&gt; <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>), (<span class="id" type="keyword">forall</span> <span class="id" type="var">l</span> <span class="id" type="var">r</span>, <span class="id" type="var">R1</span> <span class="id" type="var">r</span> <span class="id" type="var">l</span> &lt;-&gt; <span class="id" type="var">R2</span> <span class="id" type="var">r</span> <span class="id" type="var">l</span>) -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l</span> <span class="id" type="var">r</span>, <span class="id" type="var">star</span> <span class="id" type="var">_</span> <span class="id" type="var">R1</span> <span class="id" type="var">r</span> <span class="id" type="var">l</span> &lt;-&gt; <span class="id" type="var">star</span> <span class="id" type="var">_</span> <span class="id" type="var">R2</span> <span class="id" type="var">r</span> <span class="id" type="var">l</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">H</span> <span class="id" type="var">l</span> <span class="id" type="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>;<span class="id" type="tactic">induction</span> 1;<span class="id" type="tactic">try</span> <span class="id" type="var">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">constructor</span> 2 <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>;<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">constructor</span> 2 <span class="id" type="keyword">with</span> <span class="id" type="var">y</span>;<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">product_o</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> (<span class="id" type="var">R1</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">B</span>) : <span class="id" type="var">relation</span> (<span class="id" type="var">A</span>*B)%type :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">CaseA</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">a'</span> <span class="id" type="var">b</span>, <span class="id" type="var">R1</span> <span class="id" type="var">a</span> <span class="id" type="var">a'</span> -&gt; <span class="id" type="var">product_o</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> (<span class="id" type="var">a</span>,b) (<span class="id" type="var">a'</span>,b)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">CaseB</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">b'</span>, <span class="id" type="var">R2</span> <span class="id" type="var">b</span> <span class="id" type="var">b'</span> -&gt; <span class="id" type="var">product_o</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> (<span class="id" type="var">a</span>,b) (<span class="id" type="var">a</span>,b').<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_and</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> (<span class="id" type="var">R1</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">R2</span> : <span class="id" type="var">relation</span> <span class="id" type="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <span class="id" type="var">Acc</span> <span class="id" type="var">R1</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">Acc</span> <span class="id" type="var">R2</span> <span class="id" type="var">b</span> -&gt; <span class="id" type="var">Acc</span> (<span class="id" type="var">product_o</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span>) (<span class="id" type="var">a</span>,b).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">R1</span> <span class="id" type="var">R2</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">Acc_a</span>; <span class="id" type="tactic">generalize</span> <span class="id" type="var">b</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">b</span>;<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_a</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">IHa</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">b</span> <span class="id" type="var">Acc_b</span>; <span class="id" type="tactic">generalize</span> <span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">IHa</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">IHa</span>;<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_b</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">b</span> <span class="id" type="var">Acc_b</span> <span class="id" type="var">IHb</span>]; <span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">IHa</span>;<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">intros</span> [<span class="id" type="var">a'</span> <span class="id" type="var">b'</span>] <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHa</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Acc_intro</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHb</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">nf</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) <span class="id" type="var">t</span> := <span class="id" type="keyword">forall</span> <span class="id" type="var">s</span>, <span class="id" type="var">R</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> -&gt; <span class="id" type="var">False</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">acc_nf</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) <span class="id" type="var">FB</span>, (<span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">s</span>, <span class="id" type="var">In</span> <span class="id" type="var">s</span> (<span class="id" type="var">FB</span> <span class="id" type="var">t</span>) &lt;-&gt; <span class="id" type="var">R</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>, <span class="id" type="var">Acc</span> <span class="id" type="var">R</span> <span class="id" type="var">t</span> -&gt; { <span class="id" type="var">s</span> : <span class="id" type="var">A</span> | <span class="id" type="var">nf</span> <span class="id" type="var">R</span> <span class="id" type="var">s</span> /\ (<span class="id" type="var">s</span> = <span class="id" type="var">t</span> \/ <span class="id" type="var">trans_clos</span> <span class="id" type="var">R</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span>)}.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">FB</span> <span class="id" type="var">red_dec</span> <span class="id" type="var">t</span> <span class="id" type="var">Acc_t</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_t</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">t</span> <span class="id" type="var">Acc_t</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="var">case_eq</span> (<span class="id" type="var">FB</span> <span class="id" type="var">t</span>).<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="var">exists</span> <span class="id" type="var">t</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">red_dec</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>;  <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">l</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">destruct</span> (<span class="id" type="var">IH</span> <span class="id" type="var">a</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">a'</span> [<span class="id" type="var">nf_a'</span>  <span class="id" type="var">H'</span>]].<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">red_dec</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">exists</span> <span class="id" type="var">a'</span>; <span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">H'</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a'_eq_a</span> | <span class="id" type="var">H'</span>].<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">red_dec</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">trans_clos_is_trans</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">t_step</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">red_dec</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">dec_nf</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) <span class="id" type="var">FB</span>, (<span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> <span class="id" type="var">s</span>, <span class="id" type="var">In</span> <span class="id" type="var">s</span> (<span class="id" type="var">FB</span> <span class="id" type="var">t</span>) &lt;-&gt; <span class="id" type="var">R</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>, {<span class="id" type="var">nf</span> <span class="id" type="var">R</span> <span class="id" type="var">t</span>}+{~nf <span class="id" type="var">R</span> <span class="id" type="var">t</span>}.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">FB</span> <span class="id" type="var">red_dec</span> <span class="id" type="var">t</span>.<br/>
<span class="id" type="var">case_eq</span> (<span class="id" type="var">FB</span> <span class="id" type="var">t</span>).<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">nf</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">red_dec</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H'</span>; <span class="id" type="var">contradiction</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">l</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">H'</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H'</span> <span class="id" type="keyword">with</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">red_dec</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">cycle_not_acc</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> (<span class="id" type="var">R</span> : <span class="id" type="var">relation</span> <span class="id" type="var">A</span>) (<span class="id" type="var">a</span> : <span class="id" type="var">A</span>), <span class="id" type="var">R</span> <span class="id" type="var">a</span> <span class="id" type="var">a</span> -&gt; ~Acc <span class="id" type="var">R</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">A</span> <span class="id" type="var">R</span> <span class="id" type="var">a</span> <span class="id" type="var">H</span> <span class="id" type="var">Acc_a</span>; <span class="id" type="tactic">generalize</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">Acc_a</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">a</span> <span class="id" type="var">Acc_a</span> <span class="id" type="var">IH</span>].<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">apply</span> (<span class="id" type="var">IH</span> <span class="id" type="var">a</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://www.lix.polytechnique.fr/coq/">coqdoc</a>
</div>

</div>

</body>
</html>