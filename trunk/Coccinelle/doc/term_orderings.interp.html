<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>term_orderings.interp</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library term_orderings.interp</h1>

<div class="code">

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">weaved_relation</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">equational_theory</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">term_spec</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">List</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">terminaison</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="var">Zwf</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">ZArith</span>.<br/>
<span class="id" type="keyword">Set</span> <span class="id" type="keyword">Implicit</span> <span class="id" type="var">Arguments</span>.<br/>

<br/>
<span class="id" type="keyword">Record</span> <span class="id" type="var">ordering_pair</span> (<span class="id" type="var">A</span>:Type) (<span class="id" type="var">eq</span>:A -&gt; <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>)   (<span class="id" type="var">lt</span> <span class="id" type="var">le</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>)<br/>
:= <span class="id" type="var">mk_ordering_pair</span> {<br/>
&nbsp;&nbsp;<span class="id" type="var">lt_morph</span>: <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">x'</span>, <span class="id" type="var">eq</span> <span class="id" type="var">x</span> <span class="id" type="var">x'</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">y</span> <span class="id" type="var">y'</span>, <span class="id" type="var">eq</span> <span class="id" type="var">y</span> <span class="id" type="var">y'</span> -&gt; (<span class="id" type="var">lt</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> &lt;-&gt; <span class="id" type="var">lt</span> <span class="id" type="var">x'</span> <span class="id" type="var">y'</span>);<br/>
&nbsp;&nbsp;<span class="id" type="var">lt_irrefl</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span>, ~ <span class="id" type="var">lt</span> <span class="id" type="var">x</span> <span class="id" type="var">x</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">lt_antisym</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">lt</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> -&gt; ~lt <span class="id" type="var">y</span> <span class="id" type="var">x</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">lt_trans</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>, <span class="id" type="var">lt</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> -&gt; <span class="id" type="var">lt</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> -&gt; <span class="id" type="var">lt</span> <span class="id" type="var">x</span> <span class="id" type="var">z</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">le_morph</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">x'</span>, <span class="id" type="var">eq</span> <span class="id" type="var">x</span> <span class="id" type="var">x'</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">y</span> <span class="id" type="var">y'</span>, <span class="id" type="var">eq</span> <span class="id" type="var">y</span> <span class="id" type="var">y'</span> -&gt; (<span class="id" type="var">le</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> &lt;-&gt; <span class="id" type="var">le</span> <span class="id" type="var">x'</span> <span class="id" type="var">y'</span>);<br/>
&nbsp;&nbsp;<span class="id" type="var">le_refl</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span>, <span class="id" type="var">le</span> <span class="id" type="var">x</span> <span class="id" type="var">x</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">le_antisym</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">le</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> -&gt; <span class="id" type="var">le</span> <span class="id" type="var">y</span> <span class="id" type="var">x</span> -&gt; <span class="id" type="var">eq</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">le_trans</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>, <span class="id" type="var">le</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> -&gt; <span class="id" type="var">le</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> -&gt; <span class="id" type="var">le</span> <span class="id" type="var">x</span> <span class="id" type="var">z</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">le_lt_compat_left</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>, <span class="id" type="var">le</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> -&gt; <span class="id" type="var">lt</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> -&gt; <span class="id" type="var">lt</span> <span class="id" type="var">x</span> <span class="id" type="var">z</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">le_lt_compat_right</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>, <span class="id" type="var">lt</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> -&gt; <span class="id" type="var">le</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> -&gt; <span class="id" type="var">lt</span> <span class="id" type="var">x</span> <span class="id" type="var">z</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">lt_included_le</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">lt</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> -&gt; <span class="id" type="var">le</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span><br/>
}.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">o_Z</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">m</span>, <span class="id" type="var">ordering_pair</span> (@<span class="id" type="var">eq</span> <span class="id" type="var">Z</span>) (<span class="id" type="var">Zwf.Zwf</span> <span class="id" type="var">m</span>) <span class="id" type="var">Zle</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>;<span class="id" type="tactic">subst</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">H2</span>;<span class="id" type="var">constructor</span>;<span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>;<span class="id" type="tactic">subst</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span>;<span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>  <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>;<span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>;<span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H2</span>;<span class="id" type="tactic">split</span>;<span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H1</span>;<span class="id" type="tactic">split</span>;<span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H1</span>;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H1</span>;<span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="var">Interp</span>(<span class="id" type="var">EQT</span>:equational_theory_spec.<span class="id" type="var">EqTh</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Import</span> <span class="id" type="var">EQT</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Import</span> <span class="id" type="var">T</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Import</span> <span class="id" type="var">F</span>.<br/>

<br/>
&nbsp;<span class="id" type="keyword">Section</span> <span class="id" type="var">S</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">Ale</span> <span class="id" type="var">Alt</span> <span class="id" type="var">Aeq</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="var">A</span> -&gt; <span class="id" type="keyword">Prop</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">Aop</span> : <span class="id" type="var">ordering_pair</span> <span class="id" type="var">Aeq</span> <span class="id" type="var">Alt</span> <span class="id" type="var">Ale</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">A0</span> : <span class="id" type="var">A</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">Pol_type</span> (<span class="id" type="var">n</span>:nat) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="var">A</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n</span> =&gt; <span class="id" type="var">A</span> -&gt; <span class="id" type="var">Pol_type</span> <span class="id" type="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">get_arity</span> <span class="id" type="var">f</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">arity</span> <span class="id" type="var">f</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">term_spec.Free</span> <span class="id" type="var">n</span> =&gt; <span class="id" type="var">n</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">Pol_null</span> (<span class="id" type="var">n</span>:nat) : <span class="id" type="var">Pol_type</span> <span class="id" type="var">n</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="var">A0</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n</span> =&gt; (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> : <span class="id" type="var">A</span> =&gt; <span class="id" type="var">Pol_null</span> <span class="id" type="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">Pols</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">f</span>, <span class="id" type="var">Pol_type</span> (<span class="id" type="var">get_arity</span> <span class="id" type="var">f</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="keyword">measure</span> (<span class="id" type="var">t</span>:term) : <span class="id" type="var">A</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">fix</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">a</span> | <span class="id" type="var">f</span> <span class="id" type="var">l</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">A0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">f_pol</span> := <span class="id" type="var">Pols</span> <span class="id" type="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">Pols</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">n</span>:= <span class="id" type="var">get_arity</span> <span class="id" type="var">f</span>) <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">clearbody</span> <span class="id" type="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">revert</span> <span class="id" type="var">l</span> <span class="id" type="var">n</span> <span class="id" type="var">f_pol</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">fix</span> <span class="id" type="var">measure_list</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [| <span class="id" type="var">t</span> <span class="id" type="var">l</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [| <span class="id" type="var">n</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">A0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [| <span class="id" type="var">n</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">A0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_list</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">n</span>:=n).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">f_pol</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="keyword">measure</span> <span class="id" type="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">measure_list</span> (<span class="id" type="var">l</span>: <span class="id" type="var">list</span> <span class="id" type="var">term</span>) : <span class="id" type="keyword">forall</span> <span class="id" type="var">n0</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">Pol_type</span> <span class="id" type="var">n0</span> -&gt; <span class="id" type="var">A</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">nil</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">n0</span> : <span class="id" type="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n0</span> <span class="id" type="keyword">as</span> <span class="id" type="var">n1</span> <span class="id" type="keyword">return</span> (<span class="id" type="var">Pol_type</span> <span class="id" type="var">n1</span> -&gt; <span class="id" type="var">A</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> : <span class="id" type="var">Pol_type</span> 0 =&gt; <span class="id" type="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n1</span> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> : <span class="id" type="var">Pol_type</span> (<span class="id" type="var">S</span> <span class="id" type="var">n1</span>) =&gt; <span class="id" type="var">A0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">t0</span> :: <span class="id" type="var">l1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">n0</span> : <span class="id" type="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n0</span> <span class="id" type="keyword">as</span> <span class="id" type="var">n1</span> <span class="id" type="keyword">return</span> (<span class="id" type="var">Pol_type</span> <span class="id" type="var">n1</span> -&gt; <span class="id" type="var">A</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> : <span class="id" type="var">Pol_type</span> 0 =&gt; <span class="id" type="var">A0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">f_pol0</span> : <span class="id" type="var">A</span> -&gt; <span class="id" type="var">Pol_type</span> <span class="id" type="var">n1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">measure_list</span> <span class="id" type="var">l1</span> <span class="id" type="var">n1</span> (<span class="id" type="var">f_pol0</span> (<span class="id" type="keyword">measure</span> <span class="id" type="var">t0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Notation</span> <span class="id" type="keyword">Local</span> "a &lt;= b" := (<span class="id" type="var">Ale</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Notation</span> <span class="id" type="keyword">Local</span> "a &lt; b" := (<span class="id" type="var">Alt</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">monotonic_aux</span> <span class="id" type="var">n</span> : <span class="id" type="var">Pol_type</span> <span class="id" type="var">n</span> -&gt; <span class="id" type="var">Pol_type</span> <span class="id" type="var">n</span> -&gt; <span class="id" type="keyword">Prop</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">as</span> <span class="id" type="var">m</span> <span class="id" type="keyword">return</span> <span class="id" type="var">Pol_type</span> <span class="id" type="var">m</span> -&gt; <span class="id" type="var">Pol_type</span> <span class="id" type="var">m</span> -&gt; <span class="id" type="keyword">Prop</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> =&gt; <span class="id" type="var">Ale</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n</span> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">x1</span> <span class="id" type="var">x2</span>, (<span class="id" type="var">A0</span>&lt;=x1) /\ (<span class="id" type="var">x1</span> &lt;= <span class="id" type="var">x2</span>) -&gt; <span class="id" type="var">monotonic_aux</span> <span class="id" type="var">n</span> (<span class="id" type="var">P1</span> <span class="id" type="var">x1</span>) (<span class="id" type="var">P2</span> <span class="id" type="var">x2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">monotonic</span> <span class="id" type="var">f</span> (<span class="id" type="var">Pols</span>:Pol_type (<span class="id" type="var">get_arity</span> <span class="id" type="var">f</span>)) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">monotonic_aux</span> (<span class="id" type="var">get_arity</span> <span class="id" type="var">f</span>) <span class="id" type="var">Pols</span> <span class="id" type="var">Pols</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">All_monotonic</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">f</span>, <span class="id" type="var">monotonic</span> <span class="id" type="var">f</span> (<span class="id" type="var">Pols</span> <span class="id" type="var">f</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">bounded_aux</span> <span class="id" type="var">n</span> : <span class="id" type="var">Pol_type</span> <span class="id" type="var">n</span> -&gt; <span class="id" type="keyword">Type</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">as</span> <span class="id" type="var">m</span> <span class="id" type="keyword">return</span> <span class="id" type="var">Pol_type</span> <span class="id" type="var">m</span> -&gt; <span class="id" type="keyword">Type</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> =&gt; <span class="id" type="var">Ale</span> <span class="id" type="var">A0</span> <span class="id" type="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n</span> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">P1</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">x1</span>, (<span class="id" type="var">A0</span>&lt;=x1) -&gt; <span class="id" type="var">bounded_aux</span> <span class="id" type="var">n</span> (<span class="id" type="var">P1</span> <span class="id" type="var">x1</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">bounded</span> <span class="id" type="var">f</span> <span class="id" type="var">Pols</span> := <span class="id" type="var">bounded_aux</span> (<span class="id" type="var">get_arity</span> <span class="id" type="var">f</span>) (<span class="id" type="var">Pols</span> <span class="id" type="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">All_bounded</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">f</span>, <span class="id" type="var">bounded</span> <span class="id" type="var">f</span> <span class="id" type="var">Pols</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">measure_bounded</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>, <span class="id" type="var">A0</span> &lt;= <span class="id" type="keyword">measure</span> <span class="id" type="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">fix</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">a</span> | <span class="id" type="var">f</span> <span class="id" type="var">l</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="keyword">measure</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> (<span class="id" type="var">All_bounded</span> <span class="id" type="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">bounded</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">f_pol</span> := <span class="id" type="var">Pols</span> <span class="id" type="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">clearbody</span> <span class="id" type="var">f_pol</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">revert</span> <span class="id" type="var">f_pol</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> (<span class="id" type="var">get_arity</span> <span class="id" type="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">revert</span> <span class="id" type="var">l</span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">fix</span> <span class="id" type="var">measure_bounded_list</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [|t <span class="id" type="var">l</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [|n].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">p</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>;<span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [|n] <span class="id" type="var">f_pol</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">f_pol</span>,Hb|-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_bounded_list</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_bounded</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">rules</span> : <span class="id" type="var">term</span> -&gt; <span class="id" type="var">term</span> -&gt; <span class="id" type="keyword">Prop</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">rules_monotonic</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l</span> <span class="id" type="var">r</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">EQT.axiom</span> <span class="id" type="var">rules</span> <span class="id" type="var">r</span> <span class="id" type="var">l</span>) -&gt; <span class="id" type="keyword">measure</span> <span class="id" type="var">r</span> &lt;= <span class="id" type="keyword">measure</span> <span class="id" type="var">l</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">measure_monotonic_aux</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">IHl</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> : <span class="id" type="var">term</span>, <span class="id" type="var">In</span> <span class="id" type="var">t</span> <span class="id" type="var">l</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">r</span> : <span class="id" type="var">term</span>, <span class="id" type="var">one_step</span> <span class="id" type="var">rules</span> <span class="id" type="var">r</span> <span class="id" type="var">t</span> -&gt; <span class="id" type="keyword">measure</span> <span class="id" type="var">r</span> &lt;= <span class="id" type="keyword">measure</span> <span class="id" type="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">k1</span>, <span class="id" type="var">one_step_list</span> (<span class="id" type="var">one_step</span> <span class="id" type="var">rules</span>) <span class="id" type="var">k1</span> <span class="id" type="var">l</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> (<span class="id" type="var">P1</span> <span class="id" type="var">P2</span> : <span class="id" type="var">Pol_type</span> <span class="id" type="var">n</span>), <span class="id" type="var">monotonic_aux</span> <span class="id" type="var">n</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">measure_list</span> <span class="id" type="var">k1</span> <span class="id" type="var">n</span> <span class="id" type="var">P1</span> &lt;= <span class="id" type="var">measure_list</span> <span class="id" type="var">l</span> <span class="id" type="var">n</span> <span class="id" type="var">P2</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">l</span> <span class="id" type="var">IHl</span> <span class="id" type="var">k1</span> <span class="id" type="var">H1</span>.<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">one_step_in_list</span> <span class="id" type="var">H1</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">t1</span> [<span class="id" type="var">t2</span> [<span class="id" type="var">l1</span> [<span class="id" type="var">l2</span> [<span class="id" type="var">K</span> [<span class="id" type="var">K1</span> <span class="id" type="var">K2</span>]]]]]].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Ht</span> : <span class="id" type="keyword">measure</span> <span class="id" type="var">t2</span> &lt;= <span class="id" type="keyword">measure</span> <span class="id" type="var">t1</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl</span>; [<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">in_or_app</span>; <span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">refl_equal</span> | <span class="id" type="tactic">assumption</span>].<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">l</span> <span class="id" type="var">k1</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">IHl</span> <span class="id" type="var">H1</span> <span class="id" type="var">K</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">a1</span> <span class="id" type="var">l1</span>]; <span class="id" type="tactic">intros</span> [ | <span class="id" type="var">n</span>] <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> <span class="id" type="var">Hmon</span>; <span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>).<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">P1</span>, <span class="id" type="var">P2</span>, <span class="id" type="var">Hmon</span>.<br/>
<span class="id" type="tactic">set</span> (<span class="id" type="var">P1'</span>:=P1 (<span class="id" type="keyword">measure</span> <span class="id" type="var">t2</span>)).<br/>
<span class="id" type="tactic">set</span> (<span class="id" type="var">P2'</span>:=P2 (<span class="id" type="keyword">measure</span> <span class="id" type="var">t1</span>)).<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hmon'</span>:monotonic_aux <span class="id" type="var">n</span> <span class="id" type="var">P1'</span> <span class="id" type="var">P2'</span>).<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">P1'</span>, <span class="id" type="var">P2'</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Hmon</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">x1</span>:=measure <span class="id" type="var">t2</span>) (<span class="id" type="var">x2</span>:=measure <span class="id" type="var">t1</span>).<br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_bounded</span> | <span class="id" type="tactic">assumption</span>].<br/>
<span class="id" type="var">clearbody</span> <span class="id" type="var">P1'</span>;<span class="id" type="var">clearbody</span> <span class="id" type="var">P2'</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> <span class="id" type="var">Hmon</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">n</span> <span class="id" type="var">P1'</span> <span class="id" type="var">P2'</span> <span class="id" type="var">Hmon'</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">l2</span> <span class="id" type="keyword">as</span> [|t <span class="id" type="var">l</span>];<span class="id" type="tactic">intros</span> <span class="id" type="var">n</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> <span class="id" type="var">Hmon</span>.<br/>
<span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">n</span>.<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Hmon</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>).<br/>
<span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">n</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Hmon</span>.<br/>
<span class="id" type="tactic">split</span>;[<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_bounded</span>| <span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>)].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>).<br/>

<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">P1</span>, <span class="id" type="var">P2</span>, <span class="id" type="var">Hmon</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Hmon</span>.<br/>
<span class="id" type="tactic">split</span>;[<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_bounded</span>| <span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>)].<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">measure_monotonic</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l</span> <span class="id" type="var">r</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">EQT.one_step</span> <span class="id" type="var">rules</span> <span class="id" type="var">r</span> <span class="id" type="var">l</span>) -&gt; <span class="id" type="keyword">measure</span> <span class="id" type="var">r</span> &lt;= <span class="id" type="keyword">measure</span> <span class="id" type="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">l</span>; <span class="id" type="tactic">pattern</span> <span class="id" type="var">l</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">term_rec3</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">r</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">H1</span> | ]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">rules_monotonic</span>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span> <span class="id" type="var">IHl</span> <span class="id" type="var">r</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">H1</span> | <span class="id" type="var">g</span> <span class="id" type="var">k1</span> <span class="id" type="var">k2</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span> <span class="id" type="var">H3</span>];<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">rules_monotonic</span>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">IH</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> (<span class="id" type="var">P1</span> <span class="id" type="var">P2</span> : <span class="id" type="var">Pol_type</span> <span class="id" type="var">n</span>), <span class="id" type="var">monotonic_aux</span> <span class="id" type="var">n</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">measure_list</span> <span class="id" type="var">k1</span> <span class="id" type="var">n</span> <span class="id" type="var">P1</span> &lt;= <span class="id" type="var">measure_list</span> <span class="id" type="var">l</span> <span class="id" type="var">n</span> <span class="id" type="var">P2</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_monotonic_aux</span>; <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">All_monotonic</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">measure_list_monotonic</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">one_step_list</span> (<span class="id" type="var">one_step</span> <span class="id" type="var">rules</span>) <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> (<span class="id" type="var">P1</span> <span class="id" type="var">P2</span>:Pol_type <span class="id" type="var">n</span>), <span class="id" type="var">monotonic_aux</span>  <span class="id" type="var">n</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">measure_list</span> <span class="id" type="var">l1</span> <span class="id" type="var">n</span> <span class="id" type="var">P1</span> &lt;= <span class="id" type="var">measure_list</span> <span class="id" type="var">l2</span> <span class="id" type="var">n</span> <span class="id" type="var">P2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_monotonic_aux</span>; <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t_in_l2</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">measure_monotonic</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">measure_star_monotonic</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l</span> <span class="id" type="var">r</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">refl_trans_clos</span> (<span class="id" type="var">EQT.one_step</span> <span class="id" type="var">rules</span>) <span class="id" type="var">r</span> <span class="id" type="var">l</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">measure</span> <span class="id" type="var">r</span> &lt;= <span class="id" type="keyword">measure</span> <span class="id" type="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x</span> | <span class="id" type="var">r</span> <span class="id" type="var">l</span> <span class="id" type="var">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_monotonic</span>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_trans</span>) <span class="id" type="keyword">with</span> (<span class="id" type="keyword">measure</span> <span class="id" type="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_monotonic</span>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">Marked_pols</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">f</span>, (<span class="id" type="var">defined</span> <span class="id" type="var">rules</span> <span class="id" type="var">f</span>) -&gt; <span class="id" type="var">Pol_type</span> (<span class="id" type="var">get_arity</span> <span class="id" type="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">defined_dec</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">f</span>, {<span class="id" type="var">defined</span> <span class="id" type="var">rules</span> <span class="id" type="var">f</span>} + {~defined <span class="id" type="var">rules</span> <span class="id" type="var">f</span>}.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">Marked_pols_monononic</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">f</span> (<span class="id" type="var">H</span>:defined <span class="id" type="var">rules</span> <span class="id" type="var">f</span>), <span class="id" type="var">monotonic</span> <span class="id" type="var">f</span> (<span class="id" type="var">Marked_pols</span> <span class="id" type="var">H</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">marked_measure</span> : <span class="id" type="var">term</span> -&gt; <span class="id" type="var">A</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">fix</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">a</span>|f <span class="id" type="var">l</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exact</span> (<span class="id" type="keyword">measure</span> (<span class="id" type="var">Var</span> <span class="id" type="var">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span> (<span class="id" type="var">defined_dec</span> <span class="id" type="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Hdef</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">measure_list</span> <span class="id" type="var">l</span> (<span class="id" type="var">get_arity</span> <span class="id" type="var">f</span>) (<span class="id" type="var">Marked_pols</span> <span class="id" type="var">Hdef</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> ;<span class="id" type="tactic">apply</span> (<span class="id" type="keyword">measure</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">marked_measure_monotonic</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">one_step_list</span> (<span class="id" type="var">one_step</span> <span class="id" type="var">rules</span>) <span class="id" type="var">l2</span> <span class="id" type="var">l1</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">marked_measure</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> <span class="id" type="var">l2</span>) &lt;= <span class="id" type="var">marked_measure</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span> (<span class="id" type="var">defined_dec</span> <span class="id" type="var">f</span>);[<span class="id" type="tactic">intro</span> <span class="id" type="var">Hdef</span>|intro <span class="id" type="var">Hconst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_list_monotonic</span>. <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Marked_pols_monononic</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_list_monotonic</span>. <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">All_monotonic</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">marked_measure_star_monotonic</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">refl_trans_clos</span> (<span class="id" type="var">one_step_list</span> (<span class="id" type="var">one_step</span> <span class="id" type="var">rules</span>)) <span class="id" type="var">l2</span> <span class="id" type="var">l1</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">marked_measure</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> <span class="id" type="var">l2</span>) &lt;= <span class="id" type="var">marked_measure</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x</span> | <span class="id" type="var">r</span> <span class="id" type="var">l</span> <span class="id" type="var">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">marked_measure_monotonic</span>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_trans</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">marked_measure</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> <span class="id" type="var">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">marked_measure_monotonic</span>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">rules_ref</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> : <span class="id" type="var">term</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rules</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> : <span class="id" type="var">variable</span>, <span class="id" type="var">In</span> <span class="id" type="var">x</span> (<span class="id" type="var">var_list</span> <span class="id" type="var">s</span>) -&gt; <span class="id" type="var">In</span> <span class="id" type="var">x</span> (<span class="id" type="var">var_list</span> <span class="id" type="var">t</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span>  <span class="id" type="var">rules_non_var</span>: <span class="id" type="keyword">forall</span> (<span class="id" type="var">v</span> : <span class="id" type="var">variable</span>) (<span class="id" type="var">t</span> : <span class="id" type="var">term</span>), ~ <span class="id" type="var">rules</span> <span class="id" type="var">t</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v</span>) .<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">rules_well_formed</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> : <span class="id" type="var">term</span>, <span class="id" type="var">rules</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> -&gt; <span class="id" type="var">well_formed</span> <span class="id" type="var">s</span> /\ <span class="id" type="var">well_formed</span> <span class="id" type="var">t</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">inject</span> : <span class="id" type="var">nat</span> -&gt; <span class="id" type="var">variable</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">inject_inv</span> : <span class="id" type="var">variable</span> -&gt; <span class="id" type="var">nat</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">inject_inverse</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">inject_inv</span> (<span class="id" type="var">inject</span> <span class="id" type="var">n</span>) = <span class="id" type="var">n</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">rules_strictly_monotonic</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l</span> <span class="id" type="var">r</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">EQT.axiom</span> <span class="id" type="var">rules</span> <span class="id" type="var">r</span> <span class="id" type="var">l</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">well_formed</span> <span class="id" type="var">l</span> -&gt; <span class="id" type="keyword">measure</span> <span class="id" type="var">r</span> &lt; <span class="id" type="keyword">measure</span> <span class="id" type="var">l</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">monotonic_strict_aux</span> <span class="id" type="var">b</span> <span class="id" type="var">n</span> : <span class="id" type="var">Pol_type</span> <span class="id" type="var">n</span> -&gt; <span class="id" type="var">Pol_type</span> <span class="id" type="var">n</span> -&gt; <span class="id" type="keyword">Prop</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">as</span> <span class="id" type="var">m</span> <span class="id" type="keyword">return</span> <span class="id" type="var">Pol_type</span> <span class="id" type="var">m</span> -&gt; <span class="id" type="var">Pol_type</span> <span class="id" type="var">m</span> -&gt; <span class="id" type="keyword">Prop</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> =&gt; <span class="id" type="var">Alt</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">b</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">true</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">x1</span> <span class="id" type="var">x2</span>, (<span class="id" type="var">A0</span>&lt;=x1) /\ (<span class="id" type="var">x1</span> &lt;= <span class="id" type="var">x2</span>) -&gt; <span class="id" type="var">monotonic_strict_aux</span> <span class="id" type="var">true</span> <span class="id" type="var">n</span> (<span class="id" type="var">P1</span> <span class="id" type="var">x1</span>) (<span class="id" type="var">P2</span> <span class="id" type="var">x2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">false</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">x1</span> <span class="id" type="var">x2</span>, (<span class="id" type="var">A0</span>&lt;=x1) /\ (<span class="id" type="var">x1</span> &lt;= <span class="id" type="var">x2</span>) -&gt; <span class="id" type="var">monotonic_strict_aux</span> <span class="id" type="var">false</span> <span class="id" type="var">n</span> (<span class="id" type="var">P1</span> <span class="id" type="var">x1</span>) (<span class="id" type="var">P2</span> <span class="id" type="var">x2</span>))/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">x1</span> <span class="id" type="var">x2</span>, (<span class="id" type="var">A0</span>&lt;=x1) /\ (<span class="id" type="var">x1</span> &lt; <span class="id" type="var">x2</span>) -&gt; <span class="id" type="var">monotonic_strict_aux</span> <span class="id" type="var">true</span> <span class="id" type="var">n</span> (<span class="id" type="var">P1</span> <span class="id" type="var">x1</span>) (<span class="id" type="var">P2</span> <span class="id" type="var">x2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Hypothesis</span> <span class="id" type="var">All_strictly_monotonic</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">f</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">get_arity</span> <span class="id" type="var">f</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="var">True</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">monotonic_strict_aux</span> <span class="id" type="var">false</span> (<span class="id" type="var">get_arity</span> <span class="id" type="var">f</span>) (<span class="id" type="var">Pols</span> <span class="id" type="var">f</span>) (<span class="id" type="var">Pols</span> <span class="id" type="var">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">measure_strictly_monotonic_aux</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l2</span>  (<span class="id" type="var">IHl2</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t</span> : <span class="id" type="var">term</span>, <span class="id" type="var">In</span> <span class="id" type="var">t</span> <span class="id" type="var">l2</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">r</span> : <span class="id" type="var">term</span>, <span class="id" type="var">one_step</span> <span class="id" type="var">rules</span> <span class="id" type="var">r</span> <span class="id" type="var">t</span> -&gt; <span class="id" type="var">well_formed</span> <span class="id" type="var">t</span> -&gt; <span class="id" type="keyword">measure</span> <span class="id" type="var">r</span> &lt; <span class="id" type="keyword">measure</span> <span class="id" type="var">t</span>),<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l1</span>, <span class="id" type="var">one_step_list</span> (<span class="id" type="var">one_step</span> <span class="id" type="var">rules</span>) <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> -&gt; (<span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>, <span class="id" type="var">In</span> <span class="id" type="var">t</span> <span class="id" type="var">l2</span> -&gt; <span class="id" type="var">well_formed</span> <span class="id" type="var">t</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> (<span class="id" type="var">P1</span> <span class="id" type="var">P2</span> : <span class="id" type="var">Pol_type</span> <span class="id" type="var">n</span>), <span class="id" type="var">length</span> <span class="id" type="var">l2</span> = <span class="id" type="var">n</span> -&gt; <span class="id" type="var">monotonic_strict_aux</span> <span class="id" type="var">false</span> <span class="id" type="var">n</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">measure_list</span> <span class="id" type="var">l1</span> <span class="id" type="var">n</span> <span class="id" type="var">P1</span> &lt; <span class="id" type="var">measure_list</span> <span class="id" type="var">l2</span> <span class="id" type="var">n</span> <span class="id" type="var">P2</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">l</span> <span class="id" type="var">IHl</span> <span class="id" type="var">k1</span> <span class="id" type="var">H1</span> <span class="id" type="var">Wl</span>.<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">one_step_in_list</span> <span class="id" type="var">H1</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">t1</span> [<span class="id" type="var">t2</span> [<span class="id" type="var">l1</span> [<span class="id" type="var">l2</span> [<span class="id" type="var">K</span> [<span class="id" type="var">K1</span> <span class="id" type="var">K2</span>]]]]]].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Ht</span> : <span class="id" type="keyword">measure</span> <span class="id" type="var">t2</span> &lt; <span class="id" type="keyword">measure</span> <span class="id" type="var">t1</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">assumption</span> | <span class="id" type="tactic">apply</span> <span class="id" type="var">Wl</span>]; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">in_or_app</span>; <span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">refl_equal</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">l</span> <span class="id" type="var">k1</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">IHl</span> <span class="id" type="var">H1</span> <span class="id" type="var">K</span> <span class="id" type="var">Wl</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">a1</span> <span class="id" type="var">l1</span>]; <span class="id" type="tactic">intros</span> [ | <span class="id" type="var">n</span>] <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> <span class="id" type="var">L</span> <span class="id" type="var">Hmon</span>; <span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">discriminate</span>.<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">P1</span>, <span class="id" type="var">P2</span>, <span class="id" type="var">Hmon</span>, <span class="id" type="var">L</span>; <span class="id" type="tactic">injection</span> <span class="id" type="var">L</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">L</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">L</span>.<br/>
<span class="id" type="tactic">set</span> (<span class="id" type="var">P1'</span>:=P1 (<span class="id" type="keyword">measure</span> <span class="id" type="var">t2</span>)).<br/>
<span class="id" type="tactic">set</span> (<span class="id" type="var">P2'</span>:=P2 (<span class="id" type="keyword">measure</span> <span class="id" type="var">t1</span>)).<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hmon'</span> : <span class="id" type="var">monotonic_strict_aux</span> <span class="id" type="var">true</span> <span class="id" type="var">n</span> <span class="id" type="var">P1'</span> <span class="id" type="var">P2'</span>).<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">P1'</span>, <span class="id" type="var">P2'</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hmon</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">_</span> <span class="id" type="var">Hmon</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Hmon</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">x1</span>:=measure <span class="id" type="var">t2</span>) (<span class="id" type="var">x2</span>:=measure <span class="id" type="var">t1</span>).<br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_bounded</span> | <span class="id" type="tactic">assumption</span>].<br/>
<span class="id" type="var">clearbody</span> <span class="id" type="var">P1'</span>; <span class="id" type="var">clearbody</span> <span class="id" type="var">P2'</span>.<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> <span class="id" type="var">Hmon</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">n</span> <span class="id" type="var">P1'</span> <span class="id" type="var">P2'</span> <span class="id" type="var">Hmon'</span> <span class="id" type="var">L</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">l2</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">t</span> <span class="id" type="var">l</span>]; <span class="id" type="tactic">intros</span> <span class="id" type="var">n</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> <span class="id" type="var">Hmon</span> <span class="id" type="var">L</span>.<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">subst</span> <span class="id" type="var">n</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hmon</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">n</span>.<br/>
<span class="id" type="tactic">discriminate</span> <span class="id" type="var">L</span>.<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">apply</span> <span class="id" type="var">IHl</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Hmon</span>; <span class="id" type="tactic">split</span>;[<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_bounded</span>| <span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>)].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">L</span>; <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">discriminate</span> <span class="id" type="var">L</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl1</span>.<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">L</span>; <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Hmon</span>; <span class="id" type="tactic">split</span>;[<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_bounded</span>| <span class="id" type="tactic">apply</span> <span class="id" type="var">Aop</span>.(<span class="id" type="var">le_refl</span>)].<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">measure_strictly_monotonic</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l</span> <span class="id" type="var">r</span>, (<span class="id" type="var">EQT.one_step</span> <span class="id" type="var">rules</span> <span class="id" type="var">r</span> <span class="id" type="var">l</span>) -&gt; <span class="id" type="var">well_formed</span> <span class="id" type="var">l</span> -&gt; <span class="id" type="keyword">measure</span> <span class="id" type="var">r</span> &lt; <span class="id" type="keyword">measure</span> <span class="id" type="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">l</span>; <span class="id" type="tactic">pattern</span> <span class="id" type="var">l</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">term_rec3</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">r</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">H1</span> | ]; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">rules_strictly_monotonic</span>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span> <span class="id" type="var">IHl</span> <span class="id" type="var">r</span> <span class="id" type="var">H</span> <span class="id" type="var">W</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">H1</span> | <span class="id" type="var">g</span> <span class="id" type="var">k1</span> <span class="id" type="var">k2</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span> <span class="id" type="var">H3</span>];<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">rules_strictly_monotonic</span>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">L</span> : <span class="id" type="var">length</span> <span class="id" type="var">l</span> = <span class="id" type="var">get_arity</span> <span class="id" type="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">well_formed</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Bool.andb_true_iff</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">W</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">_</span> <span class="id" type="var">W</span>].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">beq_nat_true</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">get_arity</span>; <span class="id" type="tactic">destruct</span> (<span class="id" type="var">arity</span> <span class="id" type="var">f</span>) <span class="id" type="keyword">as</span> [ | | <span class="id" type="var">n</span>]; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_strictly_monotonic_aux</span>; <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">well_formed_unfold</span> <span class="id" type="var">W</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> (<span class="id" type="var">All_strictly_monotonic</span> <span class="id" type="var">f</span>); <br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">f_pol</span>:=Pols <span class="id" type="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">clearbody</span> <span class="id" type="var">f_pol</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">revert</span> <span class="id" type="var">f_pol</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">L</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">revert</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">case</span> <span class="id" type="var">l</span>; [<span class="id" type="tactic">intro</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">a1</span> <span class="id" type="var">l1</span>  <span class="id" type="var">_</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">measure_list_strictly_monotonic</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> (<span class="id" type="var">H</span> : <span class="id" type="var">one_step_list</span> (<span class="id" type="var">one_step</span> <span class="id" type="var">rules</span>) <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>, <span class="id" type="var">In</span> <span class="id" type="var">t</span> <span class="id" type="var">l2</span> -&gt; <span class="id" type="var">well_formed</span> <span class="id" type="var">t</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> (<span class="id" type="var">P1</span> <span class="id" type="var">P2</span>:Pol_type <span class="id" type="var">n</span>), <span class="id" type="var">length</span> <span class="id" type="var">l2</span> =  <span class="id" type="var">n</span> -&gt; <span class="id" type="var">monotonic_strict_aux</span> <span class="id" type="var">false</span> <span class="id" type="var">n</span> <span class="id" type="var">P1</span> <span class="id" type="var">P2</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">measure_list</span> <span class="id" type="var">l1</span> <span class="id" type="var">n</span> <span class="id" type="var">P1</span> &lt; <span class="id" type="var">measure_list</span> <span class="id" type="var">l2</span> <span class="id" type="var">n</span> <span class="id" type="var">P2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">H</span> <span class="id" type="var">Wl2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">measure_strictly_monotonic_aux</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">assumption</span> | <span class="id" type="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">measure_strictly_monotonic</span>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;<span class="id" type="keyword">End</span> <span class="id" type="var">S</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Interp</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://www.lix.polytechnique.fr/coq/">coqdoc</a>
</div>

</div>

</body>
</html>