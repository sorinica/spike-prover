<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>ac_matching.matching_sound</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library ac_matching.matching_sound</h1>

<div class="code">

<br/>
<span class="id" type="keyword">Add</span> <span class="id" type="var">LoadPath</span> "basis".<br/>
<span class="id" type="keyword">Add</span> <span class="id" type="var">LoadPath</span> "list_extensions".<br/>
<span class="id" type="keyword">Add</span> <span class="id" type="var">LoadPath</span> "term_algebra".<br/>
<span class="id" type="keyword">Add</span> <span class="id" type="var">LoadPath</span> "term_orderings".<br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Arith</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">List</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">more_list</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">list_sort</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">term_spec</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">ac</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">cf_eq_ac</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">matching</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">matching_well_founded</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">matching_well_formed</span>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="keyword">Type</span> <span class="id" type="var">S</span>.<br/>

<br/>
<span class="id" type="keyword">Declare Module</span> <span class="id" type="var">WFMMatching</span> : <span class="id" type="var">matching_well_formed.S</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">WFMMatching</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">WFMatching</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">Matching</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">Cf_eq_ac</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">Ac</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">EqTh</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">T</span>.<br/>

<br/>
<span class="id" type="keyword">Parameter</span> <span class="id" type="var">solve_is_sound</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pb</span> <span class="id" type="var">sigma</span>, <span class="id" type="var">well_formed_pb</span> <span class="id" type="var">pb</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pb'</span>, <span class="id" type="var">In</span> <span class="id" type="var">pb'</span> (<span class="id" type="var">solve</span> <span class="id" type="var">pb</span>) -&gt; <span class="id" type="var">is_sol</span> <span class="id" type="var">pb'</span> <span class="id" type="var">sigma</span> -&gt; <span class="id" type="var">is_sol</span> <span class="id" type="var">pb</span> <span class="id" type="var">sigma</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">S</span>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="var">Make</span> (<span class="id" type="var">WFMMatching1</span> : <span class="id" type="var">matching_well_formed.S</span>) :<br/>
&nbsp;<span class="id" type="var">S</span> <span class="id" type="keyword">with</span> <span class="id" type="keyword">Module</span> <span class="id" type="var">WFMMatching</span> := <span class="id" type="var">WFMMatching1</span>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="var">WFMMatching</span> := <span class="id" type="var">WFMMatching1</span>.<br/>

<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">WFMMatching1</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">WFMMatching</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">WFMatching</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">Matching</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">Cf_eq_ac</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">Ac</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">EqTh</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">T</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">F</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">X</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="keyword">Sort</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">LPermut</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">add_a_subterm</span> :<br/>
&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span> <span class="id" type="var">l'</span> <span class="id" type="var">t</span>, <span class="id" type="var">arity</span> <span class="id" type="var">f</span> = <span class="id" type="var">AC</span> -&gt; (<span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> (<span class="id" type="var">l</span> ++ <span class="id" type="var">t</span> :: <span class="id" type="var">l'</span>))) -&gt;<br/>
&nbsp;<span class="id" type="var">permut</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f</span> (<span class="id" type="var">build</span> <span class="id" type="var">f</span> (<span class="id" type="var">l</span> ++ <span class="id" type="var">l'</span>) :: <span class="id" type="var">t</span> :: <span class="id" type="var">nil</span>)) (<span class="id" type="var">l</span> ++ <span class="id" type="var">t</span> :: <span class="id" type="var">l'</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span> <span class="id" type="var">l'</span> <span class="id" type="var">t</span> <span class="id" type="var">Af</span> <span class="id" type="var">W</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Al_t</span> : <span class="id" type="keyword">match</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span> | <span class="id" type="var">Var</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">True</span> | <span class="id" type="var">Term</span> <span class="id" type="var">g</span> <span class="id" type="var">ll</span> =&gt; <span class="id" type="var">f</span> &lt;&gt; <span class="id" type="var">g</span> <span class="id" type="keyword">end</span>).<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="var">well_formed_cf_alien</span> <span class="id" type="var">Af</span> <span class="id" type="var">W</span>); <span class="id" type="tactic">apply</span> <span class="id" type="var">in_or_app</span>; <span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">build</span> <span class="id" type="var">f</span> (<span class="id" type="var">l</span> ++ <span class="id" type="var">l'</span>) :: <span class="id" type="var">t</span> :: <span class="id" type="var">nil</span>) <span class="id" type="keyword">with</span> ((<span class="id" type="var">build</span> <span class="id" type="var">f</span> (<span class="id" type="var">l</span> ++ <span class="id" type="var">l'</span>) :: <span class="id" type="var">nil</span>) ++ (<span class="id" type="var">t</span> :: <span class="id" type="var">nil</span>)); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">flatten_app</span>; <span class="id" type="tactic">replace</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f</span> (<span class="id" type="var">t</span> :: <span class="id" type="var">nil</span>)) <span class="id" type="keyword">with</span> (<span class="id" type="var">t</span> :: <span class="id" type="var">nil</span>).<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_add_inside</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_nil_end</span>; <br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">flatten_build_inside</span> <span class="id" type="keyword">with</span> <span class="id" type="var">t</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">t</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">v</span> | <span class="id" type="var">g</span> <span class="id" type="var">ll</span>].<br/>
<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>); [<span class="id" type="tactic">intro</span> <span class="id" type="var">f_eq_g</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">False_rec</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Al_t</span>; <span class="id" type="tactic">assumption</span> | <span class="id" type="tactic">reflexivity</span>].<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">add_a_subterm_subst</span> :<br/>
&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2'</span> <span class="id" type="var">l2''</span> <span class="id" type="var">t</span> <span class="id" type="var">sigma</span>, <span class="id" type="var">arity</span> <span class="id" type="var">f</span> = <span class="id" type="var">AC</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> (<span class="id" type="var">l2'</span> ++ <span class="id" type="var">t</span> :: <span class="id" type="var">l2''</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma</span> (<span class="id" type="var">build</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span>) = <span class="id" type="var">build</span> <span class="id" type="var">f</span> (<span class="id" type="var">l2'</span> ++ <span class="id" type="var">l2''</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">permut</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f</span> (<span class="id" type="var">t</span> :: (<span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma</span>) <span class="id" type="var">l1</span>))) (<span class="id" type="var">l2'</span> ++ <span class="id" type="var">t</span> :: <span class="id" type="var">l2''</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2'</span> <span class="id" type="var">l2''</span> <span class="id" type="var">t</span> <span class="id" type="var">sigma</span> <span class="id" type="var">Af</span> <span class="id" type="var">Wt2</span> <span class="id" type="var">t1_sigma</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Al_t</span> : <span class="id" type="keyword">match</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span> | <span class="id" type="var">Var</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">True</span> | <span class="id" type="var">Term</span> <span class="id" type="var">g</span> <span class="id" type="var">ll</span> =&gt; <span class="id" type="var">f</span> &lt;&gt; <span class="id" type="var">g</span> <span class="id" type="keyword">end</span>).<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="var">well_formed_cf_alien</span> <span class="id" type="var">Af</span> <span class="id" type="var">Wt2</span>); <span class="id" type="tactic">apply</span> <span class="id" type="var">in_or_app</span>; <span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">t</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">v</span> | <span class="id" type="var">g</span> <span class="id" type="var">ll</span>].<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_cons_inside</span>.<br/>
<span class="id" type="tactic">refine</span> (<span class="id" type="var">permut_trans</span> (<span class="id" type="var">flatten_apply_cf_subst</span> <span class="id" type="var">sigma</span> <span class="id" type="var">l1</span> <span class="id" type="var">Af</span>) <span class="id" type="var">_</span>);<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">t1_sigma</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">flatten_build_inside</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>).<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">f_eq_g</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">False_rec</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Al_t</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_cons_inside</span>.<br/>
<span class="id" type="tactic">refine</span> (<span class="id" type="var">permut_trans</span> (<span class="id" type="var">flatten_apply_cf_subst</span> <span class="id" type="var">sigma</span> <span class="id" type="var">l1</span> <span class="id" type="var">Af</span>) <span class="id" type="var">_</span>);<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">t1_sigma</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">flatten_build_inside</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g</span> <span class="id" type="var">ll</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">solve_is_sound</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pb</span> <span class="id" type="var">sigma</span>, <span class="id" type="var">well_formed_pb</span> <span class="id" type="var">pb</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pb'</span>, <span class="id" type="var">In</span> <span class="id" type="var">pb'</span> (<span class="id" type="var">solve</span> <span class="id" type="var">pb</span>) -&gt; <span class="id" type="var">is_sol</span> <span class="id" type="var">pb'</span> <span class="id" type="var">sigma</span> -&gt; <span class="id" type="var">is_sol</span> <span class="id" type="var">pb</span> <span class="id" type="var">sigma</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">pb</span>; <span class="id" type="tactic">assert</span> (<span class="id" type="var">R</span> := <span class="id" type="var">add_new_var_to_rough_sol</span> <span class="id" type="var">pb</span>);<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">is_sol</span>, <span class="id" type="var">solve</span>, <span class="id" type="var">well_formed_pb</span> <span class="id" type="keyword">in</span> <span class="id" type="var">R</span>; <br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">is_sol</span>, <span class="id" type="var">solve</span>, <span class="id" type="var">well_formed_pb</span>; <br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">sigma</span> [<span class="id" type="var">W1</span> [<span class="id" type="var">W2</span> [<span class="id" type="var">W3</span> [<span class="id" type="var">W4</span> [<span class="id" type="var">W5</span> <span class="id" type="var">W6</span>]]]]] <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>;<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">U_pb</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">pb'</span>, <span class="id" type="var">pb'</span> = <span class="id" type="var">pb</span> -&gt; <span class="id" type="var">unsolved_part</span> <span class="id" type="var">pb'</span> = <span class="id" type="var">unsolved_part</span> <span class="id" type="var">pb</span>).<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">unsolved_part</span> <span class="id" type="var">pb</span>) <span class="id" type="keyword">as</span> [ | [[<span class="id" type="var">v1</span> | <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>] <span class="id" type="var">t2</span>] <span class="id" type="var">l</span>]; <br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">U_pb</span> <span class="id" type="var">pb</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>)); <span class="id" type="tactic">clear</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">U_pb</span>.<br/>
<span class="id" type="var">contradiction</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="var">case_eq</span> (<span class="id" type="var">find</span> <span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v1</span> (<span class="id" type="var">solved_part</span> <span class="id" type="var">pb</span>)); [<span class="id" type="tactic">intros</span> <span class="id" type="var">t1</span> <span class="id" type="var">F</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">F</span>].<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">T.eq_bool_ok</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">T.eq_bool</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>); [<span class="id" type="tactic">intro</span> <span class="id" type="var">t1_eq_t2</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">t2</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">pb'_eq_</span> | <span class="id" type="var">pb'_in_nil</span>]; [<span class="id" type="tactic">subst</span> <span class="id" type="var">pb'</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">is_rough_sol</span>; <span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>).<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">H3</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">simpl</span> <span class="id" type="var">solved_part</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">F</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intuition</span>.<br/>

<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">W3</span> <span class="id" type="var">v1</span>); <br/>
<span class="id" type="var">case_eq</span> (<span class="id" type="var">find</span> <span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v1</span> (<span class="id" type="var">partly_solved_part</span> <span class="id" type="var">pb</span>)); [<span class="id" type="tactic">intros</span> <span class="id" type="var">p1</span> <span class="id" type="var">F'</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">F'</span>].<br/>

<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">v2</span> | <span class="id" type="var">f2</span> <span class="id" type="var">l2</span>].<br/>
<span class="id" type="var">contradiction</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>) <span class="id" type="var">f2</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>) <span class="id" type="var">f2</span>); [<span class="id" type="tactic">intro</span> <span class="id" type="var">f1_eq_f2</span> | <span class="id" type="var">contradiction</span>];<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">f1_eq_f2</span>; <span class="id" type="var">destruct_arity</span> <span class="id" type="var">f2</span> <span class="id" type="var">n2</span> <span class="id" type="var">Af2</span>; [ <span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">l2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [ <span class="id" type="var">l2'''</span> |]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [ <span class="id" type="var">H'</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">l2'''</span>.<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">pb'_eq_</span> | <span class="id" type="var">pb'_in_nil</span>]; [<span class="id" type="tactic">subst</span> <span class="id" type="var">pb'</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">is_rough_sol</span>; <br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">split</span> | <span class="id" type="var">idtac</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>;<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">H2</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">simpl</span> <span class="id" type="var">partly_solved_part</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">F'</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>;<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> =&gt; <span class="id" type="var">Term</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>) <span class="id" type="var">l</span>)); <span class="id" type="tactic">apply</span> <span class="id" type="var">sort_is_unique</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_sorted</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>); <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">refine</span> (<span class="id" type="var">proj2</span> <span class="id" type="var">_</span> (<span class="id" type="var">A</span>:= <span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>))); <span class="id" type="tactic">apply</span> <span class="id" type="var">W1</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>;<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">H1</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>)) (<span class="id" type="var">build</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>) (<span class="id" type="var">l2'</span> ++ <span class="id" type="var">l2''</span>))); [<span class="id" type="var">idtac</span> | <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">add_a_subterm</span>; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">refine</span> (<span class="id" type="var">proj2</span> <span class="id" type="var">_</span> (<span class="id" type="var">A</span>:= <span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>))); <span class="id" type="tactic">apply</span> <span class="id" type="var">W1</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> [<span class="id" type="var">pb'_eq</span> | <span class="id" type="var">pb'_in_nil</span>]; [<span class="id" type="tactic">subst</span> <span class="id" type="var">pb'</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">is_rough_sol</span>; <br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">split</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">split</span>] | <span class="id" type="var">idtac</span>].<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">trivial</span>].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">H3</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">X.eq_bool_ok</span> <span class="id" type="var">v1</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v1</span> <span class="id" type="var">v1</span>); [<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">assumption</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">v1_diff_v1</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">False_rec</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">v1_diff_v1</span>; <span class="id" type="tactic">reflexivity</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H2</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">v</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">H3</span> <span class="id" type="var">v</span>); <span class="id" type="tactic">simpl</span>; <br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">X.eq_bool_ok</span> <span class="id" type="var">v</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v</span> <span class="id" type="var">v1</span>); [<span class="id" type="tactic">intros</span> <span class="id" type="var">v_eq_v1</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">F</span>; <span class="id" type="tactic">trivial</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">trivial</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H4</span>.<br/>

<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">v2</span> | <span class="id" type="var">f2</span> <span class="id" type="var">l2</span> ].<br/>
<span class="id" type="var">contradiction</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> <span class="id" type="var">f2</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">f2</span>); [<span class="id" type="tactic">intro</span> <span class="id" type="var">f1_eq_f2</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">f2</span>; <span class="id" type="var">destruct_arity</span> <span class="id" type="var">f1</span> <span class="id" type="var">n1</span> <span class="id" type="var">Af1</span>.<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">le_gt_dec</span> (<span class="id" type="var">length</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">length</span> <span class="id" type="var">l2</span>)) <span class="id" type="keyword">as</span> [<span class="id" type="var">_</span> | <span class="id" type="var">_</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">ac_elementary_solve</span> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">W_t1</span> :  <span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>)).<br/>
<span class="id" type="tactic">refine</span> (<span class="id" type="var">proj1</span> <span class="id" type="var">_</span> (<span class="id" type="var">B</span>:= (<span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2</span>)))); <span class="id" type="tactic">apply</span> <span class="id" type="var">W1</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">W_t2</span> : <span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2</span>)).<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="var">proj2</span> (<span class="id" type="var">A</span>:= (<span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>)))); <span class="id" type="tactic">apply</span> <span class="id" type="var">W1</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">t1</span> <span class="id" type="var">l1</span>].<br/>
<span class="id" type="var">absurd</span> (2 &lt;= @<span class="id" type="var">length</span> <span class="id" type="var">term</span> <span class="id" type="var">nil</span>); <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>;<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_length</span> <span class="id" type="keyword">with</span> <span class="id" type="var">f1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">v1</span> | <span class="id" type="var">g1</span> <span class="id" type="var">ll1</span>].<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">W2</span> <span class="id" type="var">v1</span>); <br/>
<span class="id" type="var">case_eq</span> (<span class="id" type="var">find</span> <span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v1</span> (<span class="id" type="var">solved_part</span> <span class="id" type="var">pb</span>)); [<span class="id" type="tactic">intros</span> <span class="id" type="var">s1</span> <span class="id" type="var">F</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">F</span>].<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">W_s1</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">ac_elementary_solve_term_var_with_val_term</span> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> <span class="id" type="var">s1</span> <span class="id" type="var">l2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> <span class="id" type="var">s1</span> <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [ <span class="id" type="var">l2'''</span> |].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [ <span class="id" type="var">H'</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">l2'''</span>.<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">pb'_eq_</span> | <span class="id" type="var">pb'_in_nil</span>]; [<span class="id" type="tactic">subst</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">is_rough_sol</span>; <br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">split</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">split</span>] | <span class="id" type="var">idtac</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>))) <span class="id" type="keyword">with</span><br/>
(<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">quicksort</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">cp1</span> :: <span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) <span class="id" type="var">l1</span>)))).<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> =&gt; <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l</span>)).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">sort_is_unique</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_sorted</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="keyword">with</span> <span class="id" type="var">f1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">add_a_subterm_subst</span>; <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">H3</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">F</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">H3_v1</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H3_v1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">s1</span> <span class="id" type="keyword">as</span> [| <span class="id" type="var">g1</span> <span class="id" type="var">ll1</span>].<br/>
<span class="id" type="var">contradiction</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> <span class="id" type="var">g1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">g1</span>);  [<span class="id" type="tactic">intro</span> <span class="id" type="var">f1_eq_g1</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">S_ll1</span> : <span class="id" type="var">is_sorted</span> <span class="id" type="var">ll1</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="keyword">with</span> <span class="id" type="var">g1</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">S_l2</span> : <span class="id" type="var">is_sorted</span> <span class="id" type="var">l2</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="keyword">with</span> <span class="id" type="var">f1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove_list</span> <span class="id" type="var">S_ll1</span> <span class="id" type="var">S_l2</span>); <span class="id" type="tactic">unfold</span> <span class="id" type="var">EDS.A</span>, <span class="id" type="var">DOS.A</span> <span class="id" type="keyword">in</span> *;<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove_list</span> <span class="id" type="var">ll1</span> <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">l2'</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span> ].<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">EDS.A</span>, <span class="id" type="var">DOS.A</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">destruct</span> (<span class="id" type="var">le_gt_dec</span> (<span class="id" type="var">length</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">length</span> <span class="id" type="var">l2'</span>)) <span class="id" type="keyword">as</span> [<span class="id" type="var">L_l1_l2'</span> |]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">P</span> [<span class="id" type="var">pb'_eq_</span> | <span class="id" type="var">pb'_in_nil</span>]; [<span class="id" type="tactic">subst</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">is_rough_sol</span>;<br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">split</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">split</span>] | <span class="id" type="var">idtac</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>;<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g1</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>))) <span class="id" type="keyword">with</span><br/>
(<span class="id" type="var">Term</span> <span class="id" type="var">g1</span> (<span class="id" type="var">quicksort</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">g1</span> ((<span class="id" type="var">Term</span> <span class="id" type="var">g1</span> <span class="id" type="var">ll1</span>) :: <span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) <span class="id" type="var">l1</span>)))).<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> =&gt; <span class="id" type="var">Term</span> <span class="id" type="var">g1</span> <span class="id" type="var">l</span>)).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">sort_is_unique</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_sorted</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="keyword">with</span> <span class="id" type="var">g1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>;<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">g1</span> <span class="id" type="var">g1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">g1</span> <span class="id" type="var">g1</span>); <br/>
[<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">g1_diff_g1</span>; <span class="id" type="var">absurd</span> (<span class="id" type="var">g1</span> = <span class="id" type="var">g1</span>); <span class="id" type="tactic">trivial</span>].<br/>
<span class="id" type="tactic">transitivity</span> (<span class="id" type="var">ll1</span> ++ <span class="id" type="var">l2'</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_app1</span>.<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">flatten_apply_cf_subst</span> <span class="id" type="var">sigma'</span> <span class="id" type="var">l1</span> <span class="id" type="var">Af1</span>);<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">H1</span> (<span class="id" type="var">build</span> <span class="id" type="var">g1</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">build</span> <span class="id" type="var">g1</span> <span class="id" type="var">l2'</span>)); [<span class="id" type="var">idtac</span> | <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>]; <span class="id" type="tactic">apply</span> <span class="id" type="var">flatten_build</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">In_t</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_alien</span> <span class="id" type="keyword">with</span> <span class="id" type="var">l2</span>; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">rewrite</span> &lt;- (<span class="id" type="var">list_permut.in_permut_in</span> <span class="id" type="var">P</span>); <span class="id" type="tactic">apply</span> <span class="id" type="var">in_or_app</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">H3</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">F</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">H3_v1</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H3_v1</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">W3</span> <span class="id" type="var">v1</span>);<br/>
<span class="id" type="var">case_eq</span> (<span class="id" type="var">find</span> <span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v1</span> (<span class="id" type="var">partly_solved_part</span> <span class="id" type="var">pb</span>)); [<span class="id" type="tactic">intros</span> <span class="id" type="var">p1</span> <span class="id" type="var">F'</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">F'</span>].<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">ac_elementary_solve_term_var_with_part_val_term</span> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>));<br/>
<span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>)); [<span class="id" type="tactic">intro</span> <span class="id" type="var">f1_eq_hd_p1</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">f1_diff_hd_p1</span>].<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">l2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">l2'''</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">f1_eq_hd_p1</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>.<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [ <span class="id" type="var">H'</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">l2'''_eq</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> [<span class="id" type="var">pb'_eq_</span> | <span class="id" type="var">pb'_in_nil</span>]; [<span class="id" type="tactic">subst</span> <span class="id" type="var">pb'</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">is_rough_sol</span>; <br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">split</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">split</span>] | <span class="id" type="var">idtac</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">st_eq</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">v1_sigma'_eq</span> : <span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>) = <br/>
<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">quicksort</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>)) :: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>)))).<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">H2</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">F'</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">f1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">l1_sigma'_eq</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">H1</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>) :: <span class="id" type="var">l1</span>))  (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2'''</span>) (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>)))).<br/>

<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>))) <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">quicksort</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (((<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>)) :: <span class="id" type="var">nil</span>) ++ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) <span class="id" type="var">l1</span>))));<br/>
[ <span class="id" type="var">idtac</span> | <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> =&gt; <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l</span>)).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">sort_is_unique</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_sorted</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="keyword">with</span> <span class="id" type="var">f1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>) :: <span class="id" type="var">l1</span>)) <span class="id" type="keyword">with</span> <br/>
(<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">quicksort</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>) :: <span class="id" type="var">l1</span>))) <span class="id" type="keyword">in</span> <span class="id" type="var">l1_sigma'_eq</span>.<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">l1_sigma'_eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">l1_sigma'_eq</span>.<br/>
<span class="id" type="tactic">transitivity</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">l2'''</span>); <br/>
[<span class="id" type="var">idtac</span> | <span class="id" type="tactic">subst</span> <span class="id" type="var">l2</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_cons_inside</span>; <span class="id" type="tactic">auto</span>].<br/>

<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">build_f1_l2'''_eq</span> : <span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2'''</span> = <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">quicksort</span> <span class="id" type="var">l2'''</span>)).<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l2'''</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">u2</span> [ | <span class="id" type="var">u2'</span> <span class="id" type="var">l2'''</span>]]; <br/>
[<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">quicksort_equation</span>; <span class="id" type="tactic">trivial</span> | <span class="id" type="var">idtac</span> | <span class="id" type="tactic">trivial</span>].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Al_u2</span> : <span class="id" type="keyword">match</span> <span class="id" type="var">u2</span> <span class="id" type="keyword">with</span> | <span class="id" type="var">Var</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">True</span> | <span class="id" type="var">Term</span> <span class="id" type="var">g</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">f1</span> &lt;&gt; <span class="id" type="var">g</span> <span class="id" type="keyword">end</span>).<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="var">well_formed_cf_alien</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_t2</span>).<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">l2</span>; <span class="id" type="tactic">assert</span> (<span class="id" type="var">u2_in_l2'_l2''</span> : <span class="id" type="var">In</span> <span class="id" type="var">u2</span> (<span class="id" type="var">l2'</span> ++ <span class="id" type="var">l2''</span>)). <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">l2'''_eq</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">in_app_or</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">u2_in_l2'_l2''</span>); <span class="id" type="tactic">apply</span> <span class="id" type="var">in_or_app</span>; [<span class="id" type="var">left</span> | <span class="id" type="var">right</span>; <span class="id" type="var">right</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">l1_sigma'_eq</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">u2</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">g2</span>]; <br/>
[<span class="id" type="tactic">discriminate</span> | <span class="id" type="tactic">injection</span> <span class="id" type="var">l1_sigma'_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">g2</span>; <span class="id" type="var">absurd</span> (<span class="id" type="var">f1</span> = <span class="id" type="var">f1</span>); <span class="id" type="tactic">trivial</span>].<br/>

<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2'''</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">quicksort</span> <span class="id" type="var">l2'''</span>)) <span class="id" type="keyword">in</span> <span class="id" type="var">l1_sigma'_eq</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">P</span> : <span class="id" type="var">permut</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>) :: <span class="id" type="var">l1</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">l2'''</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">permut_sym</span>; <span class="id" type="tactic">transitivity</span> (<span class="id" type="var">quicksort</span> <span class="id" type="var">l2'''</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut</span>.<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l1_sigma'_eq</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">H''</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H''</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H''</span>;<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">list_permut_flatten</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">list_permut.permut_map</span> <span class="id" type="keyword">with</span> (@<span class="id" type="var">eq</span> <span class="id" type="var">term</span>).<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>; <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>.<br/>
<span class="id" type="tactic">transitivity</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>) :: <span class="id" type="var">l1</span>))));<br/>
[<span class="id" type="var">idtac</span> | <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_cons</span>; <span class="id" type="tactic">trivial</span>].<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">v1_sigma'_eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">flatten_app</span>; <br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>) :: <span class="id" type="var">l1</span>)) <span class="id" type="keyword">with</span><br/>
(<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>)) :: <span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) <span class="id" type="var">l1</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) <span class="id" type="var">l1</span>) (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>)));<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">l1_sigma'</span> <span class="id" type="var">t</span>; <span class="id" type="tactic">replace</span> (<span class="id" type="var">t</span> :: <span class="id" type="var">l1_sigma'</span>) <span class="id" type="keyword">with</span> ((<span class="id" type="var">t</span> :: <span class="id" type="var">nil</span>) ++ <span class="id" type="var">l1_sigma'</span>); <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">flatten_app</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">app_comm_cons</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_app2</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Al_ct</span> : <span class="id" type="keyword">match</span> <span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> <span class="id" type="keyword">with</span> | <span class="id" type="var">Var</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">True</span> | <span class="id" type="var">Term</span> <span class="id" type="var">g</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">f1</span> &lt;&gt; <span class="id" type="var">g</span> <span class="id" type="keyword">end</span>).<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">W3</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">F'</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">f1_eq_hd_p1</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">intuition</span>.<br/>
<span class="id" type="tactic">pattern</span> (<span class="id" type="var">quicksort</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">t</span> :: <span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>))); <span class="id" type="tactic">simpl</span> <span class="id" type="var">flatten</span> <span class="id" type="tactic">at</span> 1.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> <span class="id" type="var">f1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">f1</span>); [<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">f1_diff_f1</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">False_rec</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">f1_diff_f1</span>; <span class="id" type="tactic">reflexivity</span>].<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_nil_end</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>.<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">t</span> :: <span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>)) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;(<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">t</span> :: <span class="id" type="var">nil</span>) ++ <span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>)).<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="var">flatten</span> <span class="id" type="tactic">at</span> 2.<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">v</span> | <span class="id" type="var">g</span> <span class="id" type="var">ll</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">permut_sym</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_cons_inside</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_nil_end</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> <span class="id" type="var">g</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">g</span>).<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">f1_eq_g</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">False_rec</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">Al_ct</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">permut_sym</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_cons_inside</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_nil_end</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">flatten_app</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">l2'''</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">build_eq_Term</span>; <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">simpl</span>; <br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">well_formed_cf_length</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_t1</span>); <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">W3_v1</span> <span class="id" type="var">In_pb'</span>; <br/>
<span class="id" type="tactic">pattern</span> <span class="id" type="var">pb'</span>;<br/>
<span class="id" type="tactic">refine</span> <br/>
(<span class="id" type="var">prop_map_without_repetition</span> (<span class="id" type="var">B</span>:=matching_problem) <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>);<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">intros</span> [ | <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>] <span class="id" type="var">In_t2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">g2</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>));<br/>
<span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">g2</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>)); [<span class="id" type="tactic">intro</span> <span class="id" type="var">g2_eq_hd_p1</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">g2_diff_hd_p1</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">ll2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">ll2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">ll2'''</span> | ]; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1</span> [<span class="id" type="var">ll2'</span> [<span class="id" type="var">ll2''</span> [ <span class="id" type="var">H'</span> [<span class="id" type="var">ll2_eq</span> <span class="id" type="var">ll2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">ll2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">ll2'''_eq</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">ll2'''_eq</span>;<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>) <span class="id" type="var">l2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>) <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">l2'''</span> | ]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1'</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [ <span class="id" type="var">H''</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">l2'''_eq</span>;<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Ag2</span> : <span class="id" type="var">arity</span> <span class="id" type="var">g2</span> = <span class="id" type="var">AC</span>).<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">g2_eq_hd_p1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W3_v1</span>; <span class="id" type="tactic">destruct</span> (<span class="id" type="var">arity</span> <span class="id" type="var">g2</span>); [<span class="id" type="tactic">trivial</span> | <span class="id" type="var">contradiction</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">W_g2_ll2</span> : <span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>)).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_subterms</span> <span class="id" type="keyword">with</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">is_rough_sol</span>; <br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">split</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">split</span>] | <span class="id" type="var">idtac</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="var">right</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">st_eq</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">v1_sigma'_eq</span> : <span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>) = <br/>
<span class="id" type="var">Term</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">quicksort</span> (<span class="id" type="var">flatten</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>) (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>)) :: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>)))).<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">H2</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">F'</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">l1_sigma'_eq</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">H1</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>)  (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2'''</span>) ((<span class="id" type="var">or_intror</span> <span class="id" type="var">_</span> (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>)))))).<br/>

<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>)))<br/>
<span class="id" type="keyword">with</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">quicksort</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (((<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>)) :: <span class="id" type="var">nil</span>) ++ <span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) <span class="id" type="var">l1</span>))));<br/>
[ <span class="id" type="var">idtac</span> | <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> =&gt; <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l</span>)).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">sort_is_unique</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_sorted</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="keyword">with</span> <span class="id" type="var">f1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">flatten_app</span>.<br/>
<span class="id" type="tactic">transitivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>) :: <span class="id" type="var">nil</span>) ++ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2'''</span> :: <span class="id" type="var">nil</span>))).<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_app1</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">l1_sigma'_eq</span>; <br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">flatten_apply_cf_subst</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">transitivity</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>) :: <span class="id" type="var">nil</span>) ++ <span class="id" type="var">l2'''</span>).<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_app1</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">flatten_build</span>; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">In_t</span>; <span class="id" type="tactic">apply</span> (<span class="id" type="var">well_formed_cf_alien</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_t2</span>); <span class="id" type="tactic">subst</span> <span class="id" type="var">l2</span> <span class="id" type="var">l2'''</span>;<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_app_or</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">In_t</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">In_t</span>; <span class="id" type="tactic">intros</span> [<span class="id" type="var">In_t</span> | <span class="id" type="var">In_t</span>];<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">in_or_app</span>; [<span class="id" type="var">left</span> | <span class="id" type="var">right</span>; <span class="id" type="var">right</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">l2</span> <span class="id" type="var">l2'''</span> <span class="id" type="var">cp1'</span>.<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">l2'</span> ++ <span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span> :: <span class="id" type="var">l2''</span>) <span class="id" type="keyword">with</span> ((<span class="id" type="var">l2'</span> ++ <span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span> :: <span class="id" type="var">nil</span>) ++ <span class="id" type="var">l2''</span>).<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_ass</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_app2</span>.<br/>
<span class="id" type="tactic">refine</span> (<span class="id" type="var">permut_trans</span> <span class="id" type="var">_</span> (<span class="id" type="var">list_permut_app_app</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>));<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_app2</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">new_var_p1_sigma'_eq</span> :=<br/>
&nbsp;&nbsp;(<span class="id" type="var">H1</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>))  (<span class="id" type="var">build</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2'''</span>) (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>)))).<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">v1_sigma'_eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">new_var_p1_sigma'_eq</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">g2_eq_hd_p1</span>;<br/>
<span class="id" type="tactic">transitivity</span><br/>
(<span class="id" type="var">Term</span> <span class="id" type="var">g2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">quicksort</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">flatten</span> <span class="id" type="var">g2</span> (<span class="id" type="var">build</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2'''</span> :: <span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id" type="var">nil</span>).<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> <span class="id" type="var">g2</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">g2</span>); [<span class="id" type="tactic">intros</span> <span class="id" type="var">f1_eq_g2</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>]; <br/>
[<span class="id" type="var">absurd</span> (<span class="id" type="var">f1</span> = <span class="id" type="var">g2</span>); <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">trivial</span> | <span class="id" type="tactic">auto</span>].<br/>
<span class="id" type="tactic">replace</span> <span class="id" type="var">ll2</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">quicksort</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">g2</span> (<span class="id" type="var">build</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2'''</span> :: <span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>))); <span class="id" type="tactic">auto</span>;<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">sort_is_unique</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_sorted</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="keyword">with</span> <span class="id" type="var">g2</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>; <br/>
<span class="id" type="tactic">replace</span>  (<span class="id" type="var">build</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2'''</span> :: <span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>) <span class="id" type="keyword">with</span>  <br/>
((<span class="id" type="var">build</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2'''</span> :: <span class="id" type="var">nil</span>) ++ (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>)); <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">flatten_app</span>.<br/>
<span class="id" type="tactic">transitivity</span> (<span class="id" type="var">ll2'''</span> ++ <span class="id" type="var">flatten</span> <span class="id" type="var">g2</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>)).<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_app2</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">flatten_build</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">In_t</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_alien</span> <span class="id" type="keyword">with</span> <span class="id" type="var">ll2</span>; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">ll2</span> <span class="id" type="var">ll2'''</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_app_or</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">In_t</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">In_t</span>; <span class="id" type="tactic">intros</span> [<span class="id" type="var">In_t</span> | <span class="id" type="var">In_t</span>];<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">in_or_app</span>; [<span class="id" type="var">left</span> | <span class="id" type="var">right</span>; <span class="id" type="var">right</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">g2</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>)) <span class="id" type="keyword">with</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span> :: <span class="id" type="var">nil</span>).<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">ll2</span> <span class="id" type="var">ll2'''</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_add_inside</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_nil_end</span>; <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">destruct</span> (<span class="id" type="var">arity</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>)) <span class="id" type="keyword">as</span> [ | | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">well_formed_cf_alien</span> <span class="id" type="var">Ag2</span> <span class="id" type="var">W_g2_ll2</span> <span class="id" type="var">cp1</span>); <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="keyword">as</span> [ | <span class="id" type="var">g1</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>;<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>) <span class="id" type="var">g1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>) <span class="id" type="var">g1</span>); [<span class="id" type="tactic">intros</span> <span class="id" type="var">g2_eq_g1</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>].<br/>
<span class="id" type="var">absurd</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span> = <span class="id" type="var">g1</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">in_or_app</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">app_ass</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">ac_elementary_solve_term_var_without_val_term</span> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">In_pb'</span>;<br/>
<span class="id" type="tactic">pattern</span> <span class="id" type="var">pb'</span>;<br/>
<span class="id" type="tactic">refine</span> <br/>
(<span class="id" type="var">prop_map12_without_repetition</span> (<span class="id" type="var">B</span>:=matching_problem) <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>).<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>;<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">t2</span> <span class="id" type="var">In_t2</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> <span class="id" type="var">t2</span> <span class="id" type="var">l2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> <span class="id" type="var">t2</span> <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">l2'''</span> | ]; <span class="id" type="tactic">trivial</span>; <br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1'</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [ <span class="id" type="var">H''</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">l2'''_eq</span>;<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Common</span> : <br/>
(<span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span> : <span class="id" type="var">substitution</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">is_rough_sol</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">mk_pb</span> (<span class="id" type="var">existential_vars</span> <span class="id" type="var">pb</span>) ((<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>, <span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2'''</span>) :: <span class="id" type="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" type="var">v1</span>, <span class="id" type="var">t2</span>) :: <span class="id" type="var">solved_part</span> <span class="id" type="var">pb</span>) (<span class="id" type="var">partly_solved_part</span> <span class="id" type="var">pb</span>)) <span class="id" type="var">sigma'</span> /\<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">v</span> : <span class="id" type="var">variable</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">In</span> <span class="id" type="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">existential_vars</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">mk_pb</span> (<span class="id" type="var">existential_vars</span> <span class="id" type="var">pb</span>) ((<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>, <span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2'''</span>) :: <span class="id" type="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" type="var">v1</span>, <span class="id" type="var">t2</span>) :: <span class="id" type="var">solved_part</span> <span class="id" type="var">pb</span>) (<span class="id" type="var">partly_solved_part</span> <span class="id" type="var">pb</span>))) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v</span>) = <span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v</span>))) -&gt;<br/>
<span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span> : <span class="id" type="var">substitution</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">is_rough_sol</span> <span class="id" type="var">pb</span> <span class="id" type="var">sigma'</span> /\<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">v</span> : <span class="id" type="var">variable</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">In</span> <span class="id" type="var">v</span> (<span class="id" type="var">existential_vars</span> <span class="id" type="var">pb</span>) \/<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v</span>) = <span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v</span>))).<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">is_rough_sol</span>; <br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">split</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">split</span>] | <span class="id" type="var">idtac</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">st_eq</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">v1_sigma'_eq</span> : <span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>) = <span class="id" type="var">t2</span>).<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">H3</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">X.eq_bool_ok</span> <span class="id" type="var">v1</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v1</span> <span class="id" type="var">v1</span>); [ <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">v1_diff_v1</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">absurd</span> (<span class="id" type="var">v1</span> = <span class="id" type="var">v1</span>)] ; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">l1_sigma'_eq</span> := <span class="id" type="var">H1</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>)  (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2'''</span>) (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>))).<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>)))<br/>
<span class="id" type="keyword">with</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">quicksort</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> ((<span class="id" type="var">t2</span> :: <span class="id" type="var">nil</span>) ++ <span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) <span class="id" type="var">l1</span>))));<br/>
[ <span class="id" type="var">idtac</span> | <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">v1_sigma'_eq</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> =&gt; <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l</span>));<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">sort_is_unique</span>;<br/>
[ <span class="id" type="tactic">apply</span> <span class="id" type="var">quick_sorted</span> | <span class="id" type="tactic">apply</span> (<span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_t2</span>) | <span class="id" type="var">idtac</span>];<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">flatten_app</span>; <br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Ft2</span> : <span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">t2</span> :: <span class="id" type="var">nil</span>) = <span class="id" type="var">t2</span> :: <span class="id" type="var">nil</span>).<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">well_formed_cf_alien</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_t2</span> <span class="id" type="var">_</span> <span class="id" type="var">In_t2</span>); <span class="id" type="tactic">intro</span>; <br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">g2</span>]; <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">simpl</span>;<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> <span class="id" type="var">g2</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">g2</span>); [<span class="id" type="tactic">intro</span> <span class="id" type="var">f1_eq_g2</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>]; [<span class="id" type="var">absurd</span> (<span class="id" type="var">f1</span> = <span class="id" type="var">g2</span>); <span class="id" type="tactic">trivial</span> | <span class="id" type="tactic">auto</span>].<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Ft2</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">l2</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_cons_inside</span>.<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">flatten_apply_cf_subst</span> <span class="id" type="var">sigma'</span> <span class="id" type="var">l1</span> <span class="id" type="var">Af1</span>); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">l1_sigma'_eq</span>;<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">flatten_build</span>; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">In_t</span>; <span class="id" type="tactic">apply</span> (<span class="id" type="var">well_formed_cf_alien</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_t2</span>);<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_app_or</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">In_t</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">In_t</span>; <span class="id" type="tactic">intros</span> [<span class="id" type="var">In_t</span> | <span class="id" type="var">In_t</span>];<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">in_or_app</span>; [<span class="id" type="var">left</span> | <span class="id" type="var">right</span>; <span class="id" type="var">right</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">v</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">H3</span> <span class="id" type="var">v</span>); <span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">X.eq_bool_ok</span> <span class="id" type="var">v</span>  <span class="id" type="var">v1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v</span> <span class="id" type="var">v1</span>); [<span class="id" type="tactic">intro</span> <span class="id" type="var">v_eq_v1</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">trivial</span>].<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">v1</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">F</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">exact</span> <span class="id" type="var">I</span>.<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">EDS.A</span>, <span class="id" type="var">DOS.A</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">destruct</span> (<span class="id" type="var">le_gt_dec</span> (<span class="id" type="var">length</span> <span class="id" type="var">l2</span>) (<span class="id" type="var">length</span> <span class="id" type="var">l1</span> + 1)) <span class="id" type="keyword">as</span> [<span class="id" type="var">_</span> | <span class="id" type="var">_</span>]; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Common</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]];<br/>
<span class="id" type="var">exists</span> ((<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>, <span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>))) :: <span class="id" type="var">sigma'</span>); <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">R</span>; [<span class="id" type="tactic">intuition</span> | <span class="id" type="var">idtac</span>].<br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">split</span>] ; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>];<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">st_eq</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> =&gt; <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l</span>));<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">sort_is_unique</span>; [ <span class="id" type="tactic">apply</span> <span class="id" type="var">quick_sorted</span> |  <span class="id" type="tactic">apply</span> (<span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_t2</span>) | <span class="id" type="var">idtac</span>];<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>; <br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">H2</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">unfold</span> <span class="id" type="var">partly_solved_part</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">find</span>;<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">X.eq_bool_ok</span> <span class="id" type="var">v1</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v1</span> <span class="id" type="var">v1</span>); [ <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">v1_diff_v1</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">absurd</span> (<span class="id" type="var">v1</span> = <span class="id" type="var">v1</span>)] ; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">H2_v1</span>; <span class="id" type="var">fold</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>)); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H2_v1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H2_v1</span>;<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="var">head_symb</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">new_var</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">closed_term</span>;<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> <span class="id" type="var">f1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">f1</span>); [<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">f1_diff_f1</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">False_rec</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">f1_diff_f1</span>; <span class="id" type="tactic">reflexivity</span>].<br/>
<span class="id" type="tactic">transitivity</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>)) :: <span class="id" type="var">t2</span> :: <span class="id" type="var">nil</span>) ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) <span class="id" type="var">l1</span>));<br/>
[<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_app2</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>; <span class="id" type="tactic">auto</span> | <span class="id" type="var">idtac</span>].<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>)) :: <span class="id" type="var">t2</span> :: <span class="id" type="var">nil</span>) <span class="id" type="keyword">with</span><br/>
((<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>)) :: <span class="id" type="var">nil</span>) ++ (<span class="id" type="var">t2</span> :: <span class="id" type="var">nil</span>)); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">l2</span> <span class="id" type="var">l2'''</span> <span class="id" type="var">cp1'</span>; <span class="id" type="tactic">rewrite</span> &lt;- (<span class="id" type="var">add_a_subterm</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_t2</span>);<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">l2'</span> ++ <span class="id" type="var">l2''</span>) :: <span class="id" type="var">t2</span> :: <span class="id" type="var">nil</span>) <span class="id" type="keyword">with</span> ((<span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">l2'</span> ++ <span class="id" type="var">l2''</span>) :: <span class="id" type="var">nil</span>) ++ (<span class="id" type="var">t2</span> :: <span class="id" type="var">nil</span>)); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <span class="id" type="var">flatten_app</span>; <span class="id" type="tactic">replace</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">t2</span> :: <span class="id" type="var">nil</span>)) <span class="id" type="keyword">with</span> (<span class="id" type="var">t2</span> :: <span class="id" type="var">nil</span>); <br/>
[<span class="id" type="var">idtac</span> | <span class="id" type="tactic">destruct</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">g2</span>]; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">trivial</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> <span class="id" type="var">g2</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">g2</span>); [<span class="id" type="tactic">intros</span> <span class="id" type="var">f1_eq_g2</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>]; <span class="id" type="tactic">trivial</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">absurd</span> (<span class="id" type="var">f1</span> = <span class="id" type="var">g2</span>); <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">apply</span> (<span class="id" type="var">well_formed_cf_alien</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_t2</span> <span class="id" type="var">_</span> <span class="id" type="var">In_t2</span>)].<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">app_ass</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_comm_cons</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">permut_add_inside</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_ass</span>; <span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_nil_end</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">permut_sym</span>; <br/>
<span class="id" type="tactic">rewrite</span> &lt;- (<span class="id" type="var">H1</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>) :: <span class="id" type="var">l1</span>))  (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">l2'</span> ++ <span class="id" type="var">l2''</span>)) (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>))).<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">build_eq_Term</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">generalize</span> (<span class="id" type="var">well_formed_cf_length</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_t1</span>); <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">trivial</span>].<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> <span class="id" type="var">f1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">f1</span>); [<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">f1_diff_f1</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">False_rec</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">f1_diff_f1</span>; <span class="id" type="tactic">reflexivity</span>].<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_nil_end</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>.<br/>
<span class="id" type="tactic">transitivity</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) (<span class="id" type="var">Var</span> (<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>) :: <span class="id" type="var">l1</span>))).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">list_permut_flatten</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">list_permut.permut_map</span> <span class="id" type="keyword">with</span> (@<span class="id" type="var">eq</span> <span class="id" type="var">term</span>).<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>; <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">destruct</span> (<span class="id" type="var">find</span> <span class="id" type="var">X.eq_bool</span> (<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>) <span class="id" type="var">sigma'</span>) <span class="id" type="keyword">as</span> [ [ | <span class="id" type="var">g</span> ] | ].<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">permut_refl</span>.<br/>
<span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">g</span>).<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_nil_end</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">permut_refl</span>.<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">permut_refl</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">permut_refl</span>.<br/>
<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">H2</span> <span class="id" type="var">v</span>); <span class="id" type="tactic">simpl</span> <span class="id" type="var">partly_solved_part</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">find</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">X.eq_bool_ok</span> <span class="id" type="var">v</span> <span class="id" type="var">v1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v</span> <span class="id" type="var">v1</span>); [<span class="id" type="tactic">intros</span> <span class="id" type="var">v_eq_v1</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">F'</span>; <span class="id" type="tactic">trivial</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">trivial</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">H4</span> <span class="id" type="var">v</span>); <span class="id" type="tactic">simpl</span> <span class="id" type="var">existential_vars</span>.<br/>
<span class="id" type="tactic">intros</span> [[<span class="id" type="var">v_eq</span> | <span class="id" type="var">In_v</span>] | <span class="id" type="var">v_sigma_eq</span>].<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">v_eq</span>; <span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">X.eq_bool_ok</span> <span class="id" type="var">v</span> <span class="id" type="var">v</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v</span> <span class="id" type="var">v</span>); [ <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">v_diff_v</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">absurd</span> (<span class="id" type="var">v</span> = <span class="id" type="var">v</span>)] ; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="var">right</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">X.eq_bool_ok</span> <span class="id" type="var">v</span> (<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>)); <span class="id" type="tactic">case</span> (<span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v</span> (<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>)).<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">v_eq</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">v_eq</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">ac_elementary_solve_term_term_term</span> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">In_pb'</span>;<br/>
<span class="id" type="tactic">pattern</span> <span class="id" type="var">pb'</span>;<br/>
<span class="id" type="tactic">refine</span> <br/>
(<span class="id" type="var">prop_map_without_repetition</span> (<span class="id" type="var">B</span>:=matching_problem) <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>);<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">intros</span> [ | <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>] <span class="id" type="var">In_t2</span>; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">g1</span> <span class="id" type="var">g2</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">g1</span> <span class="id" type="var">g2</span>); [<span class="id" type="tactic">intro</span> <span class="id" type="var">g1_eq_g2</span> | <span class="id" type="tactic">intro</span> <span class="id" type="var">g1_diff_g2</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>) <span class="id" type="var">l2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>) <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">l2'''</span> | ]; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1'</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [ <span class="id" type="var">H''</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">l2'''_eq</span>;<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>; <br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">split</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">split</span>] | <span class="id" type="var">idtac</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll1</span> :: <span class="id" type="var">l1</span>))) <span class="id" type="keyword">with</span><br/>
(<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">quicksort</span> (<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll1</span>) :: <span class="id" type="var">nil</span>) ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">flatten</span> <span class="id" type="var">f1</span> (<span class="id" type="var">map</span> (<span class="id" type="var">apply_cf_subst</span> <span class="id" type="var">sigma'</span>) <span class="id" type="var">l1</span>)))); <br/>
[<span class="id" type="var">idtac</span> | <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">flatten_app</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">trivial</span>].<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> =&gt; <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l</span>)).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">sort_is_unique</span>; <br/>
[<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_sorted</span> | <span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="keyword">with</span> <span class="id" type="var">f1</span>; <span class="id" type="tactic">trivial</span> | <span class="id" type="var">idtac</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>.<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">H1</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>))); <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">flatten_app</span>;<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">app_comm_cons</span>; <span class="id" type="tactic">simpl</span> (<span class="id" type="var">app</span> (<span class="id" type="var">A</span>:=term) <span class="id" type="var">nil</span>); <span class="id" type="var">cbv</span> <span class="id" type="var">beta</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">add_a_subterm_subst</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="var">right</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">u1</span> [ | <span class="id" type="var">u2</span> [ | <span class="id" type="var">u3</span> <span class="id" type="var">l1</span>]]]; [<span class="id" type="var">contradiction</span> | <span class="id" type="var">contradiction</span> | <span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l2</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">v1</span> [ | <span class="id" type="var">v2</span> [ | <span class="id" type="var">v3</span> <span class="id" type="var">l2</span>]]]; [<span class="id" type="var">contradiction</span> | <span class="id" type="var">contradiction</span> | <span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">pb'_eq_</span> | [<span class="id" type="var">pb'_eq_</span> | <span class="id" type="var">pb'_in_nil</span>]]; [<span class="id" type="tactic">subst</span> <span class="id" type="var">pb'</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">unsolved_part</span> | <span class="id" type="tactic">subst</span> <span class="id" type="var">pb'</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">unsolved_part</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>; <br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">split</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">split</span>] | <span class="id" type="var">idtac</span>]; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>;<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">H1</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>)));<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">H1</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">or_intror</span> <span class="id" type="var">_</span> (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>))));<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> =&gt; <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l</span>));<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">W_t2</span> := <span class="id" type="var">proj2</span> (<span class="id" type="var">W1</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>)))); <br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W_t2</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W_t2</span>; <br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">sort_is_unique</span>; [<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_sorted</span> | <span class="id" type="tactic">intuition</span> | <span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>; <span class="id" type="tactic">auto</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="var">right</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>; <br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">split</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">split</span>] | <span class="id" type="var">idtac</span>]; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>;<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">H1</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>)));<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">H1</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">or_intror</span> <span class="id" type="var">_</span> (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>))));<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> =&gt; <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l</span>));<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">W_t2</span> := <span class="id" type="var">proj2</span> (<span class="id" type="var">W1</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>)))); <br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W_t2</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W_t2</span>; <br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">sort_is_unique</span>; [<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_sorted</span> | <span class="id" type="tactic">intuition</span> | <span class="id" type="var">idtac</span>].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>.<br/>
<span class="id" type="tactic">apply</span> (@<span class="id" type="var">list_permut.Pcons</span> <span class="id" type="var">_</span> <span class="id" type="var">term</span> (@<span class="id" type="var">eq</span> <span class="id" type="var">term</span>) <span class="id" type="var">v2</span> <span class="id" type="var">v2</span> (<span class="id" type="var">v1</span> :: <span class="id" type="var">nil</span>) (<span class="id" type="var">v1</span> :: <span class="id" type="var">nil</span>) <span class="id" type="var">nil</span>); <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H1</span>; <span class="id" type="var">right</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">In_pb'</span> [<span class="id" type="var">sigma'</span> [[<span class="id" type="var">H1</span> [<span class="id" type="var">H2</span> <span class="id" type="var">H3</span>]] <span class="id" type="var">H4</span>]]; <span class="id" type="var">exists</span> <span class="id" type="var">sigma'</span>;<br/>
<span class="id" type="tactic">split</span>; [<span class="id" type="tactic">split</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">split</span>] | <span class="id" type="var">idtac</span>].<br/>
<span class="id" type="tactic">assert</span> <br/>
(<span class="id" type="var">In_t1t2</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">l</span>, <span class="id" type="var">In</span> (<span class="id" type="var">t1</span>,t2) <span class="id" type="var">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">fold_left2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> (<span class="id" type="var">current_list_of_eqs</span> : <span class="id" type="var">list</span> (<span class="id" type="var">term</span> * <span class="id" type="var">term</span>)) (<span class="id" type="var">t1</span> <span class="id" type="var">t2</span> : <span class="id" type="var">term</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">t1</span>, <span class="id" type="var">t2</span>) :: <span class="id" type="var">current_list_of_eqs</span>) <span class="id" type="var">l</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Some</span> <span class="id" type="var">new_list_of_equations</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">In</span> (<span class="id" type="var">t1</span>,t2) <span class="id" type="var">new_list_of_equations</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">None</span> =&gt; <span class="id" type="var">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>).<br/>
<span class="id" type="tactic">clear</span>  <span class="id" type="var">l</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">R</span> <span class="id" type="var">W1</span> <span class="id" type="var">U_pb</span> <span class="id" type="var">In_pb'</span>; <br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">a1</span> <span class="id" type="var">l1</span>]; <span class="id" type="tactic">intros</span> <span class="id" type="var">l2</span> <span class="id" type="var">l</span> <span class="id" type="var">In_l</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">l2</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">IHl1</span>; <span class="id" type="var">right</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">U_pb</span>;  <span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span> [<span class="id" type="var">st_eq</span> | <span class="id" type="var">In_st</span>].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">st_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">st_eq</span>;<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> =&gt; <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l</span>)).<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">L12</span> : <span class="id" type="var">length</span> <span class="id" type="var">l1</span> = <span class="id" type="var">length</span> <span class="id" type="var">l2</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_eq</span> <span class="id" type="keyword">with</span> <span class="id" type="var">n1</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">apply</span> <span class="id" type="var">sym_eq</span>];<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">W1</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2</span>) (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>)));<br/>
<span class="id" type="tactic">intros</span> [[<span class="id" type="var">_</span> <span class="id" type="var">W_t1</span>] [<span class="id" type="var">_</span> <span class="id" type="var">W_t2</span>]]; [<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W_t1</span> | <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W_t2</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> <span class="id" type="var">l</span> <span class="id" type="var">l2</span> <span class="id" type="var">In_pb'</span> <span class="id" type="var">L12</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">U_pb</span> <span class="id" type="var">R</span> <span class="id" type="var">W1</span> <span class="id" type="var">W2</span> <span class="id" type="var">W3</span> <span class="id" type="var">l</span> <span class="id" type="var">l2</span> <span class="id" type="var">In_pb'</span> <span class="id" type="var">L12</span> <span class="id" type="var">H1</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">t1</span> <span class="id" type="var">l1</span>]; <span class="id" type="tactic">destruct</span> <span class="id" type="var">l2</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">t2</span> <span class="id" type="var">l2</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">In_pb'</span> | <span class="id" type="var">In_pb'</span>] <span class="id" type="var">_</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">discriminate</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">discriminate</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">In_pb'</span> <span class="id" type="var">L12</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">eq_add_S</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">L12</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">L12</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">IHl1</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">In_pb'</span> <span class="id" type="var">L12</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">IHl1</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">IHl1</span>; <br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">In_t1t2</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> ((<span class="id" type="var">t1</span>,t2) :: <span class="id" type="var">l</span>) (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>))); <span class="id" type="tactic">clear</span> <span class="id" type="var">In_t1t2</span>; <br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">In_t1t2</span>.<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">In_pb'</span>;<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">fold_left2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> (<span class="id" type="var">current_list_of_eqs</span> : <span class="id" type="var">list</span> (<span class="id" type="var">term</span> * <span class="id" type="var">term</span>)) (<span class="id" type="var">t1</span> <span class="id" type="var">t2</span> : <span class="id" type="var">term</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">t1</span>, <span class="id" type="var">t2</span>) :: <span class="id" type="var">current_list_of_eqs</span>) ((<span class="id" type="var">t1</span>,t2) :: <span class="id" type="var">l</span>) <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">new_list_of_equations</span> | ];<br/>
[<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">generalize</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">intros</span> [<span class="id" type="var">pb'_eq</span> | <span class="id" type="var">In_pb'</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> (<span class="id" type="var">IHl1</span> <span class="id" type="var">H1</span>); <span class="id" type="tactic">injection</span> <span class="id" type="var">pb'_eq</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">rewrite</span> (<span class="id" type="var">H1</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">In_t1t2</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">H1</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">In_t1t2</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">_</span> <span class="id" type="var">In_st</span>).<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">fold_left2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> (<span class="id" type="var">current_list_of_eqs</span> : <span class="id" type="var">list</span> (<span class="id" type="var">term</span> * <span class="id" type="var">term</span>)) (<span class="id" type="var">t1</span> <span class="id" type="var">t2</span> : <span class="id" type="var">term</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">t1</span>, <span class="id" type="var">t2</span>) :: <span class="id" type="var">current_list_of_eqs</span>) <span class="id" type="var">l</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>);<br/>
[<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">generalize</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">intros</span> [<span class="id" type="var">pb'_eq</span> | <span class="id" type="var">In_pb'</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">fold_left2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> (<span class="id" type="var">current_list_of_eqs</span> : <span class="id" type="var">list</span> (<span class="id" type="var">term</span> * <span class="id" type="var">term</span>)) (<span class="id" type="var">t1</span> <span class="id" type="var">t2</span> : <span class="id" type="var">term</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">t1</span>, <span class="id" type="var">t2</span>) :: <span class="id" type="var">current_list_of_eqs</span>) <span class="id" type="var">l</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>);<br/>
[<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">generalize</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">intros</span> [<span class="id" type="var">pb'_eq</span> | <span class="id" type="var">In_pb'</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">v</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H2</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">fold_left2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> (<span class="id" type="var">current_list_of_eqs</span> : <span class="id" type="var">list</span> (<span class="id" type="var">term</span> * <span class="id" type="var">term</span>)) (<span class="id" type="var">t1</span> <span class="id" type="var">t2</span> : <span class="id" type="var">term</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">t1</span>, <span class="id" type="var">t2</span>) :: <span class="id" type="var">current_list_of_eqs</span>) <span class="id" type="var">l</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>);<br/>
[<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">generalize</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">intros</span> [<span class="id" type="var">pb'_eq</span> | <span class="id" type="var">In_pb'</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">v</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H3</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">fold_left2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> (<span class="id" type="var">current_list_of_eqs</span> : <span class="id" type="var">list</span> (<span class="id" type="var">term</span> * <span class="id" type="var">term</span>)) (<span class="id" type="var">t1</span> <span class="id" type="var">t2</span> : <span class="id" type="var">term</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">t1</span>, <span class="id" type="var">t2</span>) :: <span class="id" type="var">current_list_of_eqs</span>) <span class="id" type="var">l</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>);<br/>
[<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">generalize</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">intros</span> [<span class="id" type="var">pb'_eq</span> | <span class="id" type="var">In_pb'</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">v</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H4</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Make</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://www.lix.polytechnique.fr/coq/">coqdoc</a>
</div>

</div>

</body>
</html>