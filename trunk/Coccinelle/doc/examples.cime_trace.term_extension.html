<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>examples.cime_trace.term_extension</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library examples.cime_trace.term_extension</h1>

<div class="code">
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">List</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Bool</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">TransClosure</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="var">term</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="var">terminaison</span>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="var">Make</span>(<span class="id" type="var">M</span>:term_spec.<span class="id" type="var">Term</span>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Import</span> <span class="id" type="var">M</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">find_replacement</span> <span class="id" type="var">l</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">nil</span> =&gt; <span class="id" type="var">constr</span>:(@nil <span class="id" type="var">term</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?x::?l =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">l'</span>:=find_replacement <span class="id" type="var">l</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">H</span>: <span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">_</span> ?x' <span class="id" type="var">x</span> |- <span class="id" type="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:x'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" type="var">_</span> =&gt; <span class="id" type="var">constr</span>:x<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(e::l')<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">is_closed_list</span> <span class="id" type="var">is_closed</span> <span class="id" type="var">l</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">nil</span> =&gt; <span class="id" type="var">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?t::?l =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">is_closed</span> <span class="id" type="var">t</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">is_closed_list</span> <span class="id" type="var">is_closed</span> <span class="id" type="var">l</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">is_closed</span> <span class="id" type="var">t</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Term</span> <span class="id" type="var">_</span> ?l =&gt; <span class="id" type="var">is_closed_list</span> <span class="id" type="var">ltac</span>:is_closed <span class="id" type="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Var</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">H</span>:_ |- <span class="id" type="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">H</span>  =&gt; <span class="id" type="var">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Ltac</span> <span class="id" type="var">star_refl'</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">H</span>:_ |- <span class="id" type="var">_</span> =&gt; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>|| <span class="id" type="var">revert</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>);<span class="id" type="tactic">intros</span>;  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" type="var">refl_trans_clos</span> <span class="id" type="var">_</span> ?t2 ?t1  =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">is_closed</span> <span class="id" type="var">t1</span> ; <span class="id" type="var">econstructor</span> 1) || (<span class="id" type="var">is_closed</span> <span class="id" type="var">t2</span>; <span class="id" type="var">econstructor</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <span class="id" type="var">eq_term_term_bool</span> <span class="id" type="var">t1_t2</span> <span class="id" type="var">t1'_t2'</span> : <span class="id" type="var">bool</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t1_t2</span>,t1'<span class="id" type="var">_t2'</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">t1</span>,t2),(t1',t2') =&gt; <span class="id" type="var">andb</span> (<span class="id" type="var">M.eq_bool</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span>) (<span class="id" type="var">M.eq_bool</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">eq_term_term_bool_ok</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">t1_t2</span> <span class="id" type="var">t1'_t2'</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <span class="id" type="var">eq_term_term_bool</span> <span class="id" type="var">t1_t2</span> <span class="id" type="var">t1'_t2'</span> <span class="id" type="keyword">then</span> <span class="id" type="var">t1_t2</span> = <span class="id" type="var">t1'_t2'</span> <span class="id" type="keyword">else</span> <span class="id" type="var">t1_t2</span> &lt;&gt; <span class="id" type="var">t1'_t2'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">t1</span> <span class="id" type="var">t2</span>] [<span class="id" type="var">t1'</span> <span class="id" type="var">t2'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> (<span class="id" type="var">M.eq_bool_ok</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span> (<span class="id" type="var">eq_bool</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> (<span class="id" type="var">M.eq_bool_ok</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span> (<span class="id" type="var">eq_bool</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>;<span class="id" type="tactic">subst</span>;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t2_neq_t2'</span> <span class="id" type="var">_</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">elim</span> <span class="id" type="var">t2_neq_t2'</span>;<span class="id" type="tactic">injection</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">intros</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t1_neq_t1'</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">elim</span> <span class="id" type="var">t1_neq_t1'</span>;<span class="id" type="tactic">injection</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">intros</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <span class="id" type="var">term_eq_bool_equiv</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span> : <span class="id" type="var">M.term</span>, <span class="id" type="var">f</span> = <span class="id" type="var">g</span> &lt;-&gt; <span class="id" type="var">M.eq_bool</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span> = <span class="id" type="var">true</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> (<span class="id" type="var">M.eq_bool_ok</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">case</span> (<span class="id" type="var">eq_bool</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span> <span class="id" type="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Make</span>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="var">IntVars</span>.<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">A</span> := <span class="id" type="var">nat</span>.<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">eq_bool</span> (<span class="id" type="var">n1</span> <span class="id" type="var">n2</span>:nat) : <span class="id" type="var">bool</span> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n1</span>,n2 <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0,0 =&gt; <span class="id" type="var">true</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n1</span>,S <span class="id" type="var">n2</span> =&gt; <span class="id" type="var">eq_bool</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>,_ =&gt; <span class="id" type="var">false</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">eq_bool_ok</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>, <span class="id" type="keyword">if</span> <span class="id" type="var">eq_bool</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span> <span class="id" type="keyword">then</span> <span class="id" type="var">n1</span>=n2 <span class="id" type="keyword">else</span> <span class="id" type="var">n1</span>&lt;&gt;n2.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">n1</span> <span class="id" type="keyword">as</span> [|n1];<span class="id" type="tactic">intros</span> [|n2];<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">discriminate</span> <span class="id" type="var">abs</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">discriminate</span> <span class="id" type="var">abs</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> (<span class="id" type="var">IHn1</span> <span class="id" type="var">n2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span> (<span class="id" type="var">eq_bool</span> <span class="id" type="var">n1</span> <span class="id" type="var">n2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">Heq</span>;<span class="id" type="tactic">f_equal</span>;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Hneq</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">elim</span> <span class="id" type="var">Hneq</span>;<span class="id" type="tactic">injection</span> <span class="id" type="var">abs</span>;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">exact</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">IntVars</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://www.lix.polytechnique.fr/coq/">coqdoc</a>
</div>

</div>

</body>
</html>