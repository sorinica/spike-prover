<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>ac_matching.matching_well_founded</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library ac_matching.matching_well_founded</h1>

<div class="code">

<br/>
<span class="id" type="keyword">Add</span> <span class="id" type="var">LoadPath</span> "basis".<br/>
<span class="id" type="keyword">Add</span> <span class="id" type="var">LoadPath</span> "term_algebra".<br/>
<span class="id" type="keyword">Add</span> <span class="id" type="var">LoadPath</span> "term_orderings".<br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Arith</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">List</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">more_list</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">list_sort</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">term_spec</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">ac</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">cf_eq_ac</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">matching</span>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="keyword">Type</span> <span class="id" type="var">S</span>.<br/>

<br/>
<span class="id" type="keyword">Declare Module</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Matching</span> : <span class="id" type="var">matching.S</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">Cf_eq_ac</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">Ac</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">EqTh</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">T</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">pb_weight</span> <span class="id" type="var">pb</span> := <br/>
&nbsp;&nbsp;<span class="id" type="var">list_size</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">t1_t2</span> : <span class="id" type="var">term</span> * <span class="id" type="var">term</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t1_t2</span> <span class="id" type="keyword">with</span> | (<span class="id" type="var">t1</span>,t2) =&gt; <span class="id" type="var">ac_size</span> <span class="id" type="var">t1</span> + <span class="id" type="var">ac_size</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">unsolved_part</span> <span class="id" type="var">pb</span>).<br/>
<span class="id" type="keyword">Parameter</span> <span class="id" type="var">well_founded_solve</span> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pb</span>, <span class="id" type="var">well_formed_pb</span> <span class="id" type="var">pb</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pb'</span>, <span class="id" type="var">In</span> <span class="id" type="var">pb'</span> (<span class="id" type="var">solve</span> <span class="id" type="var">pb</span>) -&gt; <span class="id" type="var">pb_weight</span> <span class="id" type="var">pb'</span> &lt; <span class="id" type="var">pb_weight</span> <span class="id" type="var">pb</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">S</span>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="var">Make</span> (<span class="id" type="var">Matching1</span> : <span class="id" type="var">matching.S</span>) : <span class="id" type="var">S</span> <span class="id" type="keyword">with</span> <span class="id" type="keyword">Module</span> <span class="id" type="var">Matching</span> := <span class="id" type="var">Matching1</span>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="var">Matching</span> := <span class="id" type="var">Matching1</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">Matching1</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">Cf_eq_ac</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">Ac</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">EqTh</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">T</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">F</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">X</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="keyword">Sort</span>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">LPermut</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ac_size_build_eq</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span>, <span class="id" type="var">arity</span> <span class="id" type="var">f</span> = <span class="id" type="var">AC</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">ac_size</span> (<span class="id" type="var">build</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span>) = (<span class="id" type="var">length</span> <span class="id" type="var">l</span> - 1) + <span class="id" type="var">list_size</span> <span class="id" type="var">ac_size</span> <span class="id" type="var">l</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span> <span class="id" type="var">Af</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">build</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">l</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">t1</span> <span class="id" type="var">l</span>].<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">quicksort_equation</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">t2</span> <span class="id" type="var">l</span>].<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ac_size_unfold</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">length_quicksort</span>;<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="tactic">f_equal</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> =&gt; <span class="id" type="var">length</span> (<span class="id" type="var">t1</span> :: <span class="id" type="var">t2</span> :: <span class="id" type="var">l</span>) -1 + <span class="id" type="var">n</span>));<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">list_permut.permut_size</span> <span class="id" type="keyword">with</span> (@<span class="id" type="var">eq</span> <span class="id" type="var">term</span>).<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>; <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ac_size_build_lt_args</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">t1</span>, <span class="id" type="var">arity</span> <span class="id" type="var">f</span> = <span class="id" type="var">AC</span> -&gt; <span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> (<span class="id" type="var">l1</span> ++ <span class="id" type="var">t1</span> :: <span class="id" type="var">l2</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">ac_size</span> (<span class="id" type="var">build</span> <span class="id" type="var">f</span> (<span class="id" type="var">l1</span> ++ <span class="id" type="var">l2</span>)) + <span class="id" type="var">ac_size</span> <span class="id" type="var">t1</span> &lt; <span class="id" type="var">ac_size</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> (<span class="id" type="var">l1</span> ++ <span class="id" type="var">t1</span> :: <span class="id" type="var">l2</span>)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">t1</span> <span class="id" type="var">Ar</span> <span class="id" type="var">W</span>; <br/>
<span class="id" type="tactic">pattern</span> (<span class="id" type="var">ac_size</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> (<span class="id" type="var">l1</span> ++ <span class="id" type="var">t1</span> :: <span class="id" type="var">l2</span>))); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">ac_size_unfold</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ac_size_build_eq</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <span class="id" type="var">length_app</span>;<br/>
<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <span class="id" type="var">list_size_app</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>; <br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">plus_lt_le_compat</span>.<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">plus_comm</span> (<span class="id" type="var">length</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">S</span> (<span class="id" type="var">length</span> <span class="id" type="var">l2</span>))); <span class="id" type="tactic">simpl</span>;<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">minus_n_O</span>;<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">plus_comm</span> (<span class="id" type="var">length</span> <span class="id" type="var">l2</span>));<br/>
<span class="id" type="tactic">elim</span> <span class="id" type="var">W</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">W</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Ar</span>; <br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> <span class="id" type="var">W</span>; <span class="id" type="tactic">elim</span> <span class="id" type="var">W</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">W</span>;<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">L</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">length_app</span> <span class="id" type="keyword">in</span> <span class="id" type="var">L</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">L</span>;<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span> <span class="id" type="keyword">in</span> <span class="id" type="var">L</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">L</span>;<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span> <span class="id" type="keyword">in</span> <span class="id" type="var">L</span>;<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">length</span> <span class="id" type="var">l1</span> + <span class="id" type="var">length</span> <span class="id" type="var">l2</span>).<br/>
<span class="id" type="var">absurd</span> (1 &gt;= 2); <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">ge</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>.<br/>
<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_compat_l</span>; <br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ac_size_build_lt</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">t1</span>, <span class="id" type="var">arity</span> <span class="id" type="var">f</span> = <span class="id" type="var">AC</span> -&gt; <span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> (<span class="id" type="var">l1</span> ++ <span class="id" type="var">t1</span> :: <span class="id" type="var">l2</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">ac_size</span> (<span class="id" type="var">build</span> <span class="id" type="var">f</span> (<span class="id" type="var">l1</span> ++ <span class="id" type="var">l2</span>)) &lt; <span class="id" type="var">ac_size</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f</span> (<span class="id" type="var">l1</span> ++ <span class="id" type="var">t1</span> :: <span class="id" type="var">l2</span>)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">f</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">t1</span> <span class="id" type="var">Ar</span> <span class="id" type="var">W</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">lt_le_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">ac_size</span> (<span class="id" type="var">build</span> <span class="id" type="var">f</span> (<span class="id" type="var">l1</span> ++ <span class="id" type="var">l2</span>)) + <span class="id" type="var">ac_size</span> <span class="id" type="var">t1</span>).<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">plus_n_O</span> (<span class="id" type="var">ac_size</span> (<span class="id" type="var">build</span> <span class="id" type="var">f</span> (<span class="id" type="var">l1</span> ++ <span class="id" type="var">l2</span>))));<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_lt_compat_l</span>;<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">lt</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_ge_one</span>;<br/>
<span class="id" type="tactic">elim</span> (<span class="id" type="var">well_formed_cf_unfold</span> <span class="id" type="var">_</span> <span class="id" type="var">W</span>); <span class="id" type="tactic">intros</span> <span class="id" type="var">Wl</span> <span class="id" type="var">_</span>;<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">Wl</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">in_or_app</span>; <span class="id" type="var">right</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">lt_le_weak</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt_args</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">pb_weight</span> <span class="id" type="var">pb</span> := <br/>
&nbsp;&nbsp;<span class="id" type="var">list_size</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">t1_t2</span> : <span class="id" type="var">term</span> * <span class="id" type="var">term</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t1_t2</span> <span class="id" type="keyword">with</span> | (<span class="id" type="var">t1</span>,t2) =&gt; <span class="id" type="var">ac_size</span> <span class="id" type="var">t1</span> + <span class="id" type="var">ac_size</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">unsolved_part</span> <span class="id" type="var">pb</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <span class="id" type="var">well_founded_solve</span> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pb</span>, <span class="id" type="var">well_formed_pb</span> <span class="id" type="var">pb</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">pb'</span>, <span class="id" type="var">In</span> <span class="id" type="var">pb'</span> (<span class="id" type="var">solve</span> <span class="id" type="var">pb</span>) -&gt; <span class="id" type="var">pb_weight</span> <span class="id" type="var">pb'</span> &lt; <span class="id" type="var">pb_weight</span> <span class="id" type="var">pb</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">pb_weight</span>, <span class="id" type="var">solve</span>, <span class="id" type="var">well_formed_pb</span>;<br/>
&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">pb</span> [<span class="id" type="var">W1</span> [<span class="id" type="var">W2</span> [<span class="id" type="var">W3</span> <span class="id" type="var">_</span>]]] <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>;<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">unsolved_part</span> <span class="id" type="var">pb</span>) <span class="id" type="keyword">as</span> [ | [[<span class="id" type="var">v1</span> | <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>] <span class="id" type="var">t2</span>] <span class="id" type="var">l</span>].<br/>
<span class="id" type="var">contradiction</span>.<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">find</span> <span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v1</span> (<span class="id" type="var">solved_part</span> <span class="id" type="var">pb</span>)) <span class="id" type="keyword">as</span> [<span class="id" type="var">t1</span> | ].<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">T.eq_bool</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">t1_eq_t2</span> | <span class="id" type="var">_</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>];<br/>
<span class="id" type="tactic">inversion_clear</span> <span class="id" type="var">In_pb'</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">pb'_eq_</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>];<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">W3</span> <span class="id" type="var">v1</span>); <br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">find</span> <span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v1</span> (<span class="id" type="var">partly_solved_part</span> <span class="id" type="var">pb</span>)) <span class="id" type="keyword">as</span> [ <span class="id" type="var">p1</span> |].<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">v2</span> | <span class="id" type="var">f2</span> <span class="id" type="var">l2</span>].<br/>
<span class="id" type="var">contradiction</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>) <span class="id" type="var">f2</span>); <br/>
<span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>) <span class="id" type="var">f2</span>); [<span class="id" type="tactic">intros</span> <span class="id" type="var">f1_eq_f2</span> <span class="id" type="var">In_pb'</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">f1_eq_f2</span>; <span class="id" type="var">destruct_arity</span> <span class="id" type="var">f2</span> <span class="id" type="var">n2</span> <span class="id" type="var">Af2</span>; [ <span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">assert</span> (<span class="id" type="var">In_l2</span> := <span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">l2</span>).<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [ <span class="id" type="var">l2'''</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">In_l2</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">cp1</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [<span class="id" type="var">H</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">l2_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">l2</span>;<br/>
<span class="id" type="tactic">inversion_clear</span> <span class="id" type="var">In_pb'</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">pb'_eq_</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">unsolved_part</span>; <br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">list_size_tl_compat</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_lt_compat</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt</span>;<br/>
[ <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af2</span> | <span class="id" type="tactic">apply</span> (<span class="id" type="var">proj2</span> (<span class="id" type="var">A</span>:=well_formed_cf (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>))); <span class="id" type="tactic">apply</span> <span class="id" type="var">W1</span>; <span class="id" type="var">left</span>] ; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">inversion_clear</span> <span class="id" type="var">In_pb'</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">pb'_eq_</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">unsolved_part</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>.<br/>

<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">as</span> [ <span class="id" type="var">v2</span> | <span class="id" type="var">f2</span> <span class="id" type="var">l2</span> ].<br/>
<span class="id" type="var">contradiction</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">In_pb'</span>;  <span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> <span class="id" type="var">f2</span>); <br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">f2</span>); [<span class="id" type="tactic">intros</span> <span class="id" type="var">f1_eq_f2</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">f2</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="var">destruct_arity</span> <span class="id" type="var">f1</span> <span class="id" type="var">n1</span> <span class="id" type="var">Af1</span>.<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">le_gt_dec</span> (<span class="id" type="var">length</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">length</span> <span class="id" type="var">l2</span>)) <span class="id" type="keyword">as</span> [<span class="id" type="var">_</span> | <span class="id" type="var">_</span>]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">ac_elementary_solve</span> <span class="id" type="keyword">in</span> <span class="id" type="var">In_pb'</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">W_t1</span> :  <span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>)).<br/>
<span class="id" type="tactic">refine</span> (<span class="id" type="var">proj1</span> <span class="id" type="var">_</span> (<span class="id" type="var">B</span>:= (<span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2</span>)))); <span class="id" type="tactic">apply</span> <span class="id" type="var">W1</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">W_t2</span> : <span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2</span>)).<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="var">proj2</span> (<span class="id" type="var">A</span>:= (<span class="id" type="var">well_formed_cf</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>)))); <span class="id" type="tactic">apply</span> <span class="id" type="var">W1</span>; <span class="id" type="var">left</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">t1</span> <span class="id" type="var">l1</span>].<br/>
<span class="id" type="var">absurd</span> (2 &lt;= @<span class="id" type="var">length</span> <span class="id" type="var">term</span> <span class="id" type="var">nil</span>); <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>;<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">well_formed_cf_length</span> <span class="id" type="keyword">with</span> <span class="id" type="var">f1</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">v1</span> | <span class="id" type="var">g1</span> <span class="id" type="var">ll1</span>].<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">W2</span> <span class="id" type="var">v1</span>); <br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">find</span> <span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v1</span> (<span class="id" type="var">solved_part</span> <span class="id" type="var">pb</span>)) <span class="id" type="keyword">as</span> [<span class="id" type="var">s1</span> | ].<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">W_s1</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">ac_elementary_solve_term_var_with_val_term</span> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> <span class="id" type="var">s1</span> <span class="id" type="var">l2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> <span class="id" type="var">s1</span> <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [ <span class="id" type="var">l2'''</span> |].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [ <span class="id" type="var">H</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">l2_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">l2'''</span>;<br/>
<span class="id" type="tactic">inversion_clear</span> <span class="id" type="var">In_pb'</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">pb'_eq_</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">W1</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>))  (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2</span>) (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>)));<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">Wt1</span> <span class="id" type="var">Wt2</span>];  <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">unsolved_part</span>; <br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">list_size_tl_compat</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_lt_compat</span>; <br/>
[<span class="id" type="tactic">replace</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">nil</span> ++ <span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>); <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">nil</span> ++ <span class="id" type="var">l1</span>)); <span class="id" type="tactic">trivial</span> | <br/>
<span class="id" type="var">idtac</span>]; <span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">s1</span> <span class="id" type="keyword">as</span> [| <span class="id" type="var">g1</span> <span class="id" type="var">ll1</span>].<br/>
<span class="id" type="var">contradiction</span>.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">In_pb'</span>; <br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> <span class="id" type="var">g1</span>); <span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> <span class="id" type="var">g1</span>); [<span class="id" type="tactic">intros</span> <span class="id" type="var">f1_eq_g1</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">g1</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">S_ll1</span> := <span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_s1</span>).<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">S_l2</span> := <span class="id" type="var">well_formed_cf_sorted</span> <span class="id" type="var">Af1</span> <span class="id" type="var">W_t2</span>).<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove_list</span> <span class="id" type="var">S_ll1</span> <span class="id" type="var">S_l2</span>); <br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove_list</span> <span class="id" type="var">ll1</span> <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">l2'</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span> ].<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">DOS.A</span> <span class="id" type="keyword">in</span> *;<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">le_gt_dec</span> (<span class="id" type="var">length</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">length</span> <span class="id" type="var">l2'</span>)) <span class="id" type="keyword">as</span> [<span class="id" type="var">L_l1_l2'</span> |]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">inversion_clear</span> <span class="id" type="var">In_pb'</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">pb'_eq_</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">P</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">unsolved_part</span>; <br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">list_size_tl_compat</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_lt_le_compat</span>.<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">nil</span> ++ <span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>); <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">nil</span> ++ <span class="id" type="var">l1</span>)); <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ac_size_build_eq</span>; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ac_size_unfold</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_compat</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">list_permut.permut_length</span> <span class="id" type="var">P</span>); <span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>;<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">EDS.A</span>, <span class="id" type="var">DOS.A</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">length_app</span>;<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">length</span> <span class="id" type="var">l2'</span>); <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>;<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">minus_n_O</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Dummy</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">a'</span> : <span class="id" type="var">term</span>,<br/>
&nbsp;&nbsp;<span class="id" type="var">In</span> <span class="id" type="var">a</span> (<span class="id" type="var">ll1</span> ++ <span class="id" type="var">l2'</span>) -&gt; <span class="id" type="var">In</span> <span class="id" type="var">a'</span> <span class="id" type="var">l2</span> -&gt; <span class="id" type="var">a</span> = <span class="id" type="var">a'</span> -&gt; <span class="id" type="var">ac_size</span> <span class="id" type="var">a</span> = <span class="id" type="var">ac_size</span> <span class="id" type="var">a'</span>).<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">list_permut.permut_size</span> <span class="id" type="var">ac_size</span> <span class="id" type="var">ac_size</span> <span class="id" type="var">Dummy</span> <span class="id" type="var">P</span>); <span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>;<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">EDS.A</span>, <span class="id" type="var">DOS.A</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">list_size_app</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">W3</span> <span class="id" type="var">v1</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">find</span> <span class="id" type="var">X.eq_bool</span> <span class="id" type="var">v1</span> (<span class="id" type="var">partly_solved_part</span> <span class="id" type="var">pb</span>)) <span class="id" type="keyword">as</span> [<span class="id" type="var">p1</span> | ].<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">ac_elementary_solve_term_var_with_part_val_term</span> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="var">revert</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">f1</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>)); <br/>
<span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">f1</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>)); [<span class="id" type="tactic">intros</span> <span class="id" type="var">f1_eq_hd_p1</span> <span class="id" type="var">In_pb'</span>| <span class="id" type="tactic">intros</span> <span class="id" type="var">f1_diff_hd_p1</span> <span class="id" type="var">In_pb'</span>].<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">l2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">l2'''</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">In_pb'</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">pb'_eq_</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [ <span class="id" type="var">H</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">l2_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>;<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">unsolved_part</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">intros</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">list_size_tl_compat</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_lt_compat</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">s1</span> <span class="id" type="var">l1</span>]; [<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span> | <span class="id" type="var">idtac</span>].<br/>
<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <span class="id" type="var">ac_size_unfold</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">length_quicksort</span>; <br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">le_n_S</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_compat_l</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">H''</span> := @<span class="id" type="var">list_permut.permut_size</span> <span class="id" type="var">_</span> <span class="id" type="var">term</span> (@<span class="id" type="var">eq</span> <span class="id" type="var">term</span>) <span class="id" type="var">ac_size</span> <span class="id" type="var">ac_size</span> (<span class="id" type="var">quicksort</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>) :: <span class="id" type="var">s1</span> :: <span class="id" type="var">l1</span>))<br/>
&nbsp;&nbsp;((<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>) :: <span class="id" type="var">s1</span> :: <span class="id" type="var">l1</span>))).<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">EDS.A</span>, <span class="id" type="var">DOS.A</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H''</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">le_n</span>.<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut_bis</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">W3_v1</span>; <br/>
<span class="id" type="tactic">pattern</span> <span class="id" type="var">pb'</span>;<br/>
<span class="id" type="tactic">refine</span> <br/>
(<span class="id" type="var">prop_map_without_repetition</span> (<span class="id" type="var">B</span>:=matching_problem) <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>);<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">intros</span> [ | <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>] <span class="id" type="var">In_t2</span>; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">F.Symb.eq_bool_ok</span> <span class="id" type="var">g2</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>));<br/>
<span class="id" type="tactic">case</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">g2</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>)); [<span class="id" type="tactic">intros</span> <span class="id" type="var">g2_eq_hd_p1</span> | <span class="id" type="tactic">intros</span> <span class="id" type="var">g2_diff_hd_p1</span>; <span class="id" type="tactic">trivial</span>].<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">ll2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> (<span class="id" type="var">closed_term</span> <span class="id" type="var">p1</span>) <span class="id" type="var">ll2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">ll2'''</span> | ]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1</span> [<span class="id" type="var">ll2'</span> [<span class="id" type="var">ll2''</span> [ <span class="id" type="var">H</span> [<span class="id" type="var">ll2_eq</span> <span class="id" type="var">ll2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">ll2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">ll2'''_eq</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">ll2'''_eq</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">cp1</span> <span class="id" type="var">ll2'''</span>;<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>) <span class="id" type="var">l2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>) <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">l2'''</span> | ]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [ <span class="id" type="var">H</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">l2'''</span>;<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="var">unsolved_part</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">list_size</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_lt_compat_r</span>;<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">ac_size</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">new_var</span> <span class="id" type="var">p1</span>))) <span class="id" type="keyword">with</span> (<span class="id" type="var">ac_size</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>)); <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">plus_comm</span> (<span class="id" type="var">ac_size</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>))); <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>;<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">plus_assoc</span> (<span class="id" type="var">ac_size</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span>))); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span>;<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_lt_compat</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span>; <span class="id" type="tactic">replace</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">nil</span> ++ <span class="id" type="var">l1</span>)); <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">nil</span> ++ <span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>); <span class="id" type="tactic">trivial</span>; <br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt_args</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">lt_trans</span> <span class="id" type="keyword">with</span> (<span class="id" type="var">ac_size</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">l2'</span> ++ <span class="id" type="var">l2''</span>)) + <span class="id" type="var">ac_size</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>)).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">plus_lt_compat_l</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt</span>.<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">arity</span> (<span class="id" type="var">head_symb</span> <span class="id" type="var">p1</span>)); [<span class="id" type="tactic">trivial</span> | <span class="id" type="var">contradiction</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="var">well_formed_cf_subterms</span> <span class="id" type="var">W_t2</span>); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt_args</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">ac_elementary_solve_term_var_without_val_term</span> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">pattern</span> <span class="id" type="var">pb'</span>;<br/>
<span class="id" type="tactic">refine</span> <br/>
(<span class="id" type="var">prop_map12_without_repetition</span> (<span class="id" type="var">B</span>:=matching_problem) <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>);<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>;<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">t2</span> <span class="id" type="var">In_t2</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> <span class="id" type="var">t2</span> <span class="id" type="var">l2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> <span class="id" type="var">t2</span> <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">l2'''</span> | ]; <span class="id" type="tactic">trivial</span>; <br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [ <span class="id" type="var">H</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">l2'''</span>;<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Common_ineq</span> : <br/>
<span class="id" type="var">list_size</span><br/>
&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">t1_t2</span> : <span class="id" type="var">term</span> * <span class="id" type="var">term</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">t1</span>, <span class="id" type="var">t3</span>) := <span class="id" type="var">t1_t2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">ac_size</span> <span class="id" type="var">t1</span> + <span class="id" type="var">ac_size</span> <span class="id" type="var">t3</span>)<br/>
&nbsp;&nbsp;(<span class="id" type="var">unsolved_part</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">mk_pb</span> (<span class="id" type="var">existential_vars</span> <span class="id" type="var">pb</span>) ((<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>, <span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">l2'</span> ++ <span class="id" type="var">l2''</span>)) :: <span class="id" type="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" type="var">v1</span>, <span class="id" type="var">t2</span>) :: <span class="id" type="var">solved_part</span> <span class="id" type="var">pb</span>) (<span class="id" type="var">partly_solved_part</span> <span class="id" type="var">pb</span>))) &lt;<br/>
<span class="id" type="var">list_size</span><br/>
&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">t1_t2</span> : <span class="id" type="var">term</span> * <span class="id" type="var">term</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">t1</span>, <span class="id" type="var">t3</span>) := <span class="id" type="var">t1_t2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">ac_size</span> <span class="id" type="var">t1</span> + <span class="id" type="var">ac_size</span> <span class="id" type="var">t3</span>)<br/>
&nbsp;&nbsp;((<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> (<span class="id" type="var">Var</span> <span class="id" type="var">v1</span> :: <span class="id" type="var">l1</span>), <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2</span>) :: <span class="id" type="var">l</span>)).<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="var">unsolved_part</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">list_size_tl_compat</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_lt_compat</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">minus_n_O</span>; <span class="id" type="tactic">rewrite</span> (<span class="id" type="var">list_size_fold</span> <span class="id" type="var">ac_size</span>);<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ac_size_build_eq</span>; <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_compat</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">le_minus</span>.<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">EDS.A</span>, <span class="id" type="var">DOS.A</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">destruct</span> (<span class="id" type="var">le_gt_dec</span> (<span class="id" type="var">length</span> <span class="id" type="var">l2</span>) (<span class="id" type="var">length</span> <span class="id" type="var">l1</span> + 1)) <span class="id" type="keyword">as</span> [<span class="id" type="var">_</span> | <span class="id" type="var">_</span>]; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">split</span>; <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Common_ineq</span>.<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="var">unsolved_part</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">list_size_tl_compat</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_lt_compat</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [| <span class="id" type="var">t1'</span> <span class="id" type="var">l1</span>]; [<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span> | <span class="id" type="var">idtac</span>];<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">length_quicksort</span>; <span class="id" type="tactic">simpl</span>;<br/>
<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> (<span class="id" type="var">list_size_fold</span> <span class="id" type="var">ac_size</span>); <span class="id" type="tactic">simpl</span>;<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">H'</span> := @<span class="id" type="var">list_permut.permut_size</span> <span class="id" type="var">_</span> <span class="id" type="var">term</span> (@<span class="id" type="var">eq</span> <span class="id" type="var">term</span>) <span class="id" type="var">ac_size</span> <span class="id" type="var">ac_size</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>) :: <span class="id" type="var">t1'</span> :: <span class="id" type="var">l1</span>) <br/>
(<span class="id" type="var">quicksort</span> (<span class="id" type="var">Var</span> (<span class="id" type="var">fresh_var</span> <span class="id" type="var">pb</span>) :: <span class="id" type="var">t1'</span> :: <span class="id" type="var">l1</span>))).<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">EDS.A</span>, <span class="id" type="var">DOS.A</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H'</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">le_n</span>.<br/>
<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">quick_permut</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">l2</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">unfold</span> <span class="id" type="var">ac_elementary_solve_term_term_term</span> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">pattern</span> <span class="id" type="var">pb'</span>;<br/>
<span class="id" type="tactic">refine</span> <br/>
(<span class="id" type="var">prop_map_without_repetition</span> (<span class="id" type="var">B</span>:=matching_problem) <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>);<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">pb'</span> <span class="id" type="var">In_pb'</span>; <span class="id" type="tactic">intros</span> [ | <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>] <span class="id" type="var">In_t2</span>; <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">F.Symb.eq_bool</span> <span class="id" type="var">g1</span> <span class="id" type="var">g2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">g1_eq_g2</span> | <span class="id" type="var">g1_diff_g2</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">in_remove</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">T.eq_bool_ok</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>) <span class="id" type="var">l2</span>);<br/>
<span class="id" type="tactic">destruct</span> (<span class="id" type="var">remove</span> <span class="id" type="var">T.eq_bool</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g2</span> <span class="id" type="var">ll2</span>) <span class="id" type="var">l2</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">l2'''</span> | ]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">cp1</span> [<span class="id" type="var">l2'</span> [<span class="id" type="var">l2''</span> [ <span class="id" type="var">H</span> [<span class="id" type="var">l2_eq</span> <span class="id" type="var">l2'''_eq</span>]]]]].<br/>
<span class="id" type="tactic">injection</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2'''_eq</span>; <span class="id" type="tactic">intro</span>; <span class="id" type="tactic">subst</span> <span class="id" type="var">l2'''</span>;<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="var">unsolved_part</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">list_size</span>; <span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_lt_compat_r</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>;<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">plus_comm</span> (<span class="id" type="var">ac_size</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g1</span> <span class="id" type="var">ll1</span>))); <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>;<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">plus_assoc</span> (<span class="id" type="var">ac_size</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g1</span> <span class="id" type="var">ll1</span>))); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span>;<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_lt_compat</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span>; <span class="id" type="tactic">replace</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">build</span> <span class="id" type="var">f1</span> (<span class="id" type="var">nil</span> ++ <span class="id" type="var">l1</span>)); <span class="id" type="tactic">trivial</span>;<br/>
<span class="id" type="tactic">replace</span> (<span class="id" type="var">Term</span> <span class="id" type="var">g1</span> <span class="id" type="var">ll1</span> :: <span class="id" type="var">l1</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">nil</span> ++ <span class="id" type="var">Term</span> <span class="id" type="var">g1</span> <span class="id" type="var">ll1</span> :: <span class="id" type="var">l1</span>); <span class="id" type="tactic">trivial</span>; <br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt_args</span>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">l2</span> <span class="id" type="var">cp1</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">ac_size_build_lt_args</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">u1</span> [ | <span class="id" type="var">u2</span> [ | <span class="id" type="var">u3</span> <span class="id" type="var">l1</span>]]]; [<span class="id" type="var">contradiction</span> | <span class="id" type="var">contradiction</span> | <span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">l2</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">v1</span> [ | <span class="id" type="var">v2</span> [ | <span class="id" type="var">v3</span> <span class="id" type="var">l2</span>]]]; [<span class="id" type="var">contradiction</span> | <span class="id" type="var">contradiction</span> | <span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>].<br/>
<span class="id" type="tactic">inversion_clear</span> <span class="id" type="var">In_pb'</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">pb'_eq_</span> | <span class="id" type="var">In_pb''</span>]; <br/>
[<span class="id" type="var">idtac</span> | <span class="id" type="tactic">inversion_clear</span> <span class="id" type="var">In_pb''</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">pb''_eq_</span> | ]; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>]];<br/>
<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">unsolved_part</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">list_size</span>;<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_lt_compat_r</span>; <span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_0_r</span>.<br/>
<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_lt_compat_r</span>;<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">lt</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">le_n_S</span>; <span class="id" type="tactic">do</span> 3 <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>;<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_compat_l</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_compat_l</span>;<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">le_S</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">le_n</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">lt</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">le_n_S</span>; <span class="id" type="tactic">do</span> 3 <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_compat_l</span>;<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span>;  <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_compat_l</span>;<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">le_S</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">le_n</span>.<br/>

<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">L12</span> : <span class="id" type="var">length</span> <span class="id" type="var">l1</span> = <span class="id" type="var">length</span> <span class="id" type="var">l2</span>).<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">trans_eq</span> <span class="id" type="keyword">with</span> <span class="id" type="var">n1</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="tactic">apply</span> <span class="id" type="var">sym_eq</span>];<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">W1</span> (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2</span>) (<span class="id" type="var">or_introl</span> <span class="id" type="var">_</span> (<span class="id" type="var">refl_equal</span> <span class="id" type="var">_</span>)));<br/>
<span class="id" type="tactic">intros</span> [[<span class="id" type="var">_</span> <span class="id" type="var">W_t1</span>] [<span class="id" type="var">_</span> <span class="id" type="var">W_t2</span>]]; [<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W_t1</span> | <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">W_t2</span>]; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">generalize</span> <span class="id" type="var">l</span> <span class="id" type="var">l2</span> <span class="id" type="var">In_pb'</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">W1</span> <span class="id" type="var">W2</span> <span class="id" type="var">W3</span> <span class="id" type="var">l</span> <span class="id" type="var">l2</span> <span class="id" type="var">In_pb'</span> <span class="id" type="var">L12</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">l1</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">t1</span> <span class="id" type="var">l1</span>]; <span class="id" type="tactic">destruct</span> <span class="id" type="var">l2</span> <span class="id" type="keyword">as</span> [ | <span class="id" type="var">t2</span> <span class="id" type="var">l2</span>].<br/>
<span class="id" type="tactic">intros</span> [<span class="id" type="var">In_pb'</span> | <span class="id" type="var">In_pb'</span>] <span class="id" type="var">_</span>; [<span class="id" type="var">idtac</span> | <span class="id" type="var">contradiction</span>];<br/>
<span class="id" type="tactic">subst</span> <span class="id" type="var">pb'</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_n_O</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">discriminate</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">_</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">discriminate</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">In_pb'</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">generalize</span> (<span class="id" type="var">eq_add_S</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">L12</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">L12</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">L12</span>.<br/>
<span class="id" type="tactic">generalize</span> (<span class="id" type="var">IHl1</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">In_pb'</span> <span class="id" type="var">L12</span>).<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">lt_le_trans</span> <span class="id" type="keyword">with</span> <br/>
(<span class="id" type="var">list_size</span><br/>
&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">t1_t2</span> : <span class="id" type="var">term</span> * <span class="id" type="var">term</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">t1</span>, <span class="id" type="var">t2</span>) := <span class="id" type="var">t1_t2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">ac_size</span> <span class="id" type="var">t1</span> + <span class="id" type="var">ac_size</span> <span class="id" type="var">t2</span>)<br/>
&nbsp;&nbsp;((<span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l1</span>, <span class="id" type="var">Term</span> <span class="id" type="var">f1</span> <span class="id" type="var">l2</span>) :: (<span class="id" type="var">t1</span>, <span class="id" type="var">t2</span>) :: <span class="id" type="var">l</span>)); <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Af1</span>; <span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> (<span class="id" type="var">list_size_fold</span> <span class="id" type="var">ac_size</span>); <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">le_n_S</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_compat_r</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span>; <span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_compat_l</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span>; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">plus_assoc</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">plus_le_compat_l</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">plus_comm</span>; <span class="id" type="tactic">trivial</span>.<br/>

<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Make</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://www.lix.polytechnique.fr/coq/">coqdoc</a>
</div>

</div>

</body>
</html>